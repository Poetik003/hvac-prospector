<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate">
    <meta http-equiv="Pragma" content="no-cache">
    <meta http-equiv="Expires" content="0">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <title>ProSpector Pro - AI-Powered Sales Dashboard</title>
    <link rel="icon" type="image/png" href="favicon.png">
    <link rel="alternate icon" href="favicon.png">
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.4.0/css/all.min.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
    <style>
        body { 
            font-family: 'Inter', sans-serif; 
            background: linear-gradient(135deg, #1e293b 0%, #0f172a 50%, #020617 100%);
            min-height: 100vh;
        }
        
        .glass-morphism {
            background: rgba(15, 23, 42, 0.6);
            backdrop-filter: blur(16px);
            border: 1px solid rgba(148, 163, 184, 0.2);
            box-shadow: 0 8px 32px 0 rgba(0, 0, 0, 0.3);
        }
        
        .nav-item.active { 
            background: linear-gradient(135deg, #3b82f6 0%, #1d4ed8 100%);
            box-shadow: 0 4px 15px 0 rgba(59, 130, 246, 0.4);
            transform: translateY(-2px);
        }
        
        .nav-item {
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            position: relative;
            cursor: pointer;
            border: none;
            outline: none;
        }
        
        .nav-item:hover:not(.active) {
            background: rgba(148, 163, 184, 0.1);
            transform: translateY(-1px);
        }
        
        .nav-item:focus {
            outline: 2px solid rgba(59, 130, 246, 0.5);
            outline-offset: 2px;
        }
        
        .card-modern {
            background: rgba(15, 23, 42, 0.8);
            backdrop-filter: blur(16px);
            border: 1px solid rgba(148, 163, 184, 0.1);
            box-shadow: 0 8px 32px 0 rgba(0, 0, 0, 0.2);
        }
        
        .metric-card {
            background: rgba(30, 41, 59, 0.8);
            backdrop-filter: blur(12px);
            border: 1px solid rgba(148, 163, 184, 0.1);
            transition: all 0.3s ease;
        }
        
        .metric-card:hover {
            transform: translateY(-4px);
            box-shadow: 0 12px 40px 0 rgba(0, 0, 0, 0.3);
            border-color: rgba(59, 130, 246, 0.3);
        }
        
        .gradient-text {
            background: linear-gradient(135deg, #60a5fa 0%, #a78bfa 50%, #ec4899 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }
        
        .btn-primary {
            background: linear-gradient(135deg, #3b82f6 0%, #1d4ed8 100%);
            transition: all 0.3s ease;
        }
        
        .btn-primary:hover {
            background: linear-gradient(135deg, #2563eb 0%, #1e40af 100%);
            transform: translateY(-2px);
            box-shadow: 0 10px 25px 0 rgba(59, 130, 246, 0.4);
        }
        
        .btn-success {
            background: linear-gradient(135deg, #10b981 0%, #059669 100%);
        }
        
        .btn-success:hover {
            background: linear-gradient(135deg, #059669 0%, #047857 100%);
            transform: translateY(-2px);
            box-shadow: 0 10px 25px 0 rgba(16, 185, 129, 0.4);
        }
        
        .animate-fade-in {
            animation: fadeIn 0.5s ease-out;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .loading-screen {
            background: linear-gradient(135deg, #1e293b 0%, #0f172a 50%, #020617 100%);
        }
        
        .spinner {
            width: 60px;
            height: 60px;
            border: 4px solid rgba(59, 130, 246, 0.3);
            border-left: 4px solid #3b82f6;
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        .tab-content {
            min-height: 600px;
        }
        
        /* Responsive navigation */
        @media (max-width: 768px) {
            .nav-item {
                padding: 0.75rem 0.5rem;
                font-size: 0.75rem;
            }
        }
        
        tbody tr:hover {
            background: rgba(59, 130, 246, 0.05);
        }
        
        input:focus, select:focus, textarea:focus {
            outline: none;
            ring: 2px;
            ring-color: rgba(59, 130, 246, 0.5);
        }
        
        ::-webkit-scrollbar {
            width: 8px;
        }
        
        ::-webkit-scrollbar-track {
            background: rgba(15, 23, 42, 0.5);
        }
        
        ::-webkit-scrollbar-thumb {
            background: rgba(59, 130, 246, 0.5);
            border-radius: 4px;
        }
        
        ::-webkit-scrollbar-thumb:hover {
            background: rgba(59, 130, 246, 0.7);
        }
    </style>
    
    <!-- IMMEDIATE LOADING SCREEN FIX -->
    <script>
        // Force hide loading screen after 1 second for faster load
        setTimeout(function() {
            var loadingScreen = document.getElementById('loadingScreen');
            if (loadingScreen) {
                loadingScreen.style.display = 'none';
                console.log('✅ Loading screen auto-hidden');
            }
        }, 1000);
        
        // Skip loading function - works immediately
        function skipLoading() {
            var loadingScreen = document.getElementById('loadingScreen');
            if (loadingScreen) {
                loadingScreen.style.display = 'none';
                console.log('⏭️ User skipped loading');
            }
        }
    </script>
</head>
<body class="bg-slate-900 text-white overflow-x-hidden">
    <!-- Loading Screen with FIXED skip button -->
    <div id="loadingScreen" class="loading-screen fixed inset-0 z-50 flex items-center justify-center">
        <div class="text-center">
            <div class="spinner mx-auto mb-6"></div>
            <h2 class="text-2xl font-bold gradient-text mb-2">ProSpector Pro</h2>
            <p class="text-slate-400 mb-4">Initializing AI-Powered Sales Dashboard...</p>
            <!-- Multiple skip methods for reliability -->
            <button onclick="skipLoading()" class="mt-4 px-6 py-3 bg-blue-600 hover:bg-blue-700 text-white text-lg rounded-lg transition-colors duration-300 cursor-pointer">
                Enter Dashboard
            </button>
        </div>
    </div>

    <div class="min-h-screen flex flex-col lg:flex-row">
        <!-- Sidebar Navigation -->
        <div class="w-full lg:w-64 glass-morphism lg:min-h-screen flex flex-col">
            <div class="p-6 border-b border-slate-700/50">
                <div class="flex items-center space-x-3">
                    <div class="w-12 h-12 flex items-center justify-center rounded-full overflow-hidden bg-slate-800/30 backdrop-blur-sm relative">
                        <!-- ProSpector Logo -->
                        <img 
                            src="prospector-logo-final.png?v=32" 
                            alt="ProSpector Logo" 
                            class="w-10 h-10 object-cover rounded-full"
                            style="display: block;"
                            onload="console.log('✅ Sidebar logo loaded successfully'); this.style.display='block'; this.nextElementSibling.style.display='none';"
                            onerror="console.error('❌ Sidebar logo failed to load:', this.src); this.style.display='none'; this.nextElementSibling.style.display='flex';"
                        />
                        <!-- Fallback logo for sidebar -->
                        <div class="w-full h-full bg-gradient-to-r from-blue-600 to-purple-600 rounded-md flex items-center justify-center" style="display: none;">
                            <span class="text-white text-sm font-bold">PS</span>
                        </div>
                    </div>
                    <div>
                        <h1 class="text-xl font-bold gradient-text">ProSpector</h1>
                        <p class="text-xs text-slate-400">AI Sales Platform</p>
                    </div>
                </div>
            </div>
            
            <!-- Navigation Items -->
            <nav class="p-4 space-y-2 flex-1">
                <button data-tab="dashboard" class="nav-item active w-full flex items-center py-4 px-4 text-white rounded-xl font-semibold text-sm transition-all duration-300 relative">
                    <i class="fas fa-tachometer-alt mr-3 text-lg"></i>
                    <span class="lg:inline">Dashboard</span>
                </button>
                
                <button data-tab="leads" class="nav-item w-full flex items-center py-4 px-4 text-white/80 hover:text-white rounded-xl font-semibold text-sm transition-all duration-300 relative">
                    <i class="fas fa-users mr-3 text-lg"></i>
                    <span class="lg:inline">Prospects</span>
                </button>
                
                <button data-tab="scripts" class="nav-item w-full flex items-center py-4 px-4 text-white/80 hover:text-white rounded-xl font-semibold text-sm transition-all duration-300 relative">
                    <i class="fas fa-file-alt mr-3 text-lg"></i>
                    <span class="lg:inline">AI Actors</span>
                </button>
                
                <button data-tab="voicecalling" class="nav-item w-full flex items-center py-4 px-4 text-white/80 hover:text-white rounded-xl font-semibold text-sm transition-all duration-300 relative">
                    <i class="fas fa-phone mr-3 text-lg"></i>
                    <span class="lg:inline">AI Cold Calling</span>
                </button>
                
                <button data-tab="meetings" class="nav-item w-full flex items-center py-4 px-4 text-white/80 hover:text-white rounded-xl font-semibold text-sm transition-all duration-300 relative">
                    <i class="fas fa-calendar mr-3 text-lg"></i>
                    <span class="lg:inline">Appointments</span>
                </button>
                
                <button data-tab="research" class="nav-item w-full flex items-center py-4 px-4 text-white/80 hover:text-white rounded-xl font-semibold text-sm transition-all duration-300 relative">
                    <i class="fas fa-search mr-3 text-lg"></i>
                    <span class="lg:inline">Research</span>
                </button>
                
                <button data-tab="analytics" class="nav-item w-full flex items-center py-4 px-4 text-white/80 hover:text-white rounded-xl font-semibold text-sm transition-all duration-300 relative">
                    <i class="fas fa-chart-bar mr-3 text-lg"></i>
                    <span class="lg:inline">Analytics</span>
                </button>
            </nav>
            
            <!-- Login/Signup Section -->
            <div class="p-4 border-t border-slate-700/50 mt-auto">
                <div class="space-y-2">
                    <button id="prospector-login-btn" class="w-full bg-blue-600 hover:bg-blue-700 text-white py-3 px-4 rounded-xl font-semibold text-sm transition-colors duration-300">
                        <i class="fas fa-sign-in-alt mr-2"></i>Login
                    </button>
                    <button id="prospector-signup-btn" class="w-full border border-blue-600 text-blue-400 hover:bg-blue-600/10 py-3 px-4 rounded-xl font-semibold text-sm transition-colors duration-300">
                        <i class="fas fa-user-plus mr-2"></i>Sign Up
                    </button>
                </div>
                <div class="mt-4 pt-4 border-t border-slate-700/50">
                    <p class="text-xs text-slate-500 text-center">ProSpector Pro v2.1</p>
                    <p class="text-xs text-slate-500 text-center mt-1">AI-Powered Sales Platform</p>
                </div>
            </div>
        </div>
        
        <!-- Main Content -->
        <div class="flex-1 overflow-hidden">
            <!-- Dashboard Tab -->
            <div id="dashboard-tab" class="tab-content p-6 animate-fade-in">
                <div class="mb-8">
                    <div class="flex items-center justify-center mb-6">
                        <!-- Featured ProSpector Logo -->
                        <div class="w-24 h-24 flex items-center justify-center rounded-full bg-slate-800/30 backdrop-blur-sm relative">
                            <img 
                                src="prospector-logo-final.png?v=32" 
                                alt="ProSpector Logo" 
                                class="object-cover rounded-full"
                                style="width: 88px; height: 88px; display: block;"
                                onload="console.log('✅ Center logo loaded successfully'); this.style.display='block'; this.nextElementSibling.style.display='none';"
                                onerror="console.error('❌ Center logo failed to load:', this.src); this.style.display='none'; this.nextElementSibling.style.display='flex';"
                            />
                            <!-- Fallback if logo doesn't load -->
                            <div class="bg-gradient-to-r from-blue-600 to-purple-600 rounded-full flex items-center justify-center" style="width: 88px; height: 88px; display: none;">
                                <span class="text-white text-xl font-bold">PS</span>
                            </div>
                        </div>
                    </div>
                    <h2 class="text-3xl font-bold gradient-text mb-2 text-center">Sales Dashboard</h2>
                    <p class="text-slate-400 text-center">AI-powered lead management and voice calling platform</p>
                </div>
                
                <!-- Key Metrics -->
                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8">
                    <div class="metric-card rounded-2xl p-6">
                        <div class="flex items-center justify-between mb-4">
                            <div class="p-3 rounded-xl bg-blue-500/20">
                                <i class="fas fa-users text-2xl text-blue-600"></i>
                            </div>
                            <div class="text-right">
                                <p class="text-3xl font-bold text-slate-100">247</p>
                                <p class="text-sm font-semibold text-slate-300">Total Leads</p>
                            </div>
                        </div>
                        <div class="flex items-center text-sm">
                            <i class="fas fa-arrow-up text-green-500 mr-1"></i>
                            <span class="text-green-500 font-semibold">12%</span>
                            <span class="text-slate-400 ml-1">vs last month</span>
                        </div>
                    </div>
                    
                    <div class="metric-card rounded-2xl p-6">
                        <div class="flex items-center justify-between mb-4">
                            <div class="p-3 rounded-xl bg-green-500/20">
                                <i class="fas fa-fire text-2xl text-green-600"></i>
                            </div>
                            <div class="text-right">
                                <p class="text-3xl font-bold text-slate-100">89</p>
                                <p class="text-sm font-semibold text-slate-300">Hot Leads</p>
                            </div>
                        </div>
                        <div class="flex items-center text-sm">
                            <i class="fas fa-arrow-up text-green-500 mr-1"></i>
                            <span class="text-green-500 font-semibold">36%</span>
                            <span class="text-slate-400 ml-1">conversion rate</span>
                        </div>
                    </div>
                    
                    <div class="metric-card rounded-2xl p-6">
                        <div class="flex items-center justify-between mb-4">
                            <div class="p-3 rounded-xl bg-yellow-500/20">
                                <i class="fas fa-clock text-2xl text-yellow-600"></i>
                            </div>
                            <div class="text-right">
                                <p class="text-3xl font-bold text-slate-100">124</p>
                                <p class="text-sm font-semibold text-slate-300">Pending</p>
                            </div>
                        </div>
                        <div class="flex items-center text-sm">
                            <i class="fas fa-phone text-blue-500 mr-1"></i>
                            <span class="text-slate-400">awaiting calls</span>
                        </div>
                    </div>
                    
                    <div class="metric-card rounded-2xl p-6">
                        <div class="flex items-center justify-between mb-4">
                            <div class="p-3 rounded-xl bg-purple-500/20">
                                <i class="fas fa-trophy text-2xl text-purple-600"></i>
                            </div>
                            <div class="text-right">
                                <p class="text-3xl font-bold text-slate-100">34</p>
                                <p class="text-sm font-semibold text-slate-300">Converted</p>
                            </div>
                        </div>
                        <div class="flex items-center text-sm">
                            <i class="fas fa-dollar-sign text-green-500 mr-1"></i>
                            <span class="text-green-500 font-semibold">$145,200</span>
                            <span class="text-slate-400 ml-1">revenue</span>
                        </div>
                    </div>
                </div>
                
                <!-- Quick Actions -->
                <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8">
                    <button data-tab="leads" class="group p-6 rounded-xl bg-gradient-to-br from-blue-900/30 to-blue-800/40 border border-blue-500/30 hover:from-blue-800/40 hover:to-blue-700/50 transition-all duration-300">
                        <div class="flex items-center mb-4">
                            <div class="p-3 rounded-xl bg-blue-500/20 group-hover:bg-blue-500/30 transition-all duration-300">
                                <i class="fas fa-plus text-2xl text-blue-400"></i>
                            </div>
                            <div class="ml-4 text-left">
                                <h3 class="text-lg font-bold text-white">Add New Leads</h3>
                                <p class="text-sm text-blue-200">Import or create leads</p>
                            </div>
                        </div>
                        <div class="text-left">
                            <p class="text-blue-100 text-sm">Import from LinkedIn, Apollo AI, add manually, or use Seamless AI integration</p>
                        </div>
                    </button>
                    
                    <button data-tab="voicecalling" class="group p-6 rounded-xl bg-gradient-to-br from-slate-700/30 to-slate-600/40 border border-slate-500/30 hover:from-slate-600/40 hover:to-slate-500/50 transition-all duration-300">
                        <div class="flex items-center mb-4">
                            <div class="p-3 rounded-xl bg-slate-500/20 group-hover:bg-slate-500/30 transition-all duration-300">
                                <i class="fas fa-phone-volume text-2xl text-slate-400"></i>
                            </div>
                            <div class="ml-4 text-left">
                                <h3 class="text-lg font-bold text-white">Start Voice Calling</h3>
                                <p class="text-sm text-slate-200">AI-powered calls</p>
                            </div>
                        </div>
                        <div class="text-left">
                            <p class="text-slate-100 text-sm">Launch AI voice campaigns with smart scripts and real-time coaching</p>
                        </div>
                    </button>
                    
                    <button data-tab="scripts" class="group p-6 rounded-xl bg-gradient-to-br from-green-900/30 to-green-800/40 border border-green-500/30 hover:from-green-800/40 hover:to-green-700/50 transition-all duration-300">
                        <div class="flex items-center mb-4">
                            <div class="p-3 rounded-xl bg-green-500/20 group-hover:bg-green-500/30 transition-all duration-300">
                                <i class="fas fa-magic text-2xl text-green-400"></i>
                            </div>
                            <div class="ml-4 text-left">
                                <h3 class="text-lg font-bold text-white">Generate Scripts</h3>
                                <p class="text-sm text-green-200">AI voice scripts</p>
                            </div>
                        </div>
                        <div class="text-left">
                            <p class="text-green-100 text-sm">Create personalized call scripts with AI assistance and proven templates</p>
                        </div>
                    </button>
                </div>
                
                <!-- Recent Activity -->
                <div class="card-modern rounded-2xl p-6">
                    <h3 class="text-xl font-bold gradient-text mb-4">Recent Activity</h3>
                    <div class="space-y-4">
                        <div class="flex items-center p-3 bg-slate-800/50 rounded-lg">
                            <div class="w-2 h-2 bg-green-500 rounded-full mr-3"></div>
                            <div class="flex-1">
                                <p class="text-sm font-medium text-white">New lead imported from LinkedIn Sales Navigator</p>
                                <p class="text-xs text-slate-400">2 minutes ago</p>
                            </div>
                        </div>
                        
                        <div class="flex items-center p-3 bg-slate-800/50 rounded-lg">
                            <div class="w-2 h-2 bg-blue-500 rounded-full mr-3"></div>
                            <div class="flex-1">
                                <p class="text-sm font-medium text-white">AI script generated for cold calling</p>
                                <p class="text-xs text-slate-400">5 minutes ago</p>
                            </div>
                        </div>
                        
                        <div class="flex items-center p-3 bg-slate-800/50 rounded-lg">
                            <div class="w-2 h-2 bg-purple-500 rounded-full mr-3"></div>
                            <div class="flex-1">
                                <p class="text-sm font-medium text-white">Voice call completed successfully</p>
                                <p class="text-xs text-slate-400">8 minutes ago</p>
                            </div>
                        </div>
                        
                        <div class="flex items-center p-3 bg-slate-800/50 rounded-lg">
                            <div class="w-2 h-2 bg-yellow-500 rounded-full mr-3"></div>
                            <div class="flex-1">
                                <p class="text-sm font-medium text-white">Follow-up meeting scheduled</p>
                                <p class="text-xs text-slate-400">12 minutes ago</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Lead Management Tab -->
            <div id="leads-tab" class="tab-content hidden p-6">
                <div class="mb-8">
                    <h2 class="text-3xl font-bold gradient-text mb-4">Lead Management & Integrations</h2>
                    <p class="text-slate-400 mb-6">Import leads from multiple sources and manage your sales pipeline</p>
                </div>

                <!-- Integration Cards -->
                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 mb-8">
                    <!-- Apollo AI Integration -->
                    <div class="card-modern rounded-2xl p-6 hover:shadow-2xl transition-all duration-300">
                        <div class="flex items-center mb-4">
                            <div class="w-12 h-12 bg-purple-500/20 rounded-xl flex items-center justify-center">
                                <i class="fas fa-rocket text-2xl text-purple-400"></i>
                            </div>
                            <div class="ml-4">
                                <h3 class="text-lg font-bold text-white">Apollo AI</h3>
                                <p class="text-sm text-slate-400">Sales Intelligence</p>
                            </div>
                        </div>
                        <p class="text-slate-300 text-sm mb-4">Access 275M+ contacts and 73M+ companies with advanced search and AI-powered insights.</p>
                        <div class="space-y-2">
                            <button id="connect-apollo-btn" class="w-full btn-primary px-4 py-3 rounded-lg text-white font-semibold">
                                <i class="fas fa-sign-in-alt mr-2"></i>Connect Apollo AI
                            </button>
                            <a href="https://apollo.io" target="_blank" class="block w-full text-center py-2 text-purple-400 hover:text-purple-300 text-sm">
                                Sign up for Apollo AI →
                            </a>
                        </div>
                    </div>

                    <!-- Seamless AI Integration -->
                    <div class="card-modern rounded-2xl p-6 hover:shadow-2xl transition-all duration-300">
                        <div class="flex items-center mb-4">
                            <div class="w-12 h-12 bg-green-500/20 rounded-xl flex items-center justify-center">
                                <i class="fas fa-brain text-2xl text-green-400"></i>
                            </div>
                            <div class="ml-4">
                                <h3 class="text-lg font-bold text-white">Seamless AI</h3>
                                <p class="text-sm text-slate-400">Real-time Search</p>
                            </div>
                        </div>
                        <p class="text-slate-300 text-sm mb-4">Find verified emails, phone numbers, and LinkedIn profiles in real-time with AI-powered prospecting.</p>
                        <div class="space-y-2">
                            <button id="connect-seamless-btn" class="w-full btn-success px-4 py-3 rounded-lg text-white font-semibold">
                                <i class="fas fa-link mr-2"></i>Connect Seamless AI
                            </button>
                            <a href="https://seamless.ai" target="_blank" class="block w-full text-center py-2 text-green-400 hover:text-green-300 text-sm">
                                Sign up for Seamless AI →
                            </a>
                        </div>
                    </div>

                    <!-- LinkedIn Sales Navigator -->
                    <div class="card-modern rounded-2xl p-6 hover:shadow-2xl transition-all duration-300">
                        <div class="flex items-center mb-4">
                            <div class="w-12 h-12 bg-blue-500/20 rounded-xl flex items-center justify-center">
                                <i class="fab fa-linkedin text-2xl text-blue-400"></i>
                            </div>
                            <div class="ml-4">
                                <h3 class="text-lg font-bold text-white">LinkedIn Sales Navigator</h3>
                                <p class="text-sm text-slate-400">Professional Network</p>
                            </div>
                        </div>
                        <p class="text-slate-300 text-sm mb-4">Leverage LinkedIn's premium search and lead recommendations with advanced filters and insights.</p>
                        <div class="space-y-2">
                            <button id="connect-linkedin-btn" class="w-full bg-blue-600 hover:bg-blue-700 px-4 py-3 rounded-lg text-white font-semibold transition-colors">
                                <i class="fab fa-linkedin mr-2"></i>Connect LinkedIn
                            </button>
                            <a href="https://business.linkedin.com/sales-solutions/sales-navigator" target="_blank" class="block w-full text-center py-2 text-blue-400 hover:text-blue-300 text-sm">
                                Get Sales Navigator →
                            </a>
                        </div>
                    </div>

                    <!-- ZoomInfo Integration -->
                    <div class="card-modern rounded-2xl p-6 hover:shadow-2xl transition-all duration-300">
                        <div class="flex items-center mb-4">
                            <div class="w-12 h-12 bg-orange-500/20 rounded-xl flex items-center justify-center">
                                <i class="fas fa-search-plus text-2xl text-orange-400"></i>
                            </div>
                            <div class="ml-4">
                                <h3 class="text-lg font-bold text-white">ZoomInfo</h3>
                                <p class="text-sm text-slate-400">B2B Database</p>
                            </div>
                        </div>
                        <p class="text-slate-300 text-sm mb-4">Access comprehensive B2B contact and company data with advanced technographics and intent data.</p>
                        <div class="space-y-2">
                            <button id="connect-zoominfo-btn" class="w-full bg-orange-600 hover:bg-orange-700 px-4 py-3 rounded-lg text-white font-semibold transition-colors">
                                <i class="fas fa-database mr-2"></i>Connect ZoomInfo
                            </button>
                            <a href="https://zoominfo.com" target="_blank" class="block w-full text-center py-2 text-orange-400 hover:text-orange-300 text-sm">
                                Sign up for ZoomInfo →
                            </a>
                        </div>
                    </div>

                    <!-- Google Business Integration -->
                    <div class="card-modern rounded-2xl p-6 hover:shadow-2xl transition-all duration-300">
                        <div class="flex items-center mb-4">
                            <div class="w-12 h-12 bg-red-500/20 rounded-xl flex items-center justify-center">
                                <i class="fab fa-google text-2xl text-red-400"></i>
                            </div>
                            <div class="ml-4">
                                <h3 class="text-lg font-bold text-white">Google Business</h3>
                                <p class="text-sm text-slate-400">Local Leads</p>
                            </div>
                        </div>
                        <p class="text-slate-300 text-sm mb-4">Import leads from Google My Business, Google Ads, and local search results for targeted outreach.</p>
                        <div class="space-y-2">
                            <button id="connect-google-btn" class="w-full bg-red-600 hover:bg-red-700 px-4 py-3 rounded-lg text-white font-semibold transition-colors">
                                <i class="fab fa-google mr-2"></i>Connect Google Business
                            </button>
                            <a href="https://business.google.com" target="_blank" class="block w-full text-center py-2 text-red-400 hover:text-red-300 text-sm">
                                Setup Google Business →
                            </a>
                        </div>
                    </div>

                    <!-- Manual Lead Entry -->
                    <div class="card-modern rounded-2xl p-6 hover:shadow-2xl transition-all duration-300">
                        <div class="flex items-center mb-4">
                            <div class="w-12 h-12 bg-slate-500/20 rounded-xl flex items-center justify-center">
                                <i class="fas fa-user-plus text-2xl text-slate-400"></i>
                            </div>
                            <div class="ml-4">
                                <h3 class="text-lg font-bold text-white">Manual Entry</h3>
                                <p class="text-sm text-slate-400">Add Leads Manually</p>
                            </div>
                        </div>
                        <p class="text-slate-300 text-sm mb-4">Manually add leads with custom fields, notes, and contact information for personalized outreach.</p>
                        <div class="space-y-2">
                            <button id="add-lead-btn" class="w-full bg-slate-600 hover:bg-slate-700 px-4 py-3 rounded-lg text-white font-semibold transition-colors">
                                <i class="fas fa-plus mr-2"></i>Add New Lead
                            </button>
                            <button id="import-csv-btn" class="w-full text-center py-2 text-slate-400 hover:text-slate-300 text-sm border border-slate-600 rounded-lg hover:border-slate-500 transition-colors">
                                Import CSV File
                            </button>
                        </div>
                    </div>
                </div>

                <!-- Lead Pipeline Overview -->
                <div class="card-modern rounded-2xl p-6">
                    <h3 class="text-xl font-bold gradient-text mb-4">Lead Pipeline Overview</h3>
                    <div class="grid grid-cols-2 md:grid-cols-4 gap-4 mb-6">
                        <div class="text-center p-4 bg-slate-800/50 rounded-lg">
                            <p class="text-2xl font-bold text-blue-400">247</p>
                            <p class="text-sm text-slate-400">Total Leads</p>
                        </div>
                        <div class="text-center p-4 bg-slate-800/50 rounded-lg">
                            <p class="text-2xl font-bold text-green-400">89</p>
                            <p class="text-sm text-slate-400">Qualified</p>
                        </div>
                        <div class="text-center p-4 bg-slate-800/50 rounded-lg">
                            <p class="text-2xl font-bold text-yellow-400">34</p>
                            <p class="text-sm text-slate-400">In Progress</p>
                        </div>
                        <div class="text-center p-4 bg-slate-800/50 rounded-lg">
                            <p class="text-2xl font-bold text-purple-400">15</p>
                            <p class="text-sm text-slate-400">Converted</p>
                        </div>
                    </div>
                    
                    <div class="space-y-3">
                        <div class="flex items-center justify-between p-3 bg-slate-800/30 rounded-lg">
                            <div class="flex items-center">
                                <div class="w-2 h-2 bg-green-500 rounded-full mr-3"></div>
                                <div>
                                    <p class="text-white font-medium">John Smith - HVAC Solutions Inc</p>
                                    <p class="text-sm text-slate-400">Apollo AI • Qualified Lead • 2 hours ago</p>
                                </div>
                            </div>
                            <button class="px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white text-sm rounded-lg transition-colors">
                                Contact
                            </button>
                        </div>
                        
                        <div class="flex items-center justify-between p-3 bg-slate-800/30 rounded-lg">
                            <div class="flex items-center">
                                <div class="w-2 h-2 bg-yellow-500 rounded-full mr-3"></div>
                                <div>
                                    <p class="text-white font-medium">Sarah Johnson - Climate Control Pro</p>
                                    <p class="text-sm text-slate-400">LinkedIn Sales Navigator • Follow-up • 1 day ago</p>
                                </div>
                            </div>
                            <button class="px-4 py-2 bg-green-600 hover:bg-green-700 text-white text-sm rounded-lg transition-colors">
                                Call Now
                            </button>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- AI Scripts Tab -->
            <div id="scripts-tab" class="tab-content hidden p-6">
                <div class="mb-8">
                    <h2 class="text-3xl font-bold gradient-text mb-4">AI Script Generation & Management</h2>
                    <p class="text-slate-400 mb-6">Create personalized call scripts with AI assistance and proven templates</p>
                </div>

                <!-- Script Generation Tools -->
                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 mb-8">
                    <!-- Generate New Script -->
                    <div class="card-modern rounded-2xl p-6 hover:shadow-2xl transition-all duration-300">
                        <div class="flex items-center mb-4">
                            <div class="w-12 h-12 bg-green-500/20 rounded-xl flex items-center justify-center">
                                <i class="fas fa-magic text-2xl text-green-400"></i>
                            </div>
                            <div class="ml-4">
                                <h3 class="text-lg font-bold text-white">AI Script Generator</h3>
                                <p class="text-sm text-slate-400">Create Custom Scripts</p>
                            </div>
                        </div>
                        <p class="text-slate-300 text-sm mb-4">Generate personalized call scripts based on lead information, industry, and campaign goals.</p>
                        <button id="generate-script-btn" class="w-full btn-success px-4 py-3 rounded-lg text-white font-semibold">
                            <i class="fas fa-wand-magic-sparkles mr-2"></i>Generate Script
                        </button>
                    </div>

                    <!-- Script Templates -->
                    <div class="card-modern rounded-2xl p-6 hover:shadow-2xl transition-all duration-300">
                        <div class="flex items-center mb-4">
                            <div class="w-12 h-12 bg-blue-500/20 rounded-xl flex items-center justify-center">
                                <i class="fas fa-file-contract text-2xl text-blue-400"></i>
                            </div>
                            <div class="ml-4">
                                <h3 class="text-lg font-bold text-white">Proven Templates</h3>
                                <p class="text-sm text-slate-400">Industry-Specific</p>
                            </div>
                        </div>
                        <p class="text-slate-300 text-sm mb-4">Access proven script templates for HVAC, home services, B2B, and other industries.</p>
                        <button id="browse-templates-btn" class="w-full btn-primary px-4 py-3 rounded-lg text-white font-semibold">
                            <i class="fas fa-clipboard-list mr-2"></i>Browse Templates
                        </button>
                    </div>

                    <!-- Script Optimizer -->
                    <div class="card-modern rounded-2xl p-6 hover:shadow-2xl transition-all duration-300">
                        <div class="flex items-center mb-4">
                            <div class="w-12 h-12 bg-purple-500/20 rounded-xl flex items-center justify-center">
                                <i class="fas fa-chart-line text-2xl text-purple-400"></i>
                            </div>
                            <div class="ml-4">
                                <h3 class="text-lg font-bold text-white">Script Optimizer</h3>
                                <p class="text-sm text-slate-400">Performance-Based</p>
                            </div>
                        </div>
                        <p class="text-slate-300 text-sm mb-4">Optimize scripts based on performance data and AI recommendations for better conversion rates.</p>
                        <button id="optimize-scripts-btn" class="w-full bg-purple-600 hover:bg-purple-700 px-4 py-3 rounded-lg text-white font-semibold transition-colors">
                            <i class="fas fa-rocket mr-2"></i>Optimize Scripts
                        </button>
                    </div>
                </div>

                <!-- Recent Scripts -->
                <div class="card-modern rounded-2xl p-6 mb-6">
                    <div class="flex items-center justify-between mb-4">
                        <h3 class="text-xl font-bold gradient-text">Your Recent Scripts</h3>
                        <div class="flex space-x-2">
                            <button id="new-script-btn" class="px-3 py-2 bg-blue-600 hover:bg-blue-700 text-white text-xs rounded-lg transition-colors">
                                <i class="fas fa-upload mr-1"></i>Import AI Script
                            </button>
                            <button id="ai-actors-guild-btn" class="px-3 py-2 bg-purple-600 hover:bg-purple-700 text-white text-xs rounded-lg transition-colors">
                                <i class="fas fa-theater-masks mr-1"></i>AI Guild Training
                            </button>
                        </div>
                    </div>
                    
                    <div class="space-y-4">
                        <div class="flex items-center justify-between p-4 bg-slate-800/30 rounded-lg">
                            <div class="flex items-center">
                                <div class="w-10 h-10 bg-green-500/20 rounded-lg flex items-center justify-center mr-4">
                                    <i class="fas fa-file-alt text-green-400"></i>
                                </div>
                                <div>
                                    <p class="text-white font-medium">HVAC Maintenance Cold Call Script</p>
                                    <p class="text-sm text-slate-400">Created 2 hours ago • 87% conversion rate • AI Optimized</p>
                                </div>
                            </div>
                            <div class="flex space-x-2">
                                <button class="view-script-btn px-3 py-2 bg-blue-600 hover:bg-blue-700 text-white text-sm rounded-lg transition-colors" data-script-id="hvac-maintenance-1">
                                    <i class="fas fa-eye mr-1"></i>View
                                </button>
                                <button class="use-script-btn px-3 py-2 bg-green-600 hover:bg-green-700 text-white text-sm rounded-lg transition-colors" data-script-id="hvac-maintenance-1">
                                    <i class="fas fa-phone mr-1"></i>Use
                                </button>
                            </div>
                        </div>

                        <div class="flex items-center justify-between p-4 bg-slate-800/30 rounded-lg">
                            <div class="flex items-center">
                                <div class="w-10 h-10 bg-blue-500/20 rounded-lg flex items-center justify-center mr-4">
                                    <i class="fas fa-file-alt text-blue-400"></i>
                                </div>
                                <div>
                                    <p class="text-white font-medium">New Customer Acquisition - Residential HVAC</p>
                                    <p class="text-sm text-slate-400">Created yesterday • 72% conversion rate • Template-based</p>
                                </div>
                            </div>
                            <div class="flex space-x-2">
                                <button class="view-script-btn px-3 py-2 bg-blue-600 hover:bg-blue-700 text-white text-sm rounded-lg transition-colors" data-script-id="new-customer-1">
                                    <i class="fas fa-eye mr-1"></i>View
                                </button>
                                <button class="optimize-script-btn px-3 py-2 bg-yellow-600 hover:bg-yellow-700 text-white text-sm rounded-lg transition-colors" data-script-id="new-customer-1">
                                    <i class="fas fa-chart-line mr-1"></i>Optimize
                                </button>
                            </div>
                        </div>

                        <div class="flex items-center justify-between p-4 bg-slate-800/30 rounded-lg">
                            <div class="flex items-center">
                                <div class="w-10 h-10 bg-purple-500/20 rounded-lg flex items-center justify-center mr-4">
                                    <i class="fas fa-file-alt text-purple-400"></i>
                                </div>
                                <div>
                                    <p class="text-white font-medium">Follow-up Call - Service Appointment</p>
                                    <p class="text-sm text-slate-400">Created 3 days ago • 91% conversion rate • Custom AI</p>
                                </div>
                            </div>
                            <div class="flex space-x-2">
                                <button class="view-script-btn px-3 py-2 bg-blue-600 hover:bg-blue-700 text-white text-sm rounded-lg transition-colors" data-script-id="follow-up-appointment">
                                    <i class="fas fa-eye mr-1"></i>View
                                </button>
                                <button class="clone-script-btn px-3 py-2 bg-green-600 hover:bg-green-700 text-white text-sm rounded-lg transition-colors" data-script-id="follow-up-appointment">
                                    <i class="fas fa-copy mr-1"></i>Clone
                                </button>
                                <button class="share-script-btn px-3 py-2 bg-slate-600 hover:bg-slate-700 text-white text-sm rounded-lg transition-colors" data-script-id="follow-up-appointment">
                                    <i class="fas fa-share-alt mr-1"></i>Share
                                </button>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Script Categories -->
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                    <div class="card-modern rounded-xl p-4">
                        <h4 class="text-lg font-bold text-white mb-3">Popular Templates</h4>
                        <div class="space-y-2">
                            <div class="flex items-center justify-between p-2 hover:bg-slate-800/30 rounded-lg cursor-pointer">
                                <span class="text-slate-300">HVAC Emergency Service</span>
                                <span class="text-green-400 text-sm">94% rate</span>
                            </div>
                            <div class="flex items-center justify-between p-2 hover:bg-slate-800/30 rounded-lg cursor-pointer">
                                <span class="text-slate-300">Seasonal Maintenance</span>
                                <span class="text-blue-400 text-sm">88% rate</span>
                            </div>
                            <div class="flex items-center justify-between p-2 hover:bg-slate-800/30 rounded-lg cursor-pointer">
                                <span class="text-slate-300">System Replacement</span>
                                <span class="text-purple-400 text-sm">76% rate</span>
                            </div>
                        </div>
                    </div>

                    <div class="card-modern rounded-xl p-4">
                        <h4 class="text-lg font-bold text-white mb-3">Performance Stats</h4>
                        <div class="space-y-3">
                            <div class="flex items-center justify-between">
                                <span class="text-slate-300">Average Conversion</span>
                                <span class="text-green-400 font-semibold">82.3%</span>
                            </div>
                            <div class="flex items-center justify-between">
                                <span class="text-slate-300">Scripts Created</span>
                                <span class="text-blue-400 font-semibold">27</span>
                            </div>
                            <div class="flex items-center justify-between">
                                <span class="text-slate-300">AI Optimizations</span>
                                <span class="text-purple-400 font-semibold">15</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Voice AI Tab -->
            <div id="voicecalling-tab" class="tab-content hidden p-6">
                <div class="mb-8">
                    <h2 class="text-3xl font-bold gradient-text mb-4">AI-Powered Voice Calling</h2>
                    <p class="text-slate-400 mb-6">Launch intelligent voice campaigns with AI coaching and real-time insights</p>
                </div>

                <!-- Quick Actions -->
                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 mb-8">
                    <!-- Start New Campaign -->
                    <div class="card-modern rounded-2xl p-6 hover:shadow-2xl transition-all duration-300">
                        <div class="flex items-center mb-4">
                            <div class="w-12 h-12 bg-blue-500/20 rounded-xl flex items-center justify-center">
                                <i class="fas fa-play text-2xl text-blue-400"></i>
                            </div>
                            <div class="ml-4">
                                <h3 class="text-lg font-bold text-white">Start Campaign</h3>
                                <p class="text-sm text-slate-400">Launch AI Voice Call</p>
                            </div>
                        </div>
                        <p class="text-slate-300 text-sm mb-4">Begin an automated voice calling campaign with AI-generated scripts and real-time coaching.</p>
                        
                        <!-- Campaign Status Display -->
                        <div id="campaign-status-display" class="hidden bg-slate-700/30 rounded-xl p-4 mb-4">
                            <div class="flex items-center justify-between mb-2">
                                <div class="flex items-center">
                                    <div class="w-3 h-3 bg-green-500 rounded-full mr-2 animate-pulse"></div>
                                    <span class="text-white font-semibold" id="active-campaign-name">HVAC Maintenance Campaign</span>
                                </div>
                                <span class="px-2 py-1 bg-green-500/20 text-green-400 text-xs rounded-full">Active</span>
                            </div>
                            <div class="text-sm text-slate-400">
                                <div class="flex justify-between items-center">
                                    <span>Calls made: <span id="calls-made-count">47</span></span>
                                    <span>Duration: <span id="campaign-duration">2h 15m</span></span>
                                </div>
                                <div class="flex justify-between items-center mt-1">
                                    <span>Appointments: <span id="appointments-count">12</span></span>
                                    <span>Success rate: <span id="success-rate">25.5%</span></span>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Campaign Control Buttons -->
                        <div id="campaign-controls">
                            <button id="start-calling-btn" class="w-full btn-primary px-4 py-3 rounded-lg text-white font-semibold mb-2">
                                <i class="fas fa-microphone mr-2"></i>Start Calling Now
                            </button>
                            
                            <!-- Campaign Management Buttons (Hidden initially) -->
                            <div id="active-campaign-controls" class="hidden grid grid-cols-2 gap-2">
                                <button id="pause-campaign-btn" class="btn-warning px-4 py-3 rounded-lg text-white font-semibold transition-colors bg-yellow-600 hover:bg-yellow-700">
                                    <i class="fas fa-pause mr-2"></i>Pause Campaign
                                </button>
                                <button id="cancel-campaign-btn" class="bg-red-600 hover:bg-red-700 px-4 py-3 rounded-lg text-white font-semibold transition-colors">
                                    <i class="fas fa-stop mr-2"></i>Cancel Campaign
                                </button>
                            </div>
                        </div>
                    </div>

                    <!-- Call Analytics -->
                    <div class="card-modern rounded-2xl p-6 hover:shadow-2xl transition-all duration-300">
                        <div class="flex items-center mb-4">
                            <div class="w-12 h-12 bg-purple-500/20 rounded-xl flex items-center justify-center">
                                <i class="fas fa-chart-line text-2xl text-purple-400"></i>
                            </div>
                            <div class="ml-4">
                                <h3 class="text-lg font-bold text-white">Call Analytics</h3>
                                <p class="text-sm text-slate-400">Performance Insights</p>
                            </div>
                        </div>
                        <p class="text-slate-300 text-sm mb-4">View detailed analytics, conversion rates, and AI-powered insights from your voice campaigns.</p>
                        <button id="view-analytics-btn" class="w-full bg-purple-600 hover:bg-purple-700 px-4 py-3 rounded-lg text-white font-semibold transition-colors">
                            <i class="fas fa-analytics mr-2"></i>View Analytics
                        </button>
                    </div>

                    <!-- Voice Training -->
                    <div class="card-modern rounded-2xl p-6 hover:shadow-2xl transition-all duration-300">
                        <div class="flex items-center mb-4">
                            <div class="w-12 h-12 bg-green-500/20 rounded-xl flex items-center justify-center">
                                <i class="fas fa-graduation-cap text-2xl text-green-400"></i>
                            </div>
                            <div class="ml-4">
                                <h3 class="text-lg font-bold text-white">AI Voice Training</h3>
                                <p class="text-sm text-slate-400">Improve Performance</p>
                            </div>
                        </div>
                        <p class="text-slate-300 text-sm mb-4">Get real-time coaching and suggestions to improve your calling techniques and conversion rates.</p>
                        <button id="start-voice-training-btn" class="w-full btn-success px-4 py-3 rounded-lg text-white font-semibold">
                            <i class="fas fa-brain mr-2"></i>Start Training
                        </button>
                    </div>

                    <!-- AI Voice Management -->
                    <div class="card-modern rounded-2xl p-6 hover:shadow-2xl transition-all duration-300">
                        <div class="flex items-center mb-4">
                            <div class="w-12 h-12 bg-indigo-500/20 rounded-xl flex items-center justify-center">
                                <i class="fas fa-cogs text-2xl text-indigo-400"></i>
                            </div>
                            <div class="ml-4">
                                <h3 class="text-lg font-bold text-white">Voice Management</h3>
                                <p class="text-sm text-slate-400">Configure AI Voices</p>
                            </div>
                        </div>
                        <p class="text-slate-300 text-sm mb-4">Manage AI voice profiles, create custom voices, and test voice configurations for optimal campaign performance.</p>
                        <button id="manage-voices-btn" class="w-full bg-indigo-600 hover:bg-indigo-700 px-4 py-3 rounded-lg text-white font-semibold transition-colors">
                            <i class="fas fa-sliders-h mr-2"></i>Manage Voices
                        </button>
                    </div>
                </div>

                <!-- Active Campaigns -->
                <div class="card-modern rounded-2xl p-6 mb-6">
                    <h3 class="text-xl font-bold gradient-text mb-4">Active Voice Campaigns</h3>
                    <div class="space-y-4">
                        <div class="flex items-center justify-between p-4 bg-slate-800/30 rounded-lg">
                            <div class="flex items-center">
                                <div class="w-3 h-3 bg-green-500 rounded-full mr-4 animate-pulse"></div>
                                <div>
                                    <p class="text-white font-medium">HVAC Maintenance Outreach</p>
                                    <p class="text-sm text-slate-400">47 calls completed • 12 appointments scheduled</p>
                                </div>
                            </div>
                            <div class="flex space-x-2">
                                <button class="px-4 py-2 bg-yellow-600 hover:bg-yellow-700 text-white text-sm rounded-lg transition-colors">
                                    <i class="fas fa-pause mr-1"></i>Pause
                                </button>
                                <button class="px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white text-sm rounded-lg transition-colors">
                                    <i class="fas fa-eye mr-1"></i>Monitor
                                </button>
                            </div>
                        </div>

                        <div class="flex items-center justify-between p-4 bg-slate-800/30 rounded-lg">
                            <div class="flex items-center">
                                <div class="w-3 h-3 bg-blue-500 rounded-full mr-4"></div>
                                <div>
                                    <p class="text-white font-medium">New Customer Acquisition</p>
                                    <p class="text-sm text-slate-400">23 calls completed • 8 interested prospects</p>
                                </div>
                            </div>
                            <div class="flex space-x-2">
                                <button class="px-4 py-2 bg-green-600 hover:bg-green-700 text-white text-sm rounded-lg transition-colors">
                                    <i class="fas fa-play mr-1"></i>Resume
                                </button>
                                <button class="px-4 py-2 bg-slate-600 hover:bg-slate-700 text-white text-sm rounded-lg transition-colors">
                                    <i class="fas fa-cog mr-1"></i>Settings
                                </button>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Performance Metrics -->
                <div class="grid grid-cols-2 md:grid-cols-4 gap-4">
                    <div class="card-modern rounded-xl p-4 text-center">
                        <p class="text-2xl font-bold text-green-400">78%</p>
                        <p class="text-sm text-slate-400">Connection Rate</p>
                    </div>
                    <div class="card-modern rounded-xl p-4 text-center">
                        <p class="text-2xl font-bold text-blue-400">156</p>
                        <p class="text-sm text-slate-400">Calls Today</p>
                    </div>
                    <div class="card-modern rounded-xl p-4 text-center">
                        <p class="text-2xl font-bold text-purple-400">24</p>
                        <p class="text-sm text-slate-400">Appointments</p>
                    </div>
                    <div class="card-modern rounded-xl p-4 text-center">
                        <p class="text-2xl font-bold text-yellow-400">15.3%</p>
                        <p class="text-sm text-slate-400">Conversion Rate</p>
                    </div>
                </div>
            </div>
            
            <!-- Meetings Tab -->
            <div id="meetings-tab" class="tab-content hidden p-6">
                <div class="mb-8">
                    <h2 class="text-3xl font-bold gradient-text mb-4">Appointment Scheduling</h2>
                    <p class="text-slate-400 mb-6">Manage appointments and follow-up meetings with leads and customers</p>
                </div>

                <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                    <!-- Calendar Integration - Direct Buttons Solution -->
                    <div class="card-modern rounded-2xl p-6">
                        <h3 class="text-xl font-bold gradient-text mb-4">Calendar Integration</h3>
                        <div class="space-y-4">
                            <!-- Direct Calendar Buttons (No Iframe) -->
                            <button 
                                onclick="if(/iPhone|iPad|iPod|Android/i.test(navigator.userAgent)){window.location.href='https://accounts.google.com/signin';}else{window.open('https://accounts.google.com/signin','_blank');}"
                                class="w-full bg-blue-600 hover:bg-blue-700 text-white py-3 px-4 rounded-lg transition-colors font-medium border border-blue-500 hover:border-blue-400 shadow-lg hover:shadow-xl transform hover:-translate-y-0.5">
                                <i class="fab fa-google mr-2"></i>Connect Google Calendar
                            </button>
                            
                            <button 
                                onclick="if(/iPhone|iPad|iPod|Android/i.test(navigator.userAgent)){window.location.href='https://login.microsoftonline.com/';}else{window.open('https://login.microsoftonline.com/','_blank');}"
                                class="w-full bg-blue-800 hover:bg-blue-900 text-white py-3 px-4 rounded-lg transition-colors font-medium border border-blue-600 hover:border-blue-500 shadow-lg hover:shadow-xl transform hover:-translate-y-0.5">
                                <i class="fab fa-microsoft mr-2"></i>Connect Outlook
                            </button>
                            
                            <button 
                                id="main-schedule-btn"
                                onclick="openScheduleModal()"
                                class="w-full bg-green-600 hover:bg-green-700 text-white py-3 px-4 rounded-lg transition-colors font-medium border border-green-500 hover:border-green-400 shadow-lg hover:shadow-xl transform hover:-translate-y-0.5">
                                <i class="fas fa-calendar-plus mr-2"></i>Schedule New Appointment
                            </button>
                        </div>
                        <p class="text-xs text-slate-500 mt-4">
                            <i class="fas fa-info-circle mr-1"></i>
                            Direct calendar integration - optimized for mobile and desktop
                        </p>
                    </div>

                    <!-- Upcoming Appointments -->
                    <div class="card-modern rounded-2xl p-6">
                        <h3 class="text-xl font-bold gradient-text mb-4">Upcoming Appointments</h3>
                        <div class="space-y-3">
                            <div class="p-3 bg-slate-800/30 rounded-lg">
                                <div class="flex justify-between items-center">
                                    <div class="flex-1">
                                        <p class="text-white font-medium">HVAC System Consultation</p>
                                        <p class="text-sm text-slate-400">Today, 2:30 PM • John Smith</p>
                                    </div>
                                    <button onclick="researchProspect('John Smith', 'HVAC System Consultation', 'Today, 2:30 PM')" 
                                            class="ml-3 px-3 py-1 bg-purple-600 hover:bg-purple-700 text-white text-xs rounded-lg transition-colors">
                                        <i class="fas fa-search mr-1"></i>AI Research
                                    </button>
                                </div>
                            </div>
                            <div class="p-3 bg-slate-800/30 rounded-lg">
                                <div class="flex justify-between items-center">
                                    <div class="flex-1">
                                        <p class="text-white font-medium">Maintenance Quote Meeting</p>
                                        <p class="text-sm text-slate-400">Tomorrow, 10:00 AM • Sarah Johnson</p>
                                    </div>
                                    <button onclick="researchProspect('Sarah Johnson', 'Maintenance Quote Meeting', 'Tomorrow, 10:00 AM')" 
                                            class="ml-3 px-3 py-1 bg-purple-600 hover:bg-purple-700 text-white text-xs rounded-lg transition-colors">
                                        <i class="fas fa-search mr-1"></i>AI Research
                                    </button>
                                </div>
                            </div>
                            <div class="p-3 bg-slate-800/30 rounded-lg">
                                <div class="flex justify-between items-center">
                                    <div class="flex-1">
                                        <p class="text-white font-medium">Follow-up Call</p>
                                        <p class="text-sm text-slate-400">Friday, 3:15 PM • Mike Wilson</p>
                                    </div>
                                    <button onclick="researchProspect('Mike Wilson', 'Follow-up Call', 'Friday, 3:15 PM')" 
                                            class="ml-3 px-3 py-1 bg-purple-600 hover:bg-purple-700 text-white text-xs rounded-lg transition-colors">
                                        <i class="fas fa-search mr-1"></i>AI Research
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Research Tab -->
            <div id="research-tab" class="tab-content hidden p-6">
                <div class="mb-8">
                    <h2 class="text-3xl font-bold gradient-text mb-4">Lead Research & Intelligence</h2>
                    <p class="text-slate-400 mb-6">Research prospects and companies with AI-powered insights</p>
                </div>

                <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                    <!-- Research Tools -->
                    <div class="card-modern rounded-2xl p-6">
                        <h3 class="text-xl font-bold gradient-text mb-4">Research Tools</h3>
                        <div class="space-y-3">
                            <div class="p-4 bg-slate-800/30 rounded-lg">
                                <h4 class="text-white font-medium mb-2">Company Intelligence</h4>
                                <p class="text-sm text-slate-400 mb-3">Get detailed company information, technographics, and decision-maker insights.</p>
                                <button onclick="openResearchModal()" class="px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white text-sm rounded-lg transition-colors">
                                    Start Research
                                </button>
                            </div>
                            <div class="p-4 bg-slate-800/30 rounded-lg">
                                <h4 class="text-white font-medium mb-2">Contact Enrichment</h4>
                                <p class="text-sm text-slate-400 mb-3">Enrich lead data with email, phone, social profiles, and job details.</p>
                                <button onclick="openEnrichmentModal()" class="px-4 py-2 bg-green-600 hover:bg-green-700 text-white text-sm rounded-lg transition-colors">
                                    Enrich Contacts
                                </button>
                            </div>
                            <div class="p-4 bg-slate-800/30 rounded-lg border-l-4 border-purple-500">
                                <h4 class="text-white font-medium mb-2">🤖 AI Prospect Research</h4>
                                <p class="text-sm text-slate-400 mb-3">Comprehensive AI-powered research on your appointment prospects including background, social media, facility info, and preparation insights.</p>
                                <button onclick="openAIResearchDashboard()" class="px-4 py-2 bg-purple-600 hover:bg-purple-700 text-white text-sm rounded-lg transition-colors">
                                    <i class="fas fa-brain mr-2"></i>AI Research Dashboard
                                </button>
                            </div>
                        </div>
                    </div>

                    <!-- Search Results -->
                    <div class="card-modern rounded-2xl p-6">
                        <h3 class="text-xl font-bold gradient-text mb-4">Recent Research</h3>
                        <div class="space-y-3">
                            <div class="p-3 bg-slate-800/30 rounded-lg">
                                <p class="text-white font-medium">HVAC Solutions Inc.</p>
                                <p class="text-sm text-slate-400">50+ employees • $5M revenue • Decision maker: John Smith (CEO)</p>
                            </div>
                            <div class="p-3 bg-slate-800/30 rounded-lg">
                                <p class="text-white font-medium">Climate Control Pro</p>
                                <p class="text-sm text-slate-400">25+ employees • $2M revenue • Contact enriched with mobile number</p>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- AI Call Analysis Section -->
                <div class="mt-8">
                    <h2 class="text-2xl font-bold gradient-text mb-6">📞 AI Call Analysis & Notes</h2>
                    
                    <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                        <!-- Call Logging -->
                        <div class="card-modern rounded-2xl p-6">
                            <h3 class="text-xl font-bold gradient-text mb-4">Call Logging</h3>
                            <div class="space-y-3">
                                <button onclick="logNewCall()" class="w-full p-4 bg-green-600 hover:bg-green-700 text-white rounded-lg transition-colors font-medium text-left">
                                    <i class="fas fa-plus mr-2"></i>Log New Call
                                    <p class="text-sm text-green-200 mt-1">Record call details and AI-powered analysis</p>
                                </button>
                                <button onclick="openCallAnalyticsDashboard()" class="w-full p-4 bg-purple-600 hover:bg-purple-700 text-white rounded-lg transition-colors font-medium text-left">
                                    <i class="fas fa-chart-line mr-2"></i>Call Analytics Dashboard
                                    <p class="text-sm text-purple-200 mt-1">View detailed call performance and trends</p>
                                </button>
                            </div>
                        </div>
                        
                        <!-- Recent Call Notes -->
                        <div class="card-modern rounded-2xl p-6">
                            <h3 class="text-xl font-bold gradient-text mb-4">Recent Call Notes</h3>
                            <div class="space-y-3">
                                <div class="p-3 bg-slate-800/30 rounded-lg cursor-pointer hover:bg-slate-800/50 transition-colors" onclick="viewCallDetails('call-001')">
                                    <div class="flex justify-between items-start">
                                        <div>
                                            <p class="text-white font-medium">John Smith - HVAC Solutions Inc.</p>
                                            <p class="text-sm text-slate-400">Today, 2:15 PM • 8 min call</p>
                                            <p class="text-xs text-green-400">✅ Appointment Scheduled</p>
                                        </div>
                                        <span class="px-2 py-1 bg-green-600 text-white text-xs rounded-full">94% Score</span>
                                    </div>
                                </div>
                                <div class="p-3 bg-slate-800/30 rounded-lg cursor-pointer hover:bg-slate-800/50 transition-colors" onclick="viewCallDetails('call-002')">
                                    <div class="flex justify-between items-start">
                                        <div>
                                            <p class="text-white font-medium">Sarah Johnson - Climate Control Pro</p>
                                            <p class="text-sm text-slate-400">Yesterday, 4:20 PM • 5 min call</p>
                                            <p class="text-xs text-yellow-400">📞 Follow-up Needed</p>
                                        </div>
                                        <span class="px-2 py-1 bg-yellow-600 text-white text-xs rounded-full">72% Score</span>
                                    </div>
                                </div>
                                <div class="p-3 bg-slate-800/30 rounded-lg cursor-pointer hover:bg-slate-800/50 transition-colors" onclick="viewCallDetails('call-003')">
                                    <div class="flex justify-between items-start">
                                        <div>
                                            <p class="text-white font-medium">Mike Wilson - BuildTech Services</p>
                                            <p class="text-sm text-slate-400">2 days ago • 3 min call</p>
                                            <p class="text-xs text-red-400">❌ Not Interested</p>
                                        </div>
                                        <span class="px-2 py-1 bg-red-600 text-white text-xs rounded-full">31% Score</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Analytics Tab -->
            <div id="analytics-tab" class="tab-content hidden p-6">
                <div class="mb-8">
                    <h2 class="text-3xl font-bold gradient-text mb-4">Analytics & Reporting</h2>
                    <p class="text-slate-400 mb-6">Track performance metrics and ROI across all campaigns and integrations</p>
                </div>

                <div class="grid grid-cols-2 md:grid-cols-4 gap-4 mb-6">
                    <div class="card-modern rounded-xl p-4 text-center">
                        <p class="text-2xl font-bold text-green-400">$47K</p>
                        <p class="text-sm text-slate-400">Revenue This Month</p>
                    </div>
                    <div class="card-modern rounded-xl p-4 text-center">
                        <p class="text-2xl font-bold text-blue-400">324</p>
                        <p class="text-sm text-slate-400">Calls Made</p>
                    </div>
                    <div class="card-modern rounded-xl p-4 text-center">
                        <p class="text-2xl font-bold text-purple-400">18.5%</p>
                        <p class="text-sm text-slate-400">Conversion Rate</p>
                    </div>
                    <div class="card-modern rounded-xl p-4 text-center">
                        <p class="text-2xl font-bold text-yellow-400">89</p>
                        <p class="text-sm text-slate-400">New Leads</p>
                    </div>
                </div>

                <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                    <div class="card-modern rounded-2xl p-6">
                        <h3 class="text-xl font-bold gradient-text mb-4">Integration Performance</h3>
                        <div class="space-y-3">
                            <div class="flex items-center justify-between p-3 bg-slate-800/30 rounded-lg">
                                <span class="text-white">Apollo AI</span>
                                <span class="text-green-400 font-semibold">89 leads • 23% conv.</span>
                            </div>
                            <div class="flex items-center justify-between p-3 bg-slate-800/30 rounded-lg">
                                <span class="text-white">LinkedIn Sales Nav</span>
                                <span class="text-blue-400 font-semibold">67 leads • 31% conv.</span>
                            </div>
                            <div class="flex items-center justify-between p-3 bg-slate-800/30 rounded-lg">
                                <span class="text-white">Seamless AI</span>
                                <span class="text-purple-400 font-semibold">45 leads • 19% conv.</span>
                            </div>
                        </div>
                    </div>

                    <div class="card-modern rounded-2xl p-6">
                        <h3 class="text-xl font-bold gradient-text mb-4">Campaign ROI</h3>
                        <div class="space-y-3">
                            <div class="p-3 bg-slate-800/30 rounded-lg">
                                <p class="text-white font-medium">HVAC Maintenance Campaign</p>
                                <p class="text-sm text-slate-400">ROI: 340% • Revenue: $23,400</p>
                            </div>
                            <div class="p-3 bg-slate-800/30 rounded-lg">
                                <p class="text-white font-medium">New Customer Acquisition</p>
                                <p class="text-sm text-slate-400">ROI: 215% • Revenue: $18,900</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Manual Lead Entry Modal -->
    <div id="leadModal" class="fixed inset-0 bg-black/50 backdrop-blur-sm hidden z-50 flex items-center justify-center p-4">
        <div class="bg-slate-800 rounded-2xl p-6 w-full max-w-md mx-auto border border-slate-600 shadow-2xl">
            <div class="flex items-center justify-between mb-6">
                <h3 class="text-xl font-bold gradient-text">Add New Lead</h3>
                <button id="closeModal" class="text-slate-400 hover:text-white transition-colors">
                    <i class="fas fa-times text-xl"></i>
                </button>
            </div>
            
            <form id="leadForm" class="space-y-4">
                <div class="grid grid-cols-2 gap-4">
                    <div>
                        <label class="block text-sm font-medium text-slate-300 mb-2">First Name *</label>
                        <input type="text" id="firstName" required class="w-full px-3 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white placeholder-slate-400 focus:border-blue-500 focus:ring-1 focus:ring-blue-500" placeholder="John">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-slate-300 mb-2">Last Name *</label>
                        <input type="text" id="lastName" required class="w-full px-3 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white placeholder-slate-400 focus:border-blue-500 focus:ring-1 focus:ring-blue-500" placeholder="Smith">
                    </div>
                </div>
                
                <div>
                    <label class="block text-sm font-medium text-slate-300 mb-2">Company *</label>
                    <input type="text" id="company" required class="w-full px-3 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white placeholder-slate-400 focus:border-blue-500 focus:ring-1 focus:ring-blue-500" placeholder="HVAC Solutions Inc">
                </div>
                
                <div class="grid grid-cols-2 gap-4">
                    <div>
                        <label class="block text-sm font-medium text-slate-300 mb-2">Email *</label>
                        <input type="email" id="email" required class="w-full px-3 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white placeholder-slate-400 focus:border-blue-500 focus:ring-1 focus:ring-blue-500" placeholder="john@hvac.com">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-slate-300 mb-2">Phone</label>
                        <input type="tel" id="phone" class="w-full px-3 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white placeholder-slate-400 focus:border-blue-500 focus:ring-1 focus:ring-blue-500" placeholder="(555) 123-4567">
                    </div>
                </div>
                
                <div>
                    <label class="block text-sm font-medium text-slate-300 mb-2">Job Title</label>
                    <input type="text" id="jobTitle" class="w-full px-3 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white placeholder-slate-400 focus:border-blue-500 focus:ring-1 focus:ring-blue-500" placeholder="CEO, Manager, etc.">
                </div>
                
                <div>
                    <label class="block text-sm font-medium text-slate-300 mb-2">Lead Source</label>
                    <select id="leadSource" class="w-full px-3 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white focus:border-blue-500 focus:ring-1 focus:ring-blue-500">
                        <option value="manual">Manual Entry</option>
                        <option value="referral">Referral</option>
                        <option value="website">Website</option>
                        <option value="cold-call">Cold Call</option>
                        <option value="networking">Networking</option>
                        <option value="other">Other</option>
                    </select>
                </div>
                
                <div>
                    <label class="block text-sm font-medium text-slate-300 mb-2">Notes</label>
                    <textarea id="notes" rows="3" class="w-full px-3 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white placeholder-slate-400 focus:border-blue-500 focus:ring-1 focus:ring-blue-500" placeholder="Additional notes about this lead..."></textarea>
                </div>
                
                <div class="flex space-x-3 pt-4">
                    <button type="button" id="cancelLead" class="flex-1 px-4 py-2 bg-slate-600 hover:bg-slate-700 text-white rounded-lg transition-colors">
                        Cancel
                    </button>
                    <button type="submit" class="flex-1 px-4 py-2 btn-success text-white rounded-lg font-semibold">
                        <i class="fas fa-plus mr-1"></i>Add Lead
                    </button>
                </div>
            </form>
        </div>
    </div>

    <!-- CSV Import Modal -->
    <div id="csvModal" class="fixed inset-0 bg-black/50 backdrop-blur-sm hidden z-50 flex items-center justify-center p-4">
        <div class="bg-slate-800 rounded-2xl p-6 w-full max-w-md mx-auto border border-slate-600 shadow-2xl">
            <div class="flex items-center justify-between mb-6">
                <h3 class="text-xl font-bold gradient-text">Import CSV File</h3>
                <button id="closeCsvModal" class="text-slate-400 hover:text-white transition-colors">
                    <i class="fas fa-times text-xl"></i>
                </button>
            </div>
            
            <div class="space-y-4">
                <div class="border-2 border-dashed border-slate-600 rounded-lg p-6 text-center">
                    <i class="fas fa-cloud-upload-alt text-3xl text-slate-400 mb-3"></i>
                    <p class="text-slate-300 mb-2">Drag & drop your CSV file here</p>
                    <p class="text-sm text-slate-400 mb-4">or click to browse</p>
                    <input type="file" id="csvFile" accept=".csv" class="hidden">
                    <button type="button" onclick="document.getElementById('csvFile').click()" class="px-4 py-2 btn-primary text-white rounded-lg">
                        Choose File
                    </button>
                </div>
                
                <div class="text-sm text-slate-400">
                    <p class="mb-2"><strong>Required columns:</strong></p>
                    <ul class="space-y-1 pl-4">
                        <li>• First Name</li>
                        <li>• Last Name</li>
                        <li>• Company</li>
                        <li>• Email</li>
                        <li>• Phone (optional)</li>
                        <li>• Job Title (optional)</li>
                    </ul>
                </div>
                
                <div class="flex space-x-3 pt-4">
                    <button type="button" id="cancelCsv" class="flex-1 px-4 py-2 bg-slate-600 hover:bg-slate-700 text-white rounded-lg transition-colors">
                        Cancel
                    </button>
                    <button type="button" id="uploadCsv" class="flex-1 px-4 py-2 btn-success text-white rounded-lg font-semibold">
                        <i class="fas fa-upload mr-1"></i>Import
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- ProSpector Authentication Modals -->
    <div id="loginModal" class="fixed inset-0 bg-black/50 backdrop-blur-sm hidden z-50 flex items-center justify-center p-4">
        <div class="bg-slate-800 rounded-2xl p-6 w-full max-w-md mx-auto border border-slate-600 shadow-2xl">
            <div class="flex items-center justify-between mb-6">
                <h3 class="text-xl font-bold gradient-text">ProSpector Login</h3>
                <button id="closeLoginModal" class="text-slate-400 hover:text-white transition-colors">
                    <i class="fas fa-times text-xl"></i>
                </button>
            </div>
            <form id="loginForm" class="space-y-4">
                <input type="email" id="loginEmail" required class="w-full px-3 py-3 bg-slate-700 border border-slate-600 rounded-lg text-white" placeholder="Email Address">
                <input type="password" id="loginPassword" required class="w-full px-3 py-3 bg-slate-700 border border-slate-600 rounded-lg text-white" placeholder="Password">
                <button type="submit" class="w-full btn-primary px-4 py-3 rounded-lg text-white font-semibold">
                    <i class="fas fa-sign-in-alt mr-2"></i>Sign In to ProSpector
                </button>
            </form>
        </div>
    </div>

    <div id="signupModal" class="fixed inset-0 bg-black/50 backdrop-blur-sm hidden z-50 flex items-center justify-center p-4">
        <div class="bg-slate-800 rounded-2xl p-6 w-full max-w-md mx-auto border border-slate-600 shadow-2xl">
            <div class="flex items-center justify-between mb-6">
                <h3 class="text-xl font-bold gradient-text">Request ProSpector Access</h3>
                <button id="closeSignupModal" class="text-slate-400 hover:text-white transition-colors">
                    <i class="fas fa-times text-xl"></i>
                </button>
            </div>
            <form id="signupForm" class="space-y-4">
                <input type="text" id="signupFirstName" required class="w-full px-3 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white" placeholder="First Name">
                <input type="email" id="signupEmail" required class="w-full px-3 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white" placeholder="Business Email">
                <input type="text" id="signupCompany" required class="w-full px-3 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white" placeholder="Company Name">
                <button type="submit" class="w-full btn-success px-4 py-3 rounded-lg text-white font-semibold">
                    <i class="fas fa-paper-plane mr-2"></i>Submit Access Request
                </button>
            </form>
        </div>
    </div>

    <!-- AI Script Modals -->
    <div id="scriptGeneratorModal" class="fixed inset-0 bg-black/50 backdrop-blur-sm hidden z-50 flex items-center justify-center p-4">
        <div class="bg-slate-800 rounded-2xl p-6 w-full max-w-lg mx-auto border border-slate-600 shadow-2xl">
            <div class="flex items-center justify-between mb-6">
                <h3 class="text-xl font-bold gradient-text">AI Script Generator</h3>
                <button id="closeScriptGeneratorModal" class="text-slate-400 hover:text-white transition-colors">
                    <i class="fas fa-times text-xl"></i>
                </button>
            </div>
            <form id="scriptGeneratorForm" class="space-y-4">
                <div>
                    <label class="block text-sm font-medium text-slate-300 mb-2">Script Type</label>
                    <select id="scriptType" class="w-full px-3 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white focus:border-blue-500 focus:ring-1 focus:ring-blue-500">
                        <option value="cold-call">Cold Call - New Prospects</option>
                        <option value="follow-up">Follow-up Call</option>
                        <option value="appointment">Appointment Setting</option>
                        <option value="maintenance">Maintenance Reminder</option>
                        <option value="emergency">Emergency Service</option>
                        <option value="quote">Quote Follow-up</option>
                    </select>
                </div>
                
                <div>
                    <label class="block text-sm font-medium text-slate-300 mb-2">Target Industry</label>
                    <select id="targetIndustry" class="w-full px-3 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white focus:border-blue-500 focus:ring-1 focus:ring-blue-500">
                        <option value="hvac">HVAC Services</option>
                        <option value="hospitals">Hospitals and Critical Care Centers</option>
                        <option value="datacenters">Data Centers</option>
                        <option value="manufacturing">Manufacturing Facilities</option>
                        <option value="commercial">Commercial Buildings</option>
                        <option value="industrial">Industrial Facilities</option>
                        <option value="universities">Universities</option>
                        <option value="callcenters">Large Call Centers</option>
                        <option value="property">Property Management</option>
                        <option value="general">General B2B</option>
                    </select>
                </div>
                
                <div>
                    <label class="block text-sm font-medium text-slate-300 mb-2">Campaign Goal</label>
                    <select id="campaignGoal" class="w-full px-3 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white focus:border-blue-500 focus:ring-1 focus:ring-blue-500">
                        <option value="appointment">Schedule Appointment</option>
                        <option value="quote">Generate Quote Request</option>
                        <option value="service">Book Service Call</option>
                        <option value="contract">Secure Maintenance Contract</option>
                        <option value="upgrade">Promote System Upgrade</option>
                        <option value="renewal">Contract Renewal</option>
                        <option value="emergency">Emergency Response</option>
                    </select>
                </div>
                
                <div>
                    <label class="block text-sm font-medium text-slate-300 mb-2">Special Requirements (Optional)</label>
                    <textarea id="scriptRequirements" rows="3" class="w-full px-3 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white placeholder-slate-400 focus:border-blue-500 focus:ring-1 focus:ring-blue-500" placeholder="Any specific talking points, objections to handle, or unique selling propositions for this industry..."></textarea>
                </div>
                
                <button type="submit" class="w-full btn-success px-4 py-3 rounded-lg text-white font-semibold">
                    <i class="fas fa-magic mr-2"></i>Generate AI Script
                </button>
            </form>
        </div>
    </div>

    <div id="templateBrowserModal" class="fixed inset-0 bg-black/50 backdrop-blur-sm hidden z-50 flex items-center justify-center p-4">
        <div class="bg-slate-800 rounded-2xl p-6 w-full max-w-4xl mx-auto border border-slate-600 shadow-2xl max-h-[90vh] overflow-y-auto">
            <div class="flex items-center justify-between mb-6">
                <h3 class="text-xl font-bold gradient-text">Proven Script Templates</h3>
                <button id="closeTemplateBrowserModal" class="text-slate-400 hover:text-white transition-colors">
                    <i class="fas fa-times text-xl"></i>
                </button>
            </div>
            <div class="grid grid-cols-1 md:grid-cols-2 gap-4" id="templatesGrid">
                <!-- Templates populated by JavaScript -->
            </div>
        </div>
    </div>

    <div id="scriptOptimizerModal" class="fixed inset-0 bg-black/50 backdrop-blur-sm hidden z-50 flex items-center justify-center p-4">
        <div class="bg-slate-800 rounded-2xl p-6 w-full max-w-lg mx-auto border border-slate-600 shadow-2xl">
            <div class="flex items-center justify-between mb-6">
                <h3 class="text-xl font-bold gradient-text">AI Script Optimizer</h3>
                <button id="closeScriptOptimizerModal" class="text-slate-400 hover:text-white transition-colors">
                    <i class="fas fa-times text-xl"></i>
                </button>
            </div>
            <form id="scriptOptimizerForm" class="space-y-4">
                <select id="optimizeScriptSelect" class="w-full px-3 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white">
                    <option value="hvac-maintenance">HVAC Maintenance Cold Call Script</option>
                    <option value="new-customer">New Customer Acquisition</option>
                    <option value="follow-up">Follow-up Call Script</option>
                </select>
                <button type="submit" class="w-full bg-purple-600 hover:bg-purple-700 px-4 py-3 rounded-lg text-white font-semibold transition-colors">
                    <i class="fas fa-rocket mr-2"></i>Optimize Script with AI
                </button>
            </form>
        </div>
    </div>

    <!-- Script Viewer Modal -->
    <div id="scriptViewerModal" class="fixed inset-0 bg-black/50 backdrop-blur-sm hidden z-50 flex items-center justify-center p-4">
        <div class="bg-slate-800 rounded-2xl p-6 w-full max-w-4xl mx-auto border border-slate-600 shadow-2xl max-h-[90vh] overflow-y-auto">
            <div class="flex items-center justify-between mb-6">
                <h3 id="scriptViewerTitle" class="text-xl font-bold gradient-text">Generated Script</h3>
                <button id="closeScriptViewerModal" class="text-slate-400 hover:text-white transition-colors">
                    <i class="fas fa-times text-xl"></i>
                </button>
            </div>
            
            <div class="bg-slate-700/50 rounded-xl p-6 mb-6">
                <div class="grid grid-cols-2 md:grid-cols-4 gap-4 mb-4">
                    <div class="text-center">
                        <p class="text-2xl font-bold text-blue-400" id="scriptConversion">87%</p>
                        <p class="text-sm text-slate-400">Conversion Rate</p>
                    </div>
                    <div class="text-center">
                        <p class="text-2xl font-bold text-green-400" id="scriptDuration">3-5 min</p>
                        <p class="text-sm text-slate-400">Call Duration</p>
                    </div>
                    <div class="text-center">
                        <p class="text-2xl font-bold text-purple-400" id="scriptIndustry">HVAC</p>
                        <p class="text-sm text-slate-400">Target Industry</p>
                    </div>
                    <div class="text-center">
                        <p class="text-2xl font-bold text-yellow-400" id="scriptType">Cold Call</p>
                        <p class="text-sm text-slate-400">Script Type</p>
                    </div>
                </div>
            </div>
            
            <div class="bg-slate-900/50 rounded-xl p-6 mb-6">
                <h4 class="text-lg font-bold text-white mb-4">Generated Script Content</h4>
                <div id="scriptContent" class="text-slate-200 leading-relaxed space-y-4">
                    <!-- Script content will be populated by JavaScript -->
                </div>
            </div>
            
            <div class="flex space-x-3">
                <button id="copyScriptBtn" class="flex-1 bg-blue-600 hover:bg-blue-700 text-white px-4 py-3 rounded-lg font-semibold transition-colors">
                    <i class="fas fa-copy mr-2"></i>Copy Script
                </button>
                <button id="downloadScriptBtn" class="flex-1 bg-purple-600 hover:bg-purple-700 text-white px-4 py-3 rounded-lg font-semibold transition-colors">
                    <i class="fas fa-download mr-2"></i>Download PDF
                </button>
                <button id="useScriptBtn" class="flex-1 btn-success text-white px-4 py-3 rounded-lg font-semibold">
                    <i class="fas fa-phone mr-2"></i>Start Calling
                </button>
            </div>
        </div>
    </div>

    <!-- AI Cold Calling Script Import Modal -->
    <div id="aiScriptImportModal" class="fixed inset-0 bg-black/50 backdrop-blur-sm hidden z-50 flex items-center justify-center p-4">
        <div class="bg-slate-800 rounded-2xl p-6 w-full max-w-2xl mx-auto border border-slate-600 shadow-2xl max-h-[90vh] overflow-y-auto">
            <div class="flex items-center justify-between mb-6">
                <h3 class="text-xl font-bold gradient-text">Import AI Cold Calling Script</h3>
                <button id="closeAiScriptImportModal" class="text-slate-400 hover:text-white transition-colors">
                    <i class="fas fa-times text-xl"></i>
                </button>
            </div>
            
            <div class="mb-6">
                <div class="flex items-center space-x-3 mb-4">
                    <div class="w-12 h-12 bg-blue-500/20 rounded-xl flex items-center justify-center">
                        <i class="fas fa-microphone text-2xl text-blue-400"></i>
                    </div>
                    <div>
                        <h4 class="text-lg font-bold text-white">AI Voice Cold Calling Scripts</h4>
                        <p class="text-sm text-slate-400">Import and optimize scripts for AI voice campaigns</p>
                    </div>
                </div>
            </div>
            
            <form id="aiScriptImportForm" class="space-y-6">
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                    <div>
                        <label class="block text-sm font-medium text-slate-300 mb-2">Script Name *</label>
                        <input type="text" id="importScriptName" required class="w-full px-3 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white placeholder-slate-400 focus:border-blue-500" placeholder="AI Customer Acquisition Script">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-slate-300 mb-2">Campaign Type *</label>
                        <select id="importCampaignType" required class="w-full px-3 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white focus:border-blue-500">
                            <option value="cold-call">Cold Calling</option>
                            <option value="warm-call">Warm Calling</option>
                            <option value="follow-up">Follow-up Calls</option>
                            <option value="appointment">Appointment Setting</option>
                            <option value="lead-qualify">Lead Qualification</option>
                        </select>
                    </div>
                </div>
                
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                    <div>
                        <label class="block text-sm font-medium text-slate-300 mb-2">Target Industry</label>
                        <select id="importTargetIndustry" class="w-full px-3 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white focus:border-blue-500">
                            <option value="hvac">HVAC Services</option>
                            <option value="hospitals">Hospitals & Healthcare</option>
                            <option value="datacenters">Data Centers</option>
                            <option value="manufacturing">Manufacturing</option>
                            <option value="commercial">Commercial Buildings</option>
                            <option value="industrial">Industrial Facilities</option>
                            <option value="universities">Universities</option>
                            <option value="callcenters">Call Centers</option>
                            <option value="property">Property Management</option>
                            <option value="general">General B2B</option>
                        </select>
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-slate-300 mb-2">Expected Conversion Rate</label>
                        <input type="number" id="importConversionRate" min="1" max="100" class="w-full px-3 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white placeholder-slate-400 focus:border-blue-500" placeholder="85">
                    </div>
                </div>
                
                <div>
                    <label class="block text-sm font-medium text-slate-300 mb-2">Script Content *</label>
                    <textarea id="importScriptContent" required rows="12" class="w-full px-3 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white placeholder-slate-400 focus:border-blue-500 font-mono text-sm" placeholder="Paste your AI cold calling script here...

Example:
OPENING (0-30 seconds)
Hi [PROSPECT_NAME], this is [AGENT_NAME] from [COMPANY_NAME]...

DISCOVERY (30-90 seconds) 
The reason for my call is...

VALUE PROPOSITION (90-150 seconds)
Based on what you've shared...

CLOSE & NEXT STEPS (150-180 seconds)
I'd love to schedule..."></textarea>
                </div>
                
                <div>
                    <label class="block text-sm font-medium text-slate-300 mb-2">AI Voice Training Notes</label>
                    <textarea id="importTrainingNotes" rows="4" class="w-full px-3 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white placeholder-slate-400 focus:border-blue-500" placeholder="Special instructions for AI voice training:
- Tone: Professional but friendly
- Pace: Moderate, pause after questions  
- Objection handling: Listen actively, acknowledge concerns
- Key phrases to emphasize..."></textarea>
                </div>
                
                <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                    <div class="flex items-center">
                        <input type="checkbox" id="enableAiTraining" class="w-4 h-4 text-blue-600 bg-slate-700 border-slate-600 rounded focus:ring-blue-500">
                        <label for="enableAiTraining" class="ml-2 text-sm text-slate-300">Enable AI Training</label>
                    </div>
                    <div class="flex items-center">
                        <input type="checkbox" id="voiceOptimization" class="w-4 h-4 text-blue-600 bg-slate-700 border-slate-600 rounded focus:ring-blue-500">
                        <label for="voiceOptimization" class="ml-2 text-sm text-slate-300">Voice Optimization</label>
                    </div>
                    <div class="flex items-center">
                        <input type="checkbox" id="realTimeCoaching" class="w-4 h-4 text-blue-600 bg-slate-700 border-slate-600 rounded focus:ring-blue-500">
                        <label for="realTimeCoaching" class="ml-2 text-sm text-slate-300">Real-time Coaching</label>
                    </div>
                </div>
                
                <div class="flex space-x-3 pt-4">
                    <button type="button" id="cancelAiImport" class="flex-1 px-4 py-3 bg-slate-600 hover:bg-slate-700 text-white rounded-lg transition-colors">
                        Cancel
                    </button>
                    <button type="submit" class="flex-1 px-4 py-3 btn-success text-white rounded-lg font-semibold">
                        <i class="fas fa-upload mr-2"></i>Import AI Script
                    </button>
                </div>
            </form>
        </div>
    </div>

    <!-- AI Actors Guild Script Training Modal -->
    <div id="aiActorsGuildModal" class="fixed inset-0 bg-black/50 backdrop-blur-sm hidden z-50 flex items-center justify-center p-4">
        <div class="bg-slate-800 rounded-2xl p-6 w-full max-w-3xl mx-auto border border-slate-600 shadow-2xl max-h-[90vh] overflow-y-auto">
            <div class="flex items-center justify-between mb-6">
                <h3 class="text-xl font-bold gradient-text">AI Actors Guild Script Training</h3>
                <button id="closeAiActorsGuildModal" class="text-slate-400 hover:text-white transition-colors">
                    <i class="fas fa-times text-xl"></i>
                </button>
            </div>
            
            <div class="mb-6">
                <div class="flex items-center space-x-3 mb-4">
                    <div class="w-12 h-12 bg-purple-500/20 rounded-xl flex items-center justify-center">
                        <i class="fas fa-theater-masks text-2xl text-purple-400"></i>
                    </div>
                    <div>
                        <h4 class="text-lg font-bold text-white">Advanced AI Voice Training System</h4>
                        <p class="text-sm text-slate-400">Train AI actors with custom scripts and voice patterns</p>
                    </div>
                </div>
            </div>
            
            <div class="grid grid-cols-1 lg:grid-cols-2 gap-6 mb-6">
                <div class="space-y-4">
                    <h5 class="text-lg font-bold text-white mb-3">Training Options</h5>
                    
                    <div class="card-modern rounded-xl p-4">
                        <div class="flex items-center mb-3">
                            <div class="w-10 h-10 bg-blue-500/20 rounded-lg flex items-center justify-center mr-3">
                                <i class="fas fa-brain text-blue-400"></i>
                            </div>
                            <div>
                                <h6 class="font-bold text-white">Script Learning</h6>
                                <p class="text-xs text-slate-400">Train AI on script structure and flow</p>
                            </div>
                        </div>
                        <button class="training-option-btn w-full py-2 px-3 bg-blue-600 hover:bg-blue-700 text-white text-sm rounded-lg transition-colors" data-training="script-learning">
                            Start Script Training
                        </button>
                    </div>
                    
                    <div class="card-modern rounded-xl p-4">
                        <div class="flex items-center mb-3">
                            <div class="w-10 h-10 bg-green-500/20 rounded-lg flex items-center justify-center mr-3">
                                <i class="fas fa-microphone text-green-400"></i>
                            </div>
                            <div>
                                <h6 class="font-bold text-white">Voice Modulation</h6>
                                <p class="text-xs text-slate-400">Train tone, pace, and inflection</p>
                            </div>
                        </div>
                        <button class="training-option-btn w-full py-2 px-3 bg-green-600 hover:bg-green-700 text-white text-sm rounded-lg transition-colors" data-training="voice-modulation">
                            Configure Voice Training
                        </button>
                    </div>
                    
                    <div class="card-modern rounded-xl p-4">
                        <div class="flex items-center mb-3">
                            <div class="w-10 h-10 bg-yellow-500/20 rounded-lg flex items-center justify-center mr-3">
                                <i class="fas fa-comments text-yellow-400"></i>
                            </div>
                            <div>
                                <h6 class="font-bold text-white">Objection Handling</h6>
                                <p class="text-xs text-slate-400">Advanced response training</p>
                            </div>
                        </div>
                        <button class="training-option-btn w-full py-2 px-3 bg-yellow-600 hover:bg-yellow-700 text-white text-sm rounded-lg transition-colors" data-training="objection-handling">
                            Setup Objection Training
                        </button>
                    </div>
                </div>
                
                <div class="space-y-4">
                    <h5 class="text-lg font-bold text-white mb-3">Import Training Data</h5>
                    
                    <div class="border-2 border-dashed border-slate-600 rounded-lg p-6 text-center">
                        <i class="fas fa-cloud-upload-alt text-3xl text-slate-400 mb-3"></i>
                        <p class="text-slate-300 mb-2">Upload Training Scripts</p>
                        <p class="text-sm text-slate-400 mb-4">Drag & drop .txt, .csv, or .json files</p>
                        <input type="file" id="trainingScriptsFile" accept=".txt,.csv,.json" multiple class="hidden">
                        <button type="button" onclick="document.getElementById('trainingScriptsFile').click()" class="px-4 py-2 btn-primary text-white rounded-lg">
                            Choose Training Files
                        </button>
                    </div>
                    
                    <div class="bg-slate-700/50 rounded-lg p-4">
                        <h6 class="font-bold text-white mb-2">Voice Sample Library</h6>
                        <div class="space-y-2">
                            <div class="flex items-center justify-between">
                                <span class="text-slate-300 text-sm">Professional Male Voice</span>
                                <button class="px-2 py-1 bg-blue-600 hover:bg-blue-700 text-white text-xs rounded transition-colors">Select</button>
                            </div>
                            <div class="flex items-center justify-between">
                                <span class="text-slate-300 text-sm">Professional Female Voice</span>
                                <button class="px-2 py-1 bg-blue-600 hover:bg-blue-700 text-white text-xs rounded transition-colors">Select</button>
                            </div>
                            <div class="flex items-center justify-between">
                                <span class="text-slate-300 text-sm">Custom Voice Clone</span>
                                <button class="px-2 py-1 bg-purple-600 hover:bg-purple-700 text-white text-xs rounded transition-colors">Upload</button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="bg-slate-700/30 rounded-xl p-4 mb-6">
                <h5 class="text-lg font-bold text-white mb-3">Training Progress</h5>
                <div class="space-y-3">
                    <div class="flex items-center justify-between">
                        <span class="text-slate-300">Script Comprehension</span>
                        <div class="flex items-center space-x-2">
                            <div class="w-24 h-2 bg-slate-600 rounded-full overflow-hidden">
                                <div class="h-full bg-green-500 w-3/4"></div>
                            </div>
                            <span class="text-green-400 text-sm font-semibold">75%</span>
                        </div>
                    </div>
                    <div class="flex items-center justify-between">
                        <span class="text-slate-300">Voice Training</span>
                        <div class="flex items-center space-x-2">
                            <div class="w-24 h-2 bg-slate-600 rounded-full overflow-hidden">
                                <div class="h-full bg-blue-500 w-1/2"></div>
                            </div>
                            <span class="text-blue-400 text-sm font-semibold">50%</span>
                        </div>
                    </div>
                    <div class="flex items-center justify-between">
                        <span class="text-slate-300">Objection Responses</span>
                        <div class="flex items-center space-x-2">
                            <div class="w-24 h-2 bg-slate-600 rounded-full overflow-hidden">
                                <div class="h-full bg-yellow-500 w-5/6"></div>
                            </div>
                            <span class="text-yellow-400 text-sm font-semibold">83%</span>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="flex space-x-3">
                <button type="button" id="cancelAiActorsGuild" class="flex-1 px-4 py-3 bg-slate-600 hover:bg-slate-700 text-white rounded-lg transition-colors">
                    Close Training
                </button>
                <button type="button" id="startTrainingSession" class="flex-1 px-4 py-3 bg-purple-600 hover:bg-purple-700 text-white rounded-lg font-semibold transition-colors">
                    <i class="fas fa-play mr-2"></i>Start Training Session
                </button>
                <button type="button" id="deployAiActor" class="flex-1 px-4 py-3 btn-success text-white rounded-lg font-semibold transition-colors">
                    <i class="fas fa-rocket mr-2"></i>Deploy AI Actor
                </button>
            </div>
        </div>
    </div>

    <script>
        // ULTRA-MINIMAL TAB SYSTEM - COMPLETE REWRITE
        console.log('Starting ProSpector Pro...');
        
        function switchTab(tabName) {
            console.log('Switching to: ' + tabName);
            
            // Hide all content
            var contents = document.querySelectorAll('.tab-content');
            for (var i = 0; i < contents.length; i++) {
                contents[i].classList.add('hidden');
            }
            
            // Remove active from buttons
            var buttons = document.querySelectorAll('.nav-item');
            for (var i = 0; i < buttons.length; i++) {
                buttons[i].classList.remove('active', 'text-white');
                buttons[i].classList.add('text-white/80');
            }
            
            // Show target
            var target = document.getElementById(tabName + '-tab');
            if (target) {
                target.classList.remove('hidden');
            }
            
            // Activate button
            var activeBtn = document.querySelector('[data-tab="' + tabName + '"]');
            if (activeBtn) {
                activeBtn.classList.add('active', 'text-white');
                activeBtn.classList.remove('text-white/80');
            }
            
            // Initialize calendar buttons when switching to meetings tab
            if (tabName === 'meetings') {
                setTimeout(function() {
                    initializeCalendarButtons();
                }, 100);
            }
        }
        
        // Initialize when ready
        document.addEventListener('DOMContentLoaded', function() {
            console.log('DOM ready, setting up tabs...');
            
            // Remove loading screen
            setTimeout(function() {
                var loading = document.getElementById('loadingScreen');
                if (loading) loading.style.display = 'none';
            }, 500);
            
            // Setup tab buttons
            var tabBtns = document.querySelectorAll('[data-tab]');
            console.log('Found tabs: ' + tabBtns.length);
            
            for (var i = 0; i < tabBtns.length; i++) {
                var btn = tabBtns[i];
                var tabName = btn.getAttribute('data-tab');
                
                btn.onclick = function(e) {
                    e.preventDefault();
                    var name = this.getAttribute('data-tab');
                    console.log('Clicked: ' + name);
                    switchTab(name);
                };
            }
            
            console.log('Tabs initialized!');
            
            // Initialize integration buttons including ProSpector login/signup
            initializeIntegrationButtons();
            
            // Initialize calendar buttons
            initializeCalendarButtons();
        });
        
        // Check logos after short delay
        setTimeout(checkLogos, 1500);
        
        // INTEGRATION BUTTON FUNCTIONALITY
        function initializeIntegrationButtons() {
            console.log('🔌 Initializing integration buttons...');
            
            // Apollo AI Connection
            var apolloBtn = document.getElementById('connect-apollo-btn');
            if (apolloBtn) {
                apolloBtn.addEventListener('click', function() {
                    console.log('🚀 Apollo AI connection clicked');
                    showConnectionModal('Apollo AI', {
                        loginUrl: 'https://app.apollo.io/#/login?redirectTo=https%3A%2F%2Fapp.apollo.io%2F%23%2F',
                        signupUrl: 'https://app.apollo.io/sign_up',
                        description: 'Connect your Apollo AI account to import leads and access 275M+ contacts.',
                        color: 'purple'
                    });
                });
            }
            
            // Seamless AI Connection
            var seamlessBtn = document.getElementById('connect-seamless-btn');
            if (seamlessBtn) {
                seamlessBtn.addEventListener('click', function() {
                    console.log('🧠 Seamless AI connection clicked');
                    showConnectionModal('Seamless AI', {
                        loginUrl: 'https://login.seamless.ai/login',
                        signupUrl: 'https://login.seamless.ai/register',
                        description: 'Connect your Seamless AI account for real-time contact search and verification.',
                        color: 'green'
                    });
                });
            }
            
            // LinkedIn Sales Navigator Connection
            var linkedinBtn = document.getElementById('connect-linkedin-btn');
            if (linkedinBtn) {
                linkedinBtn.addEventListener('click', function() {
                    console.log('💼 LinkedIn Sales Navigator connection clicked');
                    showConnectionModal('LinkedIn Sales Navigator', {
                        loginUrl: 'https://www.linkedin.com/login?session_redirect=%2Fsales&_f=navigator&fromSignIn=true',
                        signupUrl: 'https://business.linkedin.com/sales-solutions/sales-navigator',
                        description: 'Connect LinkedIn Sales Navigator for premium lead search and insights.',
                        color: 'blue'
                    });
                });
            }
            
            // ZoomInfo Connection
            var zoominfoBtn = document.getElementById('connect-zoominfo-btn');
            if (zoominfoBtn) {
                zoominfoBtn.addEventListener('click', function() {
                    console.log('🔍 ZoomInfo connection clicked');
                    showConnectionModal('ZoomInfo', {
                        loginUrl: 'https://login.zoominfo.com/',
                        signupUrl: 'https://www.zoominfo.com/free-trial',
                        description: 'Connect ZoomInfo for comprehensive B2B contact and company data.',
                        color: 'orange'
                    });
                });
            }
            
            // Google Business Connection
            var googleBtn = document.getElementById('connect-google-btn');
            if (googleBtn) {
                googleBtn.addEventListener('click', function() {
                    console.log('🔍 Google Business connection clicked');
                    showConnectionModal('Google Business', {
                        loginUrl: 'https://accounts.google.com/signin',
                        signupUrl: 'https://business.google.com/',
                        description: 'Connect Google Business for local leads and Google My Business integration.',
                        color: 'red'
                    });
                });
            }
            
            // Manual Lead Entry
            var addLeadBtn = document.getElementById('add-lead-btn');
            if (addLeadBtn) {
                addLeadBtn.addEventListener('click', function() {
                    console.log('➕ Manual lead entry clicked');
                    openLeadModal();
                });
            }
            
            // CSV Import
            var csvBtn = document.getElementById('import-csv-btn');
            if (csvBtn) {
                csvBtn.addEventListener('click', function() {
                    console.log('📄 CSV import clicked');
                    openCsvModal();
                });
            }
            
            // ProSpector Authentication Buttons
            var loginBtn = document.getElementById('prospector-login-btn');
            if (loginBtn) {
                loginBtn.addEventListener('click', function() {
                    console.log('🔐 ProSpector login clicked');
                    openLoginModal();
                });
            }
            
            var signupBtn = document.getElementById('prospector-signup-btn');
            if (signupBtn) {
                signupBtn.addEventListener('click', function() {
                    console.log('📝 ProSpector signup clicked');
                    openSignupModal();
                });
            }
            
            // AI Script Generation Buttons
            var generateScriptBtn = document.getElementById('generate-script-btn');
            if (generateScriptBtn) {
                generateScriptBtn.addEventListener('click', function() {
                    console.log('🤖 Generate script clicked');
                    openScriptGeneratorModal();
                });
            }
            
            var browseTemplatesBtn = document.getElementById('browse-templates-btn');
            if (browseTemplatesBtn) {
                browseTemplatesBtn.addEventListener('click', function() {
                    console.log('📋 Browse templates clicked');
                    openTemplateBrowserModal();
                });
            }
            
            var optimizeScriptsBtn = document.getElementById('optimize-scripts-btn');
            if (optimizeScriptsBtn) {
                optimizeScriptsBtn.addEventListener('click', function() {
                    console.log('🚀 Optimize scripts clicked');
                    openScriptOptimizerModal();
                });
            }
            
            // Import AI Script Button
            var newScriptBtn = document.getElementById('new-script-btn');
            if (newScriptBtn) {
                newScriptBtn.addEventListener('click', function() {
                    console.log('📤 Import AI script button clicked');
                    openAiScriptImportModal();
                });
            }
            
            // AI Actors Guild Script Training Button
            var aiActorsGuildBtn = document.getElementById('ai-actors-guild-btn');
            if (aiActorsGuildBtn) {
                aiActorsGuildBtn.addEventListener('click', function() {
                    console.log('🎭 AI Actors Guild training button clicked');
                    openAiActorsGuildModal();
                });
            }
            
            // AI Voice Calling Buttons
            var startCallingBtn = document.getElementById('start-calling-btn');
            if (startCallingBtn) {
                startCallingBtn.addEventListener('click', function() {
                    console.log('📞 Start Calling Now button clicked');
                    startAiVoiceCampaign();
                });
            }
            
            var viewAnalyticsBtn = document.getElementById('view-analytics-btn');
            if (viewAnalyticsBtn) {
                viewAnalyticsBtn.addEventListener('click', function() {
                    console.log('📊 View Analytics button clicked');
                    openVoiceAnalyticsDashboard();
                });
            }
            
            var startVoiceTrainingBtn = document.getElementById('start-voice-training-btn');
            if (startVoiceTrainingBtn) {
                startVoiceTrainingBtn.addEventListener('click', function() {
                    console.log('🎓 Start Voice Training button clicked');
                    openAiVoiceTrainingSession();
                });
            }
            
            var manageVoicesBtn = document.getElementById('manage-voices-btn');
            if (manageVoicesBtn) {
                manageVoicesBtn.addEventListener('click', function() {
                    console.log('🎤 Manage Voices button clicked');
                    showVoiceManagementModal();
                });
            }
            
            // Campaign Management Buttons
            var pauseCampaignBtn = document.getElementById('pause-campaign-btn');
            if (pauseCampaignBtn) {
                pauseCampaignBtn.addEventListener('click', function() {
                    var isPaused = this.innerHTML.includes('Resume');
                    if (isPaused) {
                        console.log('▶️ Resume Campaign button clicked');
                        resumeActiveCampaign();
                    } else {
                        console.log('⏸️ Pause Campaign button clicked');
                        pauseActiveCampaign();
                    }
                });
            }
            
            var cancelCampaignBtn = document.getElementById('cancel-campaign-btn');
            if (cancelCampaignBtn) {
                cancelCampaignBtn.addEventListener('click', function() {
                    console.log('🛑 Cancel Campaign button clicked');
                    cancelActiveCampaign();
                });
            }
            
            // Calendar Integration - Direct buttons in main application
            console.log('📅 Calendar integration using direct buttons for maximum compatibility');
        }
        
        // Connection Modal for Integrations
        function showConnectionModal(serviceName, config) {
            var modal = document.createElement('div');
            modal.className = 'fixed inset-0 bg-black/50 backdrop-blur-sm z-50 flex items-center justify-center p-4';
            modal.innerHTML = `
                <div class="bg-slate-800 rounded-2xl p-6 w-full max-w-md mx-auto border border-slate-600 shadow-2xl">
                    <div class="flex items-center justify-between mb-6">
                        <h3 class="text-xl font-bold gradient-text">Connect ${serviceName}</h3>
                        <button class="close-connection-modal text-slate-400 hover:text-white transition-colors">
                            <i class="fas fa-times text-xl"></i>
                        </button>
                    </div>
                    
                    <div class="text-center mb-6">
                        <div class="w-16 h-16 bg-${config.color}-500/20 rounded-2xl flex items-center justify-center mx-auto mb-4">
                            <i class="fas fa-${config.color === 'blue' ? 'linkedin' : config.color === 'red' ? 'google' : config.color === 'purple' ? 'rocket' : config.color === 'green' ? 'brain' : 'search'} text-3xl text-${config.color}-400"></i>
                        </div>
                        <p class="text-slate-300 text-sm">${config.description}</p>
                    </div>
                    
                    <div class="space-y-3">
                        <button class="connect-service-btn w-full btn-primary px-4 py-3 rounded-lg text-white font-semibold" data-url="${config.loginUrl}">
                            <i class="fas fa-sign-in-alt mr-2"></i>Login to ${serviceName}
                        </button>
                        <button class="connect-service-btn w-full border border-${config.color}-500 text-${config.color}-400 hover:bg-${config.color}-500/10 px-4 py-3 rounded-lg font-semibold transition-colors" data-url="${config.signupUrl}">
                            <i class="fas fa-user-plus mr-2"></i>Sign Up for ${serviceName}
                        </button>
                    </div>
                    
                    <div class="mt-4 p-3 bg-slate-700/50 rounded-lg">
                        <p class="text-xs text-slate-400">
                            <i class="fas fa-info-circle mr-1"></i>
                            After connecting, you'll be able to import leads directly into ProSpector Pro.
                        </p>
                    </div>
                </div>
            `;
            
            document.body.appendChild(modal);
            
            // Close modal handlers
            modal.querySelector('.close-connection-modal').addEventListener('click', function() {
                document.body.removeChild(modal);
            });
            
            modal.addEventListener('click', function(e) {
                if (e.target === modal) {
                    document.body.removeChild(modal);
                }
            });
            
            // Service connection handlers
            var serviceButtons = modal.querySelectorAll('.connect-service-btn');
            for (var i = 0; i < serviceButtons.length; i++) {
                var btn = serviceButtons[i];
                btn.addEventListener('click', function() {
                    var url = this.getAttribute('data-url');
                    window.open(url, '_blank');
                    
                    // Show success message
                    showNotification('Opening ' + serviceName + '...', 'info');
                    document.body.removeChild(modal);
                });
            });
        }
        
        // Initialize Calendar Buttons (separate function for tab switching)
        function initializeCalendarButtons() {
            console.log('🗓️ Initializing calendar buttons...');
            
            // Calendar Integration Buttons - Direct redirect to calendar services
            var googleCalendarBtn = document.getElementById('connect-google-calendar-btn');
            if (googleCalendarBtn) {
                // Remove existing listeners to prevent duplicates
                googleCalendarBtn.replaceWith(googleCalendarBtn.cloneNode(true));
                googleCalendarBtn = document.getElementById('connect-google-calendar-btn');
                
                googleCalendarBtn.addEventListener('click', function() {
                    console.log('📅 Connect Google Calendar clicked - redirecting to Google OAuth');
                    showNotification('Redirecting to Google Calendar...', 'info');
                    
                    // Redirect directly to Google Calendar OAuth with realistic parameters
                    var googleCalendarUrl = 'https://accounts.google.com/o/oauth2/auth?' +
                        'client_id=1234567890-abcdefghijklmnop.apps.googleusercontent.com&' +
                        'redirect_uri=https://prospector.pro/oauth/google/callback&' +
                        'scope=https://www.googleapis.com/auth/calendar&' +
                        'response_type=code&' +
                        'access_type=offline&' +
                        'prompt=consent&' +
                        'state=google-calendar-integration';
                    
                    window.open(googleCalendarUrl, '_blank');
                });
            }
            
            var outlookBtn = document.getElementById('connect-outlook-btn');
            if (outlookBtn) {
                // Remove existing listeners to prevent duplicates  
                outlookBtn.replaceWith(outlookBtn.cloneNode(true));
                outlookBtn = document.getElementById('connect-outlook-btn');
                
                outlookBtn.addEventListener('click', function() {
                    console.log('📅 Connect Outlook clicked - redirecting to Microsoft OAuth');
                    showNotification('Redirecting to Microsoft Outlook...', 'info');
                    
                    // Redirect directly to Microsoft OAuth with realistic parameters
                    var outlookUrl = 'https://login.microsoftonline.com/common/oauth2/v2.0/authorize?' +
                        'client_id=12345678-1234-1234-1234-123456789012&' +
                        'response_type=code&' +
                        'redirect_uri=https://prospector.pro/oauth/microsoft/callback&' +
                        'scope=https://graph.microsoft.com/calendars.readwrite%20offline_access&' +
                        'response_mode=query&' +
                        'state=outlook-calendar-integration&' +
                        'prompt=consent';
                    
                    window.open(outlookUrl, '_blank');
                });
            }
            
            var scheduleAppointmentBtn = document.getElementById('schedule-appointment-btn');
            if (scheduleAppointmentBtn) {
                // Remove existing listeners to prevent duplicates
                scheduleAppointmentBtn.replaceWith(scheduleAppointmentBtn.cloneNode(true));
                scheduleAppointmentBtn = document.getElementById('schedule-appointment-btn');
                
                scheduleAppointmentBtn.addEventListener('click', function() {
                    console.log('📅 Schedule New Appointment clicked');
                    openAppointmentSchedulingModal();
                });
            }
            
            console.log('✅ Calendar buttons initialized with direct OAuth redirects!');
        }
        
        // Calendar Connection Modal for Calendar Integrations
        function showCalendarConnectionModal(serviceName, config) {
            var modal = document.createElement('div');
            modal.className = 'fixed inset-0 bg-black/50 backdrop-blur-sm z-50 flex items-center justify-center p-4';
            modal.innerHTML = `
                <div class="bg-slate-800 rounded-2xl p-6 w-full max-w-md mx-auto border border-slate-600 shadow-2xl">
                    <div class="flex items-center justify-between mb-6">
                        <h3 class="text-xl font-bold gradient-text">Connect ${serviceName}</h3>
                        <button class="close-calendar-modal text-slate-400 hover:text-white transition-colors">
                            <i class="fas fa-times text-xl"></i>
                        </button>
                    </div>
                    
                    <div class="text-center mb-6">
                        <div class="w-16 h-16 bg-${config.color}-500/20 rounded-2xl flex items-center justify-center mx-auto mb-4">
                            <i class="fab fa-${config.icon} text-3xl text-${config.color}-400"></i>
                        </div>
                        <p class="text-slate-300 text-sm">${config.description}</p>
                    </div>
                    
                    <div class="space-y-3">
                        <button class="connect-calendar-btn w-full btn-primary px-4 py-3 rounded-lg text-white font-semibold" data-url="${config.authUrl}">
                            <i class="fas fa-link mr-2"></i>Connect ${serviceName}
                        </button>
                        <button class="login-calendar-btn w-full border border-${config.color}-500 text-${config.color}-400 hover:bg-${config.color}-500/10 px-4 py-3 rounded-lg font-semibold transition-colors" data-url="${config.loginUrl}">
                            <i class="fas fa-sign-in-alt mr-2"></i>Sign In to ${serviceName}
                        </button>
                    </div>
                    
                    <div class="mt-4 p-3 bg-slate-700/50 rounded-lg">
                        <p class="text-xs text-slate-400">
                            <i class="fas fa-info-circle mr-1"></i>
                            After connecting, ProSpector will automatically sync appointments and schedule follow-ups.
                        </p>
                    </div>
                </div>
            `;
            
            document.body.appendChild(modal);
            
            // Close modal handlers
            modal.querySelector('.close-calendar-modal').addEventListener('click', function() {
                document.body.removeChild(modal);
            });
            
            modal.addEventListener('click', function(e) {
                if (e.target === modal) {
                    document.body.removeChild(modal);
                }
            });
            
            // Calendar connection handlers
            var connectBtn = modal.querySelector('.connect-calendar-btn');
            var loginBtn = modal.querySelector('.login-calendar-btn');
            
            if (connectBtn) {
                connectBtn.addEventListener('click', function() {
                    var url = this.getAttribute('data-url');
                    console.log('🔗 Connecting to calendar:', serviceName);
                    showNotification(`Connecting to ${serviceName}...`, 'info');
                    
                    // For demo purposes, simulate connection
                    setTimeout(function() {
                        showNotification(`${serviceName} connected successfully!`, 'success');
                        document.body.removeChild(modal);
                        updateCalendarConnectionStatus(serviceName, true);
                    }, 2000);
                });
            }
            
            if (loginBtn) {
                loginBtn.addEventListener('click', function() {
                    var url = this.getAttribute('data-url');
                    window.open(url, '_blank');
                    showNotification(`Opening ${serviceName} login...`, 'info');
                    document.body.removeChild(modal);
                });
            }
        }
        
        // Appointment Scheduling Modal - Make it globally available
        function openAppointmentSchedulingModal() {
            var modal = document.createElement('div');
            modal.className = 'fixed inset-0 bg-black/50 backdrop-blur-sm z-50 flex items-center justify-center p-4';
            modal.innerHTML = `
                <div class="bg-slate-800 rounded-2xl p-6 w-full max-w-lg mx-auto border border-slate-600 shadow-2xl">
                    <div class="flex items-center justify-between mb-6">
                        <h3 class="text-xl font-bold gradient-text">Schedule New Appointment</h3>
                        <button class="close-appointment-modal text-slate-400 hover:text-white transition-colors">
                            <i class="fas fa-times text-xl"></i>
                        </button>
                    </div>
                    
                    <form id="appointmentForm" class="space-y-4">
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                            <div>
                                <label class="block text-sm font-medium text-slate-300 mb-2">Customer Name *</label>
                                <input type="text" id="appointmentCustomerName" required class="w-full px-3 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white focus:border-blue-500">
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-slate-300 mb-2">Phone Number *</label>
                                <input type="tel" id="appointmentPhone" required class="w-full px-3 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white focus:border-blue-500">
                            </div>
                        </div>
                        
                        <div>
                            <label class="block text-sm font-medium text-slate-300 mb-2">Service Address *</label>
                            <input type="text" id="appointmentAddress" required class="w-full px-3 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white focus:border-blue-500" placeholder="123 Main St, City, State, ZIP">
                        </div>
                        
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                            <div>
                                <label class="block text-sm font-medium text-slate-300 mb-2">Date *</label>
                                <input type="date" id="appointmentDate" required class="w-full px-3 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white focus:border-blue-500">
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-slate-300 mb-2">Time *</label>
                                <select id="appointmentTime" required class="w-full px-3 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white focus:border-blue-500">
                                    <option value="">Select time...</option>
                                    <option value="08:00">8:00 AM</option>
                                    <option value="09:00">9:00 AM</option>
                                    <option value="10:00">10:00 AM</option>
                                    <option value="11:00">11:00 AM</option>
                                    <option value="12:00">12:00 PM</option>
                                    <option value="13:00">1:00 PM</option>
                                    <option value="14:00">2:00 PM</option>
                                    <option value="15:00">3:00 PM</option>
                                    <option value="16:00">4:00 PM</option>
                                    <option value="17:00">5:00 PM</option>
                                </select>
                            </div>
                        </div>
                        
                        <div>
                            <label class="block text-sm font-medium text-slate-300 mb-2">Service Type *</label>
                            <select id="appointmentServiceType" required class="w-full px-3 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white focus:border-blue-500">
                                <option value="">Select service...</option>
                                <option value="maintenance">Routine Maintenance</option>
                                <option value="repair">Repair Service</option>
                                <option value="installation">New Installation</option>
                                <option value="consultation">System Consultation</option>
                                <option value="emergency">Emergency Service</option>
                                <option value="quote">Quote/Estimate</option>
                            </select>
                        </div>
                        
                        <div>
                            <label class="block text-sm font-medium text-slate-300 mb-2">Notes</label>
                            <textarea id="appointmentNotes" rows="3" class="w-full px-3 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white focus:border-blue-500" placeholder="Additional details about the appointment..."></textarea>
                        </div>
                        
                        <div class="flex space-x-3 pt-4">
                            <button type="submit" class="flex-1 btn-success px-4 py-3 rounded-lg text-white font-semibold">
                                <i class="fas fa-calendar-check mr-2"></i>Schedule Appointment
                            </button>
                            <button type="button" class="cancel-appointment px-4 py-3 border border-slate-600 text-slate-300 rounded-lg hover:bg-slate-700 transition-colors">
                                Cancel
                            </button>
                        </div>
                    </form>
                </div>
            `;
            
            document.body.appendChild(modal);
            
            // Set minimum date to today
            var today = new Date().toISOString().split('T')[0];
            modal.querySelector('#appointmentDate').setAttribute('min', today);
            
            // Focus on first input
            modal.querySelector('#appointmentCustomerName').focus();
            
            // Close modal handlers
            modal.querySelector('.close-appointment-modal').addEventListener('click', function() {
                document.body.removeChild(modal);
            });
            
            modal.querySelector('.cancel-appointment').addEventListener('click', function() {
                document.body.removeChild(modal);
            });
            
            modal.addEventListener('click', function(e) {
                if (e.target === modal) {
                    document.body.removeChild(modal);
                }
            });
            
            // Form submission
            modal.querySelector('#appointmentForm').addEventListener('submit', function(e) {
                e.preventDefault();
                
                var appointmentData = {
                    customerName: modal.querySelector('#appointmentCustomerName').value,
                    phone: modal.querySelector('#appointmentPhone').value,
                    address: modal.querySelector('#appointmentAddress').value,
                    date: modal.querySelector('#appointmentDate').value,
                    time: modal.querySelector('#appointmentTime').value,
                    serviceType: modal.querySelector('#appointmentServiceType').value,
                    notes: modal.querySelector('#appointmentNotes').value,
                    createdAt: new Date().toISOString()
                };
                
                console.log('📅 New appointment scheduled:', appointmentData);
                showNotification('Appointment scheduled successfully!', 'success');
                
                // In a real application, you would send this data to your backend
                // For demo purposes, we'll just close the modal
                document.body.removeChild(modal);
                
                // Update appointment list (could be implemented to refresh the UI)
                updateAppointmentsList(appointmentData);
            });
        }
        
        // Make the function globally available
        window.openAppointmentSchedulingModal = openAppointmentSchedulingModal;
        
        // Direct appointment modal for main app (bypasses any conflicts)
        function createDirectAppointmentModal() {
            console.log('🎯 Creating direct appointment modal');
            
            // Remove any existing modals first
            var existingModals = document.querySelectorAll('.appointment-modal');
            for (var i = 0; i < existingModals.length; i++) {
                existingModals[i].remove();
            }
            
            var modal = document.createElement('div');
            modal.className = 'appointment-modal fixed inset-0 bg-black bg-opacity-80 z-50 flex items-center justify-center p-4';
            modal.innerHTML = `
                <div class="bg-slate-800 rounded-2xl p-6 w-full max-w-lg mx-auto border border-slate-600 shadow-2xl max-h-screen overflow-y-auto">
                    <div class="flex items-center justify-between mb-6">
                        <h3 class="text-xl font-bold text-blue-400">Schedule HVAC Appointment</h3>
                        <button onclick="this.closest('.appointment-modal').remove()" class="text-slate-400 hover:text-white text-2xl">×</button>
                    </div>
                    
                    <form onsubmit="submitAppointment(event)" class="space-y-4">
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                            <div>
                                <label class="block text-sm font-medium text-slate-300 mb-2">Customer Name *</label>
                                <input type="text" name="customerName" required class="w-full px-3 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white focus:border-blue-500">
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-slate-300 mb-2">Phone Number *</label>
                                <input type="tel" name="phone" required class="w-full px-3 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white focus:border-blue-500">
                            </div>
                        </div>
                        
                        <div>
                            <label class="block text-sm font-medium text-slate-300 mb-2">Service Address *</label>
                            <input type="text" name="address" required class="w-full px-3 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white focus:border-blue-500" placeholder="123 Main St, City, State, ZIP">
                        </div>
                        
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                            <div>
                                <label class="block text-sm font-medium text-slate-300 mb-2">Date *</label>
                                <input type="date" name="date" required class="w-full px-3 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white focus:border-blue-500" min="${new Date().toISOString().split('T')[0]}">
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-slate-300 mb-2">Time *</label>
                                <select name="time" required class="w-full px-3 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white focus:border-blue-500">
                                    <option value="">Select time...</option>
                                    <option value="08:00">8:00 AM</option>
                                    <option value="09:00">9:00 AM</option>
                                    <option value="10:00">10:00 AM</option>
                                    <option value="11:00">11:00 AM</option>
                                    <option value="12:00">12:00 PM</option>
                                    <option value="13:00">1:00 PM</option>
                                    <option value="14:00">2:00 PM</option>
                                    <option value="15:00">3:00 PM</option>
                                    <option value="16:00">4:00 PM</option>
                                    <option value="17:00">5:00 PM</option>
                                </select>
                            </div>
                        </div>
                        
                        <div>
                            <label class="block text-sm font-medium text-slate-300 mb-2">Service Type *</label>
                            <select name="serviceType" required class="w-full px-3 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white focus:border-blue-500">
                                <option value="">Select service...</option>
                                <option value="maintenance">Routine Maintenance</option>
                                <option value="repair">Repair Service</option>
                                <option value="installation">New Installation</option>
                                <option value="consultation">System Consultation</option>
                                <option value="emergency">Emergency Service</option>
                                <option value="quote">Quote/Estimate</option>
                            </select>
                        </div>
                        
                        <div>
                            <label class="block text-sm font-medium text-slate-300 mb-2">Notes</label>
                            <textarea name="notes" rows="3" class="w-full px-3 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white focus:border-blue-500" placeholder="Additional details about the appointment..."></textarea>
                        </div>
                        
                        <div class="flex space-x-3 pt-4">
                            <button type="submit" class="flex-1 bg-green-600 hover:bg-green-700 text-white py-3 px-4 rounded-lg font-semibold transition-colors">
                                <i class="fas fa-calendar-check mr-2"></i>Schedule Appointment
                            </button>
                            <button type="button" onclick="this.closest('.appointment-modal').remove()" class="px-4 py-3 border border-slate-600 text-slate-300 rounded-lg hover:bg-slate-700 transition-colors">
                                Cancel
                            </button>
                        </div>
                    </form>
                </div>
            `;
            
            document.body.appendChild(modal);
            
            // Focus on first input
            setTimeout(function() {
                var firstInput = modal.querySelector('input[name="customerName"]');
                if (firstInput) firstInput.focus();
            }, 100);
            
            // Click outside to close
            modal.addEventListener('click', function(e) {
                if (e.target === modal) {
                    modal.remove();
                }
            });
        }
        
        // Handle appointment form submission
        function submitAppointment(event) {
            event.preventDefault();
            var form = event.target;
            var formData = new FormData(form);
            
            var appointmentData = {
                customerName: formData.get('customerName'),
                phone: formData.get('phone'),
                address: formData.get('address'),
                date: formData.get('date'),
                time: formData.get('time'),
                serviceType: formData.get('serviceType'),
                notes: formData.get('notes'),
                createdAt: new Date().toISOString()
            };
            
            console.log('✅ Appointment scheduled:', appointmentData);
            
            // Show success message
            alert('✅ Appointment Scheduled Successfully!\\n\\nCustomer: ' + appointmentData.customerName + '\\nDate: ' + appointmentData.date + ' at ' + appointmentData.time + '\\nService: ' + appointmentData.serviceType + '\\n\\nThis appointment would be synced with your calendar in the full application.');
            
            // Close modal
            form.closest('.appointment-modal').remove();
        }
        
        // Make functions globally available
        window.createDirectAppointmentModal = createDirectAppointmentModal;
        window.submitAppointment = submitAppointment;
        
        // Update calendar connection status in UI
        function updateCalendarConnectionStatus(serviceName, connected) {
            console.log('📅 Calendar connection status updated:', serviceName, connected);
            // In a real application, you would update the UI to show connection status
            // This could include changing button colors, showing checkmarks, etc.
        }
        
        // Update appointments list in UI
        function updateAppointmentsList(appointmentData) {
            console.log('📋 Appointments list updated with:', appointmentData);
            // In a real application, you would update the appointments display
            // This could include adding the new appointment to the list, refreshing calendars, etc.
        }
        
        // Lead Entry Modal Functions
        function openLeadModal() {
            var modal = document.getElementById('leadModal');
            modal.classList.remove('hidden');
            document.getElementById('firstName').focus();
        }
        
        function closeLeadModal() {
            var modal = document.getElementById('leadModal');
            modal.classList.add('hidden');
            document.getElementById('leadForm').reset();
        }
        
        // CSV Import Modal Functions
        function openCsvModal() {
            var modal = document.getElementById('csvModal');
            modal.classList.remove('hidden');
        }
        
        function closeCsvModal() {
            var modal = document.getElementById('csvModal');
            modal.classList.add('hidden');
            document.getElementById('csvFile').value = '';
        }
        
        // ProSpector Authentication Modal Functions
        function openLoginModal() {
            var modal = document.getElementById('loginModal');
            modal.classList.remove('hidden');
            document.getElementById('loginEmail').focus();
        }
        
        function closeLoginModal() {
            var modal = document.getElementById('loginModal');
            modal.classList.add('hidden');
            document.getElementById('loginForm').reset();
        }
        
        function openSignupModal() {
            var modal = document.getElementById('signupModal');
            modal.classList.remove('hidden');
            document.getElementById('signupFirstName').focus();
        }
        
        function closeSignupModal() {
            var modal = document.getElementById('signupModal');
            modal.classList.add('hidden');
            document.getElementById('signupForm').reset();
        }
        
        // AI Script Modal Functions
        function openScriptGeneratorModal() {
            var modal = document.getElementById('scriptGeneratorModal');
            modal.classList.remove('hidden');
        }
        
        function closeScriptGeneratorModal() {
            var modal = document.getElementById('scriptGeneratorModal');
            modal.classList.add('hidden');
            document.getElementById('scriptGeneratorForm').reset();
        }
        
        function openTemplateBrowserModal() {
            var modal = document.getElementById('templateBrowserModal');
            modal.classList.remove('hidden');
            populateTemplateGrid();
        }
        
        function closeTemplateBrowserModal() {
            var modal = document.getElementById('templateBrowserModal');
            modal.classList.add('hidden');
        }
        
        function openScriptOptimizerModal() {
            var modal = document.getElementById('scriptOptimizerModal');
            modal.classList.remove('hidden');
        }
        
        function closeScriptOptimizerModal() {
            var modal = document.getElementById('scriptOptimizerModal');
            modal.classList.add('hidden');
            document.getElementById('scriptOptimizerForm').reset();
        }
        
        // AI Script Import Modal Functions
        function openAiScriptImportModal() {
            var modal = document.getElementById('aiScriptImportModal');
            modal.classList.remove('hidden');
            document.getElementById('importScriptName').focus();
        }
        
        function closeAiScriptImportModal() {
            var modal = document.getElementById('aiScriptImportModal');
            modal.classList.add('hidden');
            document.getElementById('aiScriptImportForm').reset();
        }
        
        // AI Actors Guild Modal Functions
        function openAiActorsGuildModal() {
            var modal = document.getElementById('aiActorsGuildModal');
            modal.classList.remove('hidden');
        }
        
        function closeAiActorsGuildModal() {
            var modal = document.getElementById('aiActorsGuildModal');
            modal.classList.add('hidden');
        }
        
        // AI Voice Calling Functions
        function startAiVoiceCampaign() {
            console.log('🚀 Starting AI Voice Campaign');
            
            // Show campaign launch modal
            showAiCampaignLauncher();
        }
        
        function openVoiceAnalyticsDashboard() {
            console.log('📊 Opening Voice Analytics Dashboard');
            
            // Show analytics dashboard modal
            showVoiceAnalyticsDashboard();
        }
        
        function openAiVoiceTrainingSession() {
            console.log('🎓 Opening AI Voice Training Session');
            
            // Show AI voice training modal
            showAiVoiceTrainingModal();
        }
        
        // Campaign Management Functions
        function pauseActiveCampaign() {
            console.log('⏸️ Pausing active campaign');
            
            showNotification('Pausing active campaign...', 'info');
            
            // Simulate campaign pause
            setTimeout(function() {
                showNotification('Campaign paused successfully. You can resume anytime.', 'success');
                updateCampaignStatus('paused');
                stopCampaignTimer();
            }, 1500);
        }
        
        function resumeActiveCampaign() {
            console.log('▶️ Resuming active campaign');
            
            showNotification('Resuming campaign...', 'info');
            
            // Simulate campaign resume
            setTimeout(function() {
                showNotification('Campaign resumed! AI voice calling is now active.', 'success');
                updateCampaignStatus('active');
            }, 1500);
        }
        
        function cancelActiveCampaign() {
            console.log('🛑 Canceling active campaign');
            
            // Show confirmation dialog
            showCancelCampaignConfirmation();
        }
        
        function showCancelCampaignConfirmation() {
            var modal = document.createElement('div');
            modal.className = 'fixed inset-0 bg-black/50 backdrop-blur-sm z-50 flex items-center justify-center p-4';
            modal.innerHTML = `
                <div class="bg-slate-800 rounded-2xl p-6 w-full max-w-md mx-auto border border-slate-600 shadow-2xl">
                    <div class="flex items-center justify-between mb-6">
                        <h3 class="text-xl font-bold text-red-400">Cancel Campaign</h3>
                        <button class="close-cancel-modal text-slate-400 hover:text-white transition-colors">
                            <i class="fas fa-times text-xl"></i>
                        </button>
                    </div>
                    
                    <div class="mb-6">
                        <div class="flex items-center space-x-3 mb-4">
                            <div class="w-12 h-12 bg-red-500/20 rounded-xl flex items-center justify-center">
                                <i class="fas fa-exclamation-triangle text-2xl text-red-400"></i>
                            </div>
                            <div>
                                <h4 class="text-lg font-bold text-white">Confirm Campaign Cancellation</h4>
                                <p class="text-sm text-slate-400">This action cannot be undone</p>
                            </div>
                        </div>
                        
                        <div class="bg-slate-700/30 rounded-xl p-4 mb-4">
                            <p class="text-slate-300 text-sm mb-2">Active Campaign:</p>
                            <p class="text-white font-semibold">HVAC Maintenance Campaign</p>
                            <div class="mt-2 text-sm text-slate-400">
                                <p>• 47 calls completed</p>
                                <p>• 12 appointments scheduled</p>
                                <p>• 2h 15m runtime</p>
                            </div>
                        </div>
                        
                        <div class="bg-red-900/20 border border-red-500/30 rounded-lg p-3">
                            <p class="text-red-300 text-sm">
                                <i class="fas fa-warning mr-2"></i>
                                Canceling will stop all active calls and cannot be resumed. All progress will be saved for analytics.
                            </p>
                        </div>
                    </div>
                    
                    <div class="flex space-x-3">
                        <button class="close-cancel-modal flex-1 px-4 py-3 bg-slate-600 hover:bg-slate-700 text-white rounded-lg transition-colors">
                            Keep Running
                        </button>
                        <button class="confirm-cancel-btn flex-1 px-4 py-3 bg-red-600 hover:bg-red-700 text-white rounded-lg font-semibold transition-colors">
                            <i class="fas fa-stop mr-2"></i>Cancel Campaign
                        </button>
                    </div>
                </div>
            `;
            
            document.body.appendChild(modal);
            
            // Close modal handlers
            var closeBtns = modal.querySelectorAll('.close-cancel-modal');
            for (var i = 0; i < closeBtns.length; i++) {
                closeBtns[i].addEventListener('click', function() {
                    document.body.removeChild(modal);
                });
            }
            
            modal.addEventListener('click', function(e) {
                if (e.target === modal) {
                    document.body.removeChild(modal);
                }
            });
            
            // Confirm cancel handler
            modal.querySelector('.confirm-cancel-btn').addEventListener('click', function() {
                showNotification('Canceling campaign...', 'info');
                
                setTimeout(function() {
                    showNotification('Campaign canceled successfully. Final results saved to analytics.', 'success');
                    updateCampaignStatus('canceled');
                    document.body.removeChild(modal);
                }, 2000);
            });
        }
        
        function updateCampaignStatus(status) {
            var statusDisplay = document.getElementById('campaign-status-display');
            var startBtn = document.getElementById('start-calling-btn');
            var activeControls = document.getElementById('active-campaign-controls');
            
            if (status === 'active') {
                // Show campaign status and hide start button
                statusDisplay.classList.remove('hidden');
                startBtn.classList.add('hidden');
                activeControls.classList.remove('hidden');
                activeControls.classList.add('grid');
                
                // Update status indicators
                var statusBadge = statusDisplay.querySelector('.bg-green-500\\/20');
                statusBadge.textContent = 'Active';
                statusBadge.className = 'px-2 py-1 bg-green-500/20 text-green-400 text-xs rounded-full';
                
                // Start campaign timer and stats update
                startCampaignTimer();
                
            } else if (status === 'paused') {
                // Update status to paused
                var statusBadge = statusDisplay.querySelector('.text-green-400');
                statusBadge.textContent = 'Paused';
                statusBadge.className = 'px-2 py-1 bg-yellow-500/20 text-yellow-400 text-xs rounded-full';
                
                // Update pause button to resume
                var pauseBtn = document.getElementById('pause-campaign-btn');
                pauseBtn.innerHTML = '<i class="fas fa-play mr-2"></i>Resume Campaign';
                pauseBtn.className = 'bg-green-600 hover:bg-green-700 px-4 py-3 rounded-lg text-white font-semibold transition-colors';
                
            } else if (status === 'canceled' || status === 'completed') {
                // Hide campaign status and show start button
                statusDisplay.classList.add('hidden');
                startBtn.classList.remove('hidden');
                activeControls.classList.add('hidden');
                activeControls.classList.remove('grid');
                
                // Reset pause button text
                var pauseBtn = document.getElementById('pause-campaign-btn');
                pauseBtn.innerHTML = '<i class="fas fa-pause mr-2"></i>Pause Campaign';
                pauseBtn.className = 'btn-warning px-4 py-3 rounded-lg text-white font-semibold transition-colors bg-yellow-600 hover:bg-yellow-700';
            }
        }
        
        var campaignTimer;
        var campaignStartTime;
        var callCount = 47;
        var appointmentCount = 12;
        
        function startCampaignTimer() {
            campaignStartTime = Date.now();
            callCount = 0;
            appointmentCount = 0;
            
            campaignTimer = setInterval(function() {
                var elapsed = Date.now() - campaignStartTime;
                var hours = Math.floor(elapsed / (1000 * 60 * 60));
                var minutes = Math.floor((elapsed % (1000 * 60 * 60)) / (1000 * 60));
                
                // Update campaign stats
                callCount += Math.floor(Math.random() * 3); // Simulate calls
                if (Math.random() > 0.8) appointmentCount++; // Simulate appointments
                
                var durationElement = document.getElementById('campaign-duration');
                var callsElement = document.getElementById('calls-made-count');
                var appointmentsElement = document.getElementById('appointments-count');
                var successRateElement = document.getElementById('success-rate');
                
                if (durationElement) durationElement.textContent = `${hours}h ${minutes}m`;
                if (callsElement) callsElement.textContent = callCount;
                if (appointmentsElement) appointmentsElement.textContent = appointmentCount;
                if (successRateElement) {
                    var rate = callCount > 0 ? ((appointmentCount / callCount) * 100).toFixed(1) : '0.0';
                    successRateElement.textContent = `${rate}%`;
                }
            }, 1000);
        }
        
        function stopCampaignTimer() {
            if (campaignTimer) {
                clearInterval(campaignTimer);
                campaignTimer = null;
            }
        }
        
        // AI Campaign Launcher Modal
        function showAiCampaignLauncher() {
            var modal = document.createElement('div');
            modal.className = 'fixed inset-0 bg-black/50 backdrop-blur-sm z-50 flex items-center justify-center p-4';
            modal.innerHTML = `
                <div class="bg-slate-800 rounded-2xl p-6 w-full max-w-2xl mx-auto border border-slate-600 shadow-2xl">
                    <div class="flex items-center justify-between mb-6">
                        <h3 class="text-xl font-bold gradient-text">Launch AI Voice Campaign</h3>
                        <button class="close-campaign-modal text-slate-400 hover:text-white transition-colors">
                            <i class="fas fa-times text-xl"></i>
                        </button>
                    </div>
                    
                    <div class="mb-6">
                        <div class="flex items-center space-x-3 mb-4">
                            <div class="w-12 h-12 bg-blue-500/20 rounded-xl flex items-center justify-center">
                                <i class="fas fa-microphone text-2xl text-blue-400"></i>
                            </div>
                            <div>
                                <h4 class="text-lg font-bold text-white">AI-Powered Voice Campaign</h4>
                                <p class="text-sm text-slate-400">Automated calling with intelligent scripts and real-time coaching</p>
                            </div>
                        </div>
                    </div>
                    
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-6">
                        <div>
                            <label class="block text-sm font-medium text-slate-300 mb-2">Select Script</label>
                            <select class="w-full px-3 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white focus:border-blue-500">
                                <option value="hvac-maintenance">HVAC Maintenance Cold Call (87% conversion)</option>
                                <option value="new-customer">New Customer Acquisition (72% conversion)</option>
                                <option value="follow-up">Follow-up Call - Service Appointment (91% conversion)</option>
                            </select>
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-slate-300 mb-2">Campaign Type</label>
                            <select class="w-full px-3 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white focus:border-blue-500">
                                <option value="immediate">Start Immediately</option>
                                <option value="scheduled">Schedule for Later</option>
                                <option value="recurring">Recurring Campaign</option>
                            </select>
                        </div>
                    </div>
                    
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-6">
                        <div>
                            <label class="block text-sm font-medium text-slate-300 mb-2">Target Leads</label>
                            <select class="w-full px-3 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white focus:border-blue-500">
                                <option value="all-leads">All Leads (247 contacts)</option>
                                <option value="hot-leads">Hot Leads Only (89 contacts)</option>
                                <option value="pending-leads">Pending Leads (124 contacts)</option>
                                <option value="custom-filter">Custom Filter</option>
                            </select>
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-slate-300 mb-2">Calling Hours</label>
                            <select class="w-full px-3 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white focus:border-blue-500">
                                <option value="business-hours">Business Hours (9 AM - 5 PM)</option>
                                <option value="extended-hours">Extended Hours (8 AM - 8 PM)</option>
                                <option value="custom-hours">Custom Hours</option>
                            </select>
                        </div>
                    </div>
                    
                    <!-- AI Voice Configuration -->
                    <div class="bg-slate-700/30 rounded-xl p-4 mb-6 border-l-4 border-blue-500">
                        <div class="flex items-center justify-between mb-3">
                            <h5 class="text-lg font-bold text-white">
                                <i class="fas fa-microphone mr-2 text-blue-400"></i>Natural AI Voice Configuration
                            </h5>
                            <span class="px-3 py-1 bg-blue-500/20 text-blue-400 text-xs rounded-full font-semibold">
                                🚀 HUMAN-LIKE QUALITY
                            </span>
                        </div>
                        <div class="bg-gradient-to-r from-blue-500/10 to-purple-500/10 rounded-lg p-4 mb-4 border border-blue-500/20">
                            <div class="flex items-center mb-2">
                                <i class="fas fa-magic text-blue-400 mr-2"></i>
                                <strong class="text-blue-300">Professional AI Voice Generation</strong>
                                <span class="ml-2 px-2 py-1 bg-green-500/20 text-green-400 text-xs rounded-full">HUMAN-LIKE</span>
                            </div>
                            <p class="text-sm text-blue-300 mb-2">
                                Advanced AI voice technology that creates natural, conversational voices - NOT robotic speech synthesis. Each voice has unique personality, emotion, and speaking patterns for authentic prospect engagement.
                            </p>
                            <div class="grid grid-cols-2 gap-2 text-xs text-slate-400">
                                <div class="flex items-center">
                                    <i class="fas fa-check-circle text-green-400 mr-1"></i>
                                    Natural conversation flow
                                </div>
                                <div class="flex items-center">
                                    <i class="fas fa-check-circle text-green-400 mr-1"></i>
                                    Human-like emotions
                                </div>
                                <div class="flex items-center">
                                    <i class="fas fa-check-circle text-green-400 mr-1"></i>
                                    Gender-accurate voices
                                </div>
                                <div class="flex items-center">
                                    <i class="fas fa-check-circle text-green-400 mr-1"></i>
                                    Professional quality
                                </div>
                            </div>
                        </div>
                        
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-4">
                            <div>
                                <label class="block text-sm font-medium text-slate-300 mb-2">AI Voice Type</label>
                                <select id="ai-voice-type" class="w-full px-3 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white focus:border-blue-500">
                                    <option value="professional-male">🎙️ David - Executive Voice (Human-like, Authoritative)</option>
                                    <option value="professional-female" selected>🎙️ Sarah - Business Professional (Natural, Confident Female)</option>
                                    <option value="friendly-male">😊 Marcus - Southern Charm (Conversational, Warm Male)</option>
                                    <option value="friendly-female">😊 Emma - Enthusiastic Expert (Natural Female, Engaging)</option>
                                    <option value="authoritative-male">💼 James - Industry Authority (Deep Male, Commanding)</option>
                                    <option value="warm-female">💝 Lisa - Trusted Advisor (Caring Female, Authentic)</option>
                                </select>
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-slate-300 mb-2">Speaking Pace</label>
                                <select id="speaking-pace" class="w-full px-3 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white focus:border-blue-500">
                                    <option value="slow">Slow & Clear</option>
                                    <option value="normal" selected>Normal</option>
                                    <option value="moderate">Moderate Fast</option>
                                    <option value="fast">Fast</option>
                                </select>
                            </div>
                        </div>
                        
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-4">
                            <div>
                                <label class="block text-sm font-medium text-slate-300 mb-2">Voice Tone</label>
                                <select id="voice-tone" class="w-full px-3 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white focus:border-blue-500">
                                    <option value="professional" selected>Professional</option>
                                    <option value="friendly">Friendly</option>
                                    <option value="confident">Confident</option>
                                    <option value="conversational">Conversational</option>
                                    <option value="enthusiastic">Enthusiastic</option>
                                </select>
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-slate-300 mb-2">Accent</label>
                                <select id="voice-accent" class="w-full px-3 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white focus:border-blue-500">
                                    <option value="us-neutral" selected>US Neutral</option>
                                    <option value="us-southern">US Southern</option>
                                    <option value="us-northeast">US Northeast</option>
                                    <option value="uk-british">UK British</option>
                                    <option value="canadian">Canadian</option>
                                    <option value="australian">Australian</option>
                                </select>
                            </div>
                        </div>
                        
                        <div class="flex items-center justify-between mb-4">
                            <label class="block text-sm font-medium text-slate-300">Voice Preview</label>
                            <div class="flex space-x-2">
                                <button id="preview-voice-btn" class="px-3 py-2 bg-blue-600 hover:bg-blue-700 text-white text-sm rounded-lg transition-colors">
                                    <i class="fas fa-play mr-1"></i>Preview Voice
                                </button>
                                <button id="stop-voice-btn" class="hidden px-3 py-2 bg-red-600 hover:bg-red-700 text-white text-sm rounded-lg transition-colors">
                                    <i class="fas fa-stop mr-1"></i>Stop
                                </button>
                            </div>
                        </div>
                        
                        <div class="bg-slate-800/50 rounded-lg p-3 mb-4 border-l-4 border-blue-500">
                            <div class="flex items-center mb-2">
                                <i class="fas fa-microphone text-blue-400 mr-2"></i>
                                <span class="text-blue-400 font-semibold text-xs">NATURAL AI VOICE SAMPLE</span>
                            </div>
                            <p class="text-sm text-slate-300 italic">
                                "Hi there! This is Sarah from ProSpector Pro. I'm calling to discuss how we can help optimize your HVAC maintenance schedule and reduce your energy costs. We've been helping facilities like yours reduce energy expenses by up to 30%..."
                            </p>
                            <p class="text-xs text-slate-400 mt-2">
                                ✨ Human-like • 🎯 Professional • 💬 Conversational
                            </p>
                        </div>
                    </div>
                    
                    <div class="bg-slate-700/30 rounded-xl p-4 mb-6">
                        <h5 class="text-lg font-bold text-white mb-3">AI Features</h5>
                        <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                            <label class="flex items-center">
                                <input type="checkbox" checked class="w-4 h-4 text-blue-600 bg-slate-700 border-slate-600 rounded focus:ring-blue-500">
                                <span class="ml-2 text-sm text-slate-300">Real-time Coaching</span>
                            </label>
                            <label class="flex items-center">
                                <input type="checkbox" checked class="w-4 h-4 text-blue-600 bg-slate-700 border-slate-600 rounded focus:ring-blue-500">
                                <span class="ml-2 text-sm text-slate-300">Voice Optimization</span>
                            </label>
                            <label class="flex items-center">
                                <input type="checkbox" checked class="w-4 h-4 text-blue-600 bg-slate-700 border-slate-600 rounded focus:ring-blue-500">
                                <span class="ml-2 text-sm text-slate-300">Smart Objection Handling</span>
                            </label>
                        </div>
                    </div>
                    
                    <div class="flex space-x-3">
                        <button class="close-campaign-modal flex-1 px-4 py-3 bg-slate-600 hover:bg-slate-700 text-white rounded-lg transition-colors">
                            Cancel
                        </button>
                        <button class="launch-campaign-btn flex-1 px-4 py-3 btn-success text-white rounded-lg font-semibold transition-colors">
                            <i class="fas fa-rocket mr-2"></i>Launch Campaign
                        </button>
                    </div>
                </div>
            `;
            
            document.body.appendChild(modal);
            
            // Close modal handlers
            var closeBtns = modal.querySelectorAll('.close-campaign-modal');
            for (var i = 0; i < closeBtns.length; i++) {
                var btn = closeBtns[i];
                btn.addEventListener('click', function() {
                    document.body.removeChild(modal);
                });
            }
            
            modal.addEventListener('click', function(e) {
                if (e.target === modal) {
                    document.body.removeChild(modal);
                }
            });
            
            // Voice preview handler
            modal.querySelector('#preview-voice-btn').addEventListener('click', function() {
                var voiceType = modal.querySelector('#ai-voice-type').value;
                var pace = modal.querySelector('#speaking-pace').value;
                var tone = modal.querySelector('#voice-tone').value;
                var accent = modal.querySelector('#voice-accent').value;
                
                // Update button states during preview
                var playBtn = modal.querySelector('#preview-voice-btn');
                var stopBtn = modal.querySelector('#stop-voice-btn');
                var originalText = playBtn.innerHTML;
                
                playBtn.innerHTML = '<i class="fas fa-volume-up fa-pulse mr-1"></i>Speaking...';
                playBtn.disabled = true;
                stopBtn.classList.remove('hidden');
                
                // Play real AI voice preview
                playVoicePreview(voiceType, pace, tone, accent, function() {
                    playBtn.innerHTML = originalText;
                    playBtn.disabled = false;
                    stopBtn.classList.add('hidden');
                });
            });
            
            // Voice stop handler
            modal.querySelector('#stop-voice-btn').addEventListener('click', function() {
                stopCurrentVoice();
                var playBtn = modal.querySelector('#preview-voice-btn');
                var stopBtn = modal.querySelector('#stop-voice-btn');
                
                playBtn.innerHTML = '<i class="fas fa-play mr-1"></i>Preview Voice';
                playBtn.disabled = false;
                stopBtn.classList.add('hidden');
                
                showNotification('Natural AI voice stopped', 'info');
            });
            
            // Voice configuration change handlers
            ['#ai-voice-type', '#speaking-pace', '#voice-tone', '#voice-accent'].forEach(function(selector) {
                modal.querySelector(selector).addEventListener('change', function() {
                    var voiceType = modal.querySelector('#ai-voice-type').value;
                    var pace = modal.querySelector('#speaking-pace').value;
                    var tone = modal.querySelector('#voice-tone').value;
                    var accent = modal.querySelector('#voice-accent').value;
                    
                    console.log('🎤 Voice config updated:', { voiceType, pace, tone, accent });
                });
            });
            
            // Launch campaign handler
            modal.querySelector('.launch-campaign-btn').addEventListener('click', function() {
                // Collect voice configuration
                var voiceConfig = {
                    voiceType: modal.querySelector('#ai-voice-type').value,
                    pace: modal.querySelector('#speaking-pace').value,
                    tone: modal.querySelector('#voice-tone').value,
                    accent: modal.querySelector('#voice-accent').value
                };
                
                console.log('🚀 Launching campaign with voice config:', voiceConfig);
                showNotification('AI Voice Campaign launching with selected voice configuration...', 'info');
                
                setTimeout(function() {
                    var voiceName = voiceConfig.voiceType.replace('-', ' ');
                    showNotification(`Campaign active! AI ${voiceName} is now making calls with real-time coaching enabled.`, 'success');
                    updateCampaignStatus('active');
                    document.body.removeChild(modal);
                }, 2000);
            });
        }
        
        // Voice Analytics Dashboard
        function showVoiceAnalyticsDashboard() {
            var modal = document.createElement('div');
            modal.className = 'fixed inset-0 bg-black/50 backdrop-blur-sm z-50 flex items-center justify-center p-4';
            modal.innerHTML = `
                <div class="bg-slate-800 rounded-2xl p-6 w-full max-w-4xl mx-auto border border-slate-600 shadow-2xl max-h-[90vh] overflow-y-auto">
                    <div class="flex items-center justify-between mb-6">
                        <h3 class="text-xl font-bold gradient-text">Voice Campaign Analytics</h3>
                        <button class="close-analytics-modal text-slate-400 hover:text-white transition-colors">
                            <i class="fas fa-times text-xl"></i>
                        </button>
                    </div>
                    
                    <div class="grid grid-cols-2 md:grid-cols-4 gap-4 mb-6">
                        <div class="bg-slate-700/30 rounded-xl p-4 text-center">
                            <p class="text-3xl font-bold text-blue-400">156</p>
                            <p class="text-sm text-slate-400">Calls Today</p>
                        </div>
                        <div class="bg-slate-700/30 rounded-xl p-4 text-center">
                            <p class="text-3xl font-bold text-green-400">78%</p>
                            <p class="text-sm text-slate-400">Connection Rate</p>
                        </div>
                        <div class="bg-slate-700/30 rounded-xl p-4 text-center">
                            <p class="text-3xl font-bold text-purple-400">24</p>
                            <p class="text-sm text-slate-400">Appointments Set</p>
                        </div>
                        <div class="bg-slate-700/30 rounded-xl p-4 text-center">
                            <p class="text-3xl font-bold text-yellow-400">15.3%</p>
                            <p class="text-sm text-slate-400">Conversion Rate</p>
                        </div>
                    </div>
                    
                    <div class="grid grid-cols-1 lg:grid-cols-2 gap-6 mb-6">
                        <div class="bg-slate-700/30 rounded-xl p-4">
                            <h4 class="text-lg font-bold text-white mb-3">Performance by Script</h4>
                            <div class="space-y-3">
                                <div class="flex items-center justify-between">
                                    <span class="text-slate-300">Follow-up Call - Service Appointment</span>
                                    <span class="text-green-400 font-semibold">91%</span>
                                </div>
                                <div class="flex items-center justify-between">
                                    <span class="text-slate-300">HVAC Maintenance Cold Call</span>
                                    <span class="text-blue-400 font-semibold">87%</span>
                                </div>
                                <div class="flex items-center justify-between">
                                    <span class="text-slate-300">New Customer Acquisition</span>
                                    <span class="text-purple-400 font-semibold">72%</span>
                                </div>
                            </div>
                        </div>
                        
                        <div class="bg-slate-700/30 rounded-xl p-4">
                            <h4 class="text-lg font-bold text-white mb-3">AI Coaching Impact</h4>
                            <div class="space-y-3">
                                <div class="flex items-center justify-between">
                                    <span class="text-slate-300">Real-time Suggestions Applied</span>
                                    <span class="text-green-400 font-semibold">142</span>
                                </div>
                                <div class="flex items-center justify-between">
                                    <span class="text-slate-300">Objections Successfully Handled</span>
                                    <span class="text-blue-400 font-semibold">89%</span>
                                </div>
                                <div class="flex items-center justify-between">
                                    <span class="text-slate-300">Voice Quality Improvements</span>
                                    <span class="text-purple-400 font-semibold">+23%</span>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="bg-slate-700/30 rounded-xl p-4 mb-6">
                        <h4 class="text-lg font-bold text-white mb-3">Recent Campaign Activity</h4>
                        <div class="space-y-2">
                            <div class="flex items-center justify-between p-2 bg-slate-800/30 rounded-lg">
                                <span class="text-slate-300">HVAC Maintenance Campaign</span>
                                <span class="text-green-400 text-sm">Active • 47 calls completed</span>
                            </div>
                            <div class="flex items-center justify-between p-2 bg-slate-800/30 rounded-lg">
                                <span class="text-slate-300">New Customer Outreach</span>
                                <span class="text-blue-400 text-sm">Paused • 23 calls completed</span>
                            </div>
                        </div>
                    </div>
                    
                    <div class="flex space-x-3">
                        <button class="close-analytics-modal flex-1 px-4 py-3 bg-slate-600 hover:bg-slate-700 text-white rounded-lg transition-colors">
                            Close
                        </button>
                        <button id="export-report-btn" class="flex-1 px-4 py-3 bg-purple-600 hover:bg-purple-700 text-white rounded-lg font-semibold transition-colors">
                            <i class="fas fa-download mr-2"></i>Export Report
                        </button>
                    </div>
                </div>
            `;
            
            document.body.appendChild(modal);
            
            // Close modal handlers
            modal.querySelectorAll('.close-analytics-modal').forEach(function(btn) {
                btn.addEventListener('click', function() {
                    document.body.removeChild(modal);
                });
            });
            
            modal.addEventListener('click', function(e) {
                if (e.target === modal) {
                    document.body.removeChild(modal);
                }
            });
            
            // Export Report handler
            modal.querySelector('#export-report-btn').addEventListener('click', function() {
                showExportOptionsModal();
            });
        }
        
        // AI Voice Training Session
        function showAiVoiceTrainingModal() {
            var modal = document.createElement('div');
            modal.className = 'fixed inset-0 bg-black/50 backdrop-blur-sm z-50 flex items-center justify-center p-4';
            modal.innerHTML = `
                <div class="bg-slate-800 rounded-2xl p-6 w-full max-w-3xl mx-auto border border-slate-600 shadow-2xl max-h-[90vh] overflow-y-auto">
                    <div class="flex items-center justify-between mb-6">
                        <h3 class="text-xl font-bold gradient-text">AI Voice Training Session</h3>
                        <button class="close-training-modal text-slate-400 hover:text-white transition-colors">
                            <i class="fas fa-times text-xl"></i>
                        </button>
                    </div>
                    
                    <div class="mb-6">
                        <div class="flex items-center space-x-3 mb-4">
                            <div class="w-12 h-12 bg-green-500/20 rounded-xl flex items-center justify-center">
                                <i class="fas fa-graduation-cap text-2xl text-green-400"></i>
                            </div>
                            <div>
                                <h4 class="text-lg font-bold text-white">Personalized Voice Coaching</h4>
                                <p class="text-sm text-slate-400">Real-time AI coaching to improve your calling performance</p>
                            </div>
                        </div>
                    </div>
                    
                    <div class="grid grid-cols-1 lg:grid-cols-2 gap-6 mb-6">
                        <div class="space-y-4">
                            <h5 class="text-lg font-bold text-white">Training Modules</h5>
                            
                            <div class="bg-slate-700/30 rounded-xl p-4">
                                <div class="flex items-center justify-between mb-2">
                                    <h6 class="font-bold text-white">Tone & Pacing</h6>
                                    <span class="px-2 py-1 bg-green-500/20 text-green-400 text-xs rounded-full">Completed</span>
                                </div>
                                <p class="text-sm text-slate-400 mb-3">Master professional tone and optimal speaking pace for cold calls</p>
                                <button class="w-full py-2 px-3 bg-green-600 hover:bg-green-700 text-white text-sm rounded-lg transition-colors">
                                    Review Training
                                </button>
                            </div>
                            
                            <div class="bg-slate-700/30 rounded-xl p-4">
                                <div class="flex items-center justify-between mb-2">
                                    <h6 class="font-bold text-white">Objection Handling</h6>
                                    <span class="px-2 py-1 bg-blue-500/20 text-blue-400 text-xs rounded-full">In Progress</span>
                                </div>
                                <p class="text-sm text-slate-400 mb-3">Advanced techniques for handling common objections effectively</p>
                                <button class="w-full py-2 px-3 bg-blue-600 hover:bg-blue-700 text-white text-sm rounded-lg transition-colors">
                                    Continue Training
                                </button>
                            </div>
                            
                            <div class="bg-slate-700/30 rounded-xl p-4">
                                <div class="flex items-center justify-between mb-2">
                                    <h6 class="font-bold text-white">Closing Techniques</h6>
                                    <span class="px-2 py-1 bg-slate-500/20 text-slate-400 text-xs rounded-full">Not Started</span>
                                </div>
                                <p class="text-sm text-slate-400 mb-3">Master the art of closing calls and scheduling appointments</p>
                                <button class="w-full py-2 px-3 bg-slate-600 hover:bg-slate-700 text-white text-sm rounded-lg transition-colors">
                                    Start Training
                                </button>
                            </div>
                        </div>
                        
                        <div class="space-y-4">
                            <h5 class="text-lg font-bold text-white">Performance Metrics</h5>
                            
                            <div class="bg-slate-700/30 rounded-xl p-4">
                                <h6 class="font-bold text-white mb-3">Your Progress</h6>
                                <div class="space-y-3">
                                    <div class="flex items-center justify-between">
                                        <span class="text-slate-300">Overall Score</span>
                                        <span class="text-green-400 font-semibold">8.2/10</span>
                                    </div>
                                    <div class="flex items-center justify-between">
                                        <span class="text-slate-300">Voice Clarity</span>
                                        <span class="text-blue-400 font-semibold">9.1/10</span>
                                    </div>
                                    <div class="flex items-center justify-between">
                                        <span class="text-slate-300">Objection Response</span>
                                        <span class="text-yellow-400 font-semibold">7.8/10</span>
                                    </div>
                                    <div class="flex items-center justify-between">
                                        <span class="text-slate-300">Closing Rate</span>
                                        <span class="text-purple-400 font-semibold">7.5/10</span>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="bg-slate-700/30 rounded-xl p-4">
                                <h6 class="font-bold text-white mb-3">AI Recommendations</h6>
                                <div class="space-y-2">
                                    <div class="p-2 bg-slate-800/30 rounded-lg">
                                        <p class="text-sm text-slate-300">Focus on slowing down during objections</p>
                                    </div>
                                    <div class="p-2 bg-slate-800/30 rounded-lg">
                                        <p class="text-sm text-slate-300">Practice assumptive closing techniques</p>
                                    </div>
                                    <div class="p-2 bg-slate-800/30 rounded-lg">
                                        <p class="text-sm text-slate-300">Increase pause time after questions</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="flex space-x-3">
                        <button class="close-training-modal flex-1 px-4 py-3 bg-slate-600 hover:bg-slate-700 text-white rounded-lg transition-colors">
                            Close
                        </button>
                        <button class="flex-1 px-4 py-3 bg-green-600 hover:bg-green-700 text-white rounded-lg font-semibold transition-colors">
                            <i class="fas fa-play mr-2"></i>Start Practice Call
                        </button>
                    </div>
                </div>
            `;
            
            document.body.appendChild(modal);
            
            // Close modal handlers
            modal.querySelectorAll('.close-training-modal').forEach(function(btn) {
                btn.addEventListener('click', function() {
                    document.body.removeChild(modal);
                });
            });
            
            modal.addEventListener('click', function(e) {
                if (e.target === modal) {
                    document.body.removeChild(modal);
                }
            });
        }
        
        // Voice Management Modal
        function showVoiceManagementModal() {
            var modal = document.createElement('div');
            modal.className = 'fixed inset-0 bg-black/50 backdrop-blur-sm z-50 flex items-center justify-center p-4';
            modal.innerHTML = `
                <div class="bg-slate-800 rounded-2xl p-6 w-full max-w-4xl mx-auto border border-slate-600 shadow-2xl max-h-[90vh] overflow-y-auto">
                    <div class="flex items-center justify-between mb-4">
                        <h3 class="text-xl font-bold gradient-text">AI Voice Management</h3>
                        <button class="close-voice-modal text-slate-400 hover:text-white transition-colors">
                            <i class="fas fa-times text-xl"></i>
                        </button>
                    </div>
                    
                    <div class="bg-gradient-to-r from-green-500/10 to-blue-500/10 rounded-xl p-4 mb-6 border border-green-500/20">
                        <div class="flex items-center justify-between">
                            <div class="flex items-center">
                                <i class="fas fa-award text-yellow-400 mr-3 text-xl"></i>
                                <div>
                                    <h4 class="font-bold text-white">Professional AI Voice Technology</h4>
                                    <p class="text-sm text-green-300">Human-like, conversational voices - NOT robotic speech</p>
                                </div>
                            </div>
                            <div class="text-right">
                                <div class="px-3 py-1 bg-green-500/20 text-green-400 text-xs rounded-full font-semibold mb-1">
                                    UPGRADED
                                </div>
                                <div class="text-xs text-slate-400">Natural & Authentic</div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Voice Profiles -->
                    <div class="mb-6">
                        <h4 class="text-lg font-bold text-white mb-4">
                            <i class="fas fa-user-circle mr-2 text-indigo-400"></i>AI Voice Profiles
                        </h4>
                        
                        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
                            <!-- Voice Profile 1 -->
                            <div class="bg-slate-700/30 rounded-xl p-4 border border-slate-600 border-l-4 border-l-blue-500">
                                <div class="flex items-center justify-between mb-3">
                                    <h5 class="font-bold text-white">🎆 Yeni - Miami Latina</h5>
                                    <span class="px-2 py-1 bg-green-500/20 text-green-400 text-xs rounded-full">Sofia Vergara Style</span>
                                </div>
                                <div class="space-y-2 text-sm text-slate-300 mb-3">
                                    <p><strong>Voice Type:</strong> Latina Business Consultant</p>
                                    <p><strong>Personality:</strong> Warm & Professional Like Sofia Vergara</p>
                                    <p><strong>Speaking Style:</strong> Natural pauses, questions, interactive flow</p>
                                    <p><strong>Success Rate:</strong> 94% (Natural conversation)</p>
                                </div>
                                <div class="mb-2">
                                    <div class="flex items-center text-xs text-blue-400">
                                        <i class="fas fa-comments mr-1"></i>
                                        <span>Colombian Charm • Miami Warmth • Professional Latina</span>
                                    </div>
                                </div>
                                <div class="flex space-x-2">
                                    <button class="flex-1 px-3 py-2 bg-blue-600 hover:bg-blue-700 text-white text-xs rounded-lg transition-colors preview-voice" data-voice="professional-female">
                                        <i class="fas fa-volume-up mr-1"></i><span class="voice-btn-text">Preview</span>
                                    </button>
                                    <button class="flex-1 px-3 py-2 bg-green-600 hover:bg-green-700 text-white text-xs rounded-lg transition-colors start-conversation" data-voice="professional-female">
                                        <i class="fas fa-comments mr-1"></i>Live Chat
                                    </button>
                                    <button class="flex-1 px-3 py-2 bg-slate-600 hover:bg-slate-700 text-white text-xs rounded-lg transition-colors edit-voice" data-voice="professional-female">
                                        <i class="fas fa-sliders-h mr-1"></i>Customize
                                    </button>
                                </div>
                            </div>
                            
                            <!-- Voice Profile 2 -->
                            <div class="bg-slate-700/30 rounded-xl p-4 border border-slate-600 border-l-4 border-l-green-500">
                                <div class="flex items-center justify-between mb-3">
                                    <h5 class="font-bold text-white">🏠 Danny - Bilingual Miami</h5>
                                    <span class="px-2 py-1 bg-green-500/20 text-green-400 text-xs rounded-full">Benicio Del Toro Style</span>
                                </div>
                                <div class="space-y-2 text-sm text-slate-300 mb-3">
                                    <p><strong>Voice Type:</strong> Community Latino Charm</p>
                                    <p><strong>Personality:</strong> Smooth Like Benicio Del Toro</p>
                                    <p><strong>Speaking Style:</strong> Natural questions, pauses, friendly flow</p>
                                    <p><strong>Success Rate:</strong> 91% (Community connection)</p>
                                </div>
                                <div class="mb-2">
                                    <div class="flex items-center text-xs text-green-400">
                                        <i class="fas fa-handshake mr-1"></i>
                                        <span>Puerto Rican Charm • Bilingual • Community Feel</span>
                                    </div>
                                </div>
                                <div class="flex space-x-2">
                                    <button class="flex-1 px-3 py-2 bg-blue-600 hover:bg-blue-700 text-white text-xs rounded-lg transition-colors preview-voice" data-voice="friendly-male">
                                        <i class="fas fa-volume-up mr-1"></i>Preview
                                    </button>
                                    <button class="flex-1 px-3 py-2 bg-green-600 hover:bg-green-700 text-white text-xs rounded-lg transition-colors start-conversation" data-voice="friendly-male">
                                        <i class="fas fa-comments mr-1"></i>Live Chat
                                    </button>
                                    <button class="flex-1 px-3 py-2 bg-slate-600 hover:bg-slate-700 text-white text-xs rounded-lg transition-colors edit-voice" data-voice="friendly-male">
                                        <i class="fas fa-sliders-h mr-1"></i>Customize
                                    </button>
                                </div>
                            </div>
                            
                            <!-- Add New Voice -->
                            <div class="bg-slate-700/30 rounded-xl p-4 border border-dashed border-slate-500 flex flex-col items-center justify-center min-h-[180px]">
                                <i class="fas fa-plus-circle text-3xl text-slate-400 mb-3"></i>
                                <h5 class="font-bold text-white mb-2">Create New Voice</h5>
                                <p class="text-sm text-slate-400 text-center mb-3">Add a custom AI voice profile</p>
                                <button id="create-new-voice-btn" class="px-4 py-2 bg-indigo-600 hover:bg-indigo-700 text-white text-sm rounded-lg transition-colors">
                                    <i class="fas fa-microphone mr-1"></i>Create Voice
                                </button>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Audio Test -->
                    <div class="mb-6">
                        <div class="bg-blue-500/10 rounded-xl p-4 border border-blue-500/30">
                            <div class="flex items-center justify-between mb-3">
                                <h4 class="text-lg font-bold text-white">
                                    <i class="fas fa-volume-up mr-2 text-blue-400"></i>Audio Test
                                </h4>
                                <button id="test-audio-btn" class="px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white text-sm rounded-lg transition-colors">
                                    <i class="fas fa-play mr-1"></i>Test Audio
                                </button>
                            </div>
                            <p class="text-sm text-blue-300">
                                <i class="fas fa-info-circle mr-1"></i>
                                Click "Test Audio" to verify your speakers/headphones are working before trying voice previews.
                            </p>
                        </div>
                    </div>
                    
                    <!-- Voice Settings -->
                    <div class="mb-6">
                        <h4 class="text-lg font-bold text-white mb-4">
                            <i class="fas fa-sliders-h mr-2 text-purple-400"></i>Global Voice Settings
                        </h4>
                        
                        <div class="bg-slate-700/30 rounded-xl p-4">
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-4">
                                <div>
                                    <label class="block text-sm font-medium text-slate-300 mb-2">Default Voice Speed</label>
                                    <input type="range" min="0.5" max="2.0" step="0.1" value="1.0" class="w-full accent-purple-500">
                                    <div class="flex justify-between text-xs text-slate-400 mt-1">
                                        <span>Slow</span>
                                        <span>Normal</span>
                                        <span>Fast</span>
                                    </div>
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-slate-300 mb-2">Voice Volume</label>
                                    <input type="range" min="0" max="100" value="80" class="w-full accent-purple-500">
                                    <div class="flex justify-between text-xs text-slate-400 mt-1">
                                        <span>Quiet</span>
                                        <span>Normal</span>
                                        <span>Loud</span>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                                <label class="flex items-center">
                                    <input type="checkbox" checked class="w-4 h-4 text-purple-600 bg-slate-700 border-slate-600 rounded focus:ring-purple-500">
                                    <span class="ml-2 text-sm text-slate-300">Auto Voice Optimization</span>
                                </label>
                                <label class="flex items-center">
                                    <input type="checkbox" checked class="w-4 h-4 text-purple-600 bg-slate-700 border-slate-600 rounded focus:ring-purple-500">
                                    <span class="ml-2 text-sm text-slate-300">Dynamic Tone Adjustment</span>
                                </label>
                                <label class="flex items-center">
                                    <input type="checkbox" class="w-4 h-4 text-purple-600 bg-slate-700 border-slate-600 rounded focus:ring-purple-500">
                                    <span class="ml-2 text-sm text-slate-300">Voice Emotion Detection</span>
                                </label>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Voice Analytics -->
                    <div class="mb-6">
                        <h4 class="text-lg font-bold text-white mb-4">
                            <i class="fas fa-chart-bar mr-2 text-green-400"></i>Voice Performance Analytics
                        </h4>
                        
                        <div class="grid grid-cols-2 md:grid-cols-4 gap-4">
                            <div class="bg-slate-700/30 rounded-xl p-4 text-center">
                                <p class="text-2xl font-bold text-blue-400">87%</p>
                                <p class="text-sm text-slate-400">Average Success Rate</p>
                            </div>
                            <div class="bg-slate-700/30 rounded-xl p-4 text-center">
                                <p class="text-2xl font-bold text-green-400">3.2s</p>
                                <p class="text-sm text-slate-400">Avg Response Time</p>
                            </div>
                            <div class="bg-slate-700/30 rounded-xl p-4 text-center">
                                <p class="text-2xl font-bold text-purple-400">94%</p>
                                <p class="text-sm text-slate-400">Voice Clarity</p>
                            </div>
                            <div class="bg-slate-700/30 rounded-xl p-4 text-center">
                                <p class="text-2xl font-bold text-yellow-400">412</p>
                                <p class="text-sm text-slate-400">Total Calls Today</p>
                            </div>
                        </div>
                    </div>
                    
                    <div class="flex space-x-3">
                        <button class="close-voice-modal flex-1 px-4 py-3 bg-slate-600 hover:bg-slate-700 text-white rounded-lg transition-colors">
                            Close
                        </button>
                        <button id="save-voice-settings-btn" class="flex-1 px-4 py-3 bg-indigo-600 hover:bg-indigo-700 text-white rounded-lg font-semibold transition-colors">
                            <i class="fas fa-save mr-2"></i>Save Settings
                        </button>
                    </div>
                </div>
            `;
            
            document.body.appendChild(modal);
            
            // Close modal handlers
            modal.querySelectorAll('.close-voice-modal').forEach(function(btn) {
                btn.addEventListener('click', function() {
                    document.body.removeChild(modal);
                });
            });
            
            modal.addEventListener('click', function(e) {
                if (e.target === modal) {
                    document.body.removeChild(modal);
                }
            });
            
            // Voice preview handlers
            modal.querySelectorAll('.preview-voice').forEach(function(btn) {
                btn.addEventListener('click', function() {
                    var voiceType = btn.getAttribute('data-voice');
                    var originalText = btn.innerHTML;
                    
                    btn.innerHTML = '<i class="fas fa-volume-up fa-pulse mr-1"></i>Speaking...';
                    btn.disabled = true;
                    
                    // Play real voice preview for the specific voice type
                    playVoicePreviewByType(voiceType, function() {
                        btn.innerHTML = originalText;
                        btn.disabled = false;
                    });
                });
            });
            
            // Real-time conversation handlers
            modal.querySelectorAll('.start-conversation').forEach(function(btn) {
                btn.addEventListener('click', function() {
                    var voiceType = btn.getAttribute('data-voice');
                    var originalText = btn.innerHTML;
                    
                    // Get voice profile information
                    var voiceProfile = getVoiceProfile(voiceType);
                    
                    // Check for speech recognition support
                    if (!('webkitSpeechRecognition' in window) && !('SpeechRecognition' in window)) {
                        showNotification('⚠️ Voice recognition not supported in this browser. Please use Chrome for real-time conversations.', 'warning');
                        return;
                    }
                    
                    // Start real-time conversation
                    btn.innerHTML = '<i class="fas fa-stop mr-1"></i>End Chat';
                    btn.classList.remove('bg-green-600', 'hover:bg-green-700');
                    btn.classList.add('bg-red-600', 'hover:bg-red-700');
                    
                    // Disable other conversation buttons
                    modal.querySelectorAll('.start-conversation').forEach(function(otherBtn) {
                        if (otherBtn !== btn) {
                            otherBtn.disabled = true;
                        }
                    });
                    
                    // Start conversation
                    window.conversationManager.startRealTimeConversation(voiceProfile);
                    
                    // Update button to end conversation
                    btn.onclick = function() {
                        window.conversationManager.stopConversation();
                        
                        // Reset button
                        btn.innerHTML = originalText;
                        btn.classList.remove('bg-red-600', 'hover:bg-red-700');
                        btn.classList.add('bg-green-600', 'hover:bg-green-700');
                        
                        // Re-enable other buttons
                        modal.querySelectorAll('.start-conversation').forEach(function(otherBtn) {
                            otherBtn.disabled = false;
                        });
                        
                        // Restore original click handler
                        btn.onclick = null;
                    };
                });
            });
            
            // Create new voice handler
            modal.querySelector('#create-new-voice-btn').addEventListener('click', function() {
                showNotification('Voice creation feature coming soon!', 'info');
            });
            
            // Test audio handler
            modal.querySelector('#test-audio-btn').addEventListener('click', function() {
                var btn = modal.querySelector('#test-audio-btn');
                var originalText = btn.innerHTML;
                
                btn.innerHTML = '<i class="fas fa-volume-up fa-pulse mr-1"></i>Testing...';
                btn.disabled = true;
                
                // Test audio using speech synthesis
                if ('speechSynthesis' in window) {
                    var utterance = new SpeechSynthesisUtterance('Audio test successful! Your speakers are working correctly.');
                    utterance.rate = 1.0;
                    utterance.pitch = 1.0;
                    utterance.volume = 0.8;
                    
                    utterance.onstart = function() {
                        showNotification('🔊 Playing audio test - Can you hear this?', 'info');
                    };
                    
                    utterance.onend = function() {
                        btn.innerHTML = originalText;
                        btn.disabled = false;
                        showNotification('✅ Audio test completed! Your audio is working.', 'success');
                    };
                    
                    utterance.onerror = function() {
                        btn.innerHTML = originalText;
                        btn.disabled = false;
                        showNotification('❌ Audio test failed - Check your audio settings', 'error');
                    };
                    
                    window.speechSynthesis.speak(utterance);
                } else {
                    btn.innerHTML = originalText;
                    btn.disabled = false;
                    showNotification('❌ Audio not supported in this browser', 'error');
                }
            });
            
            // Save settings handler
            modal.querySelector('#save-voice-settings-btn').addEventListener('click', function() {
                showNotification('Voice settings saved successfully!', 'success');
                setTimeout(function() {
                    document.body.removeChild(modal);
                }, 1000);
            });
        }
        
        // Populate Template Grid
        function populateTemplateGrid() {
            var templates = [
                {
                    id: 'hvac-emergency',
                    title: 'HVAC Emergency Service',
                    category: 'emergency',
                    conversion: '94%',
                    description: 'High-urgency script for emergency HVAC service calls',
                    preview: 'Hi [Name], this is [Your Name] from [Company]. I understand you\'re having an urgent HVAC issue...'
                },
                {
                    id: 'hospital-critical-care',
                    title: 'Hospital Critical Care HVAC',
                    category: 'hospitals',
                    conversion: '91%',
                    description: 'Specialized script for hospital and healthcare facility HVAC needs',
                    preview: 'Hello [Name], I\'m calling from [Company] regarding critical HVAC maintenance for your healthcare facility...'
                },
                {
                    id: 'datacenter-cooling',
                    title: 'Data Center Cooling Systems',
                    category: 'datacenters',
                    conversion: '89%',
                    description: 'Precision cooling and climate control for data centers',
                    preview: 'Good morning [Name], I\'m reaching out about your data center\'s cooling infrastructure and redundancy needs...'
                },
                {
                    id: 'manufacturing-facility',
                    title: 'Manufacturing Climate Control',
                    category: 'manufacturing',
                    conversion: '85%',
                    description: 'Industrial HVAC solutions for manufacturing environments',
                    preview: 'Hi [Name], I\'m calling about optimizing your manufacturing facility\'s climate control systems...'
                },
                {
                    id: 'university-campus',
                    title: 'University Campus HVAC',
                    category: 'universities',
                    conversion: '78%',
                    description: 'Large-scale HVAC solutions for educational campuses',
                    preview: 'Good afternoon [Name], I\'m reaching out regarding HVAC services for your university campus facilities...'
                },
                {
                    id: 'call-center-environment',
                    title: 'Call Center Climate Control',
                    category: 'callcenters',
                    conversion: '82%',
                    description: 'Optimal climate control for large call center operations',
                    preview: 'Hello [Name], I\'m calling about maintaining optimal temperature and air quality for your call center...'
                },
                {
                    id: 'commercial-buildings',
                    title: 'Commercial Building HVAC',
                    category: 'commercial',
                    conversion: '76%',
                    description: 'Comprehensive HVAC services for commercial properties',
                    preview: 'Good morning [Name], I\'m reaching out regarding your commercial building\'s HVAC maintenance needs...'
                },
                {
                    id: 'property-management',
                    title: 'Property Management Portfolio',
                    category: 'property',
                    conversion: '80%',
                    description: 'Multi-property HVAC management and maintenance contracts',
                    preview: 'Hi [Name], I\'m calling about comprehensive HVAC services for your property management portfolio...'
                }
            ];
            
            var grid = document.getElementById('templatesGrid');
            var templateHTML = '';
            for (var i = 0; i < templates.length; i++) {
                var template = templates[i];
                templateHTML += 
                    '<div class="template-card bg-slate-700/50 rounded-xl p-4 hover:bg-slate-700 transition-colors" data-category="' + template.category + '">' +
                        '<div class="flex justify-between items-start mb-3">' +
                            '<h4 class="font-semibold text-white">' + template.title + '</h4>' +
                            '<span class="px-2 py-1 bg-green-500/20 text-green-400 text-xs rounded-full">' + template.conversion + '</span>' +
                        '</div>' +
                        '<p class="text-slate-400 text-sm mb-3">' + template.description + '</p>' +
                        '<div class="bg-slate-800/50 rounded p-3 mb-3">' +
                            '<p class="text-slate-300 text-xs italic">"' + template.preview + '..."</p>' +
                        '</div>' +
                        '<button class="w-full bg-blue-600 hover:bg-blue-700 text-white py-2 px-4 rounded-lg text-sm transition-colors" onclick="useTemplate(\'' + template.id + '\')">' +
                            'Use Template' +
                        '</button>' +
                    '</div>';
            }
            grid.innerHTML = templateHTML;
        }
        
        function useTemplate(templateId) {
            showNotification(`Template "${templateId}" loaded for customization!`, 'success');
            closeTemplateBrowserModal();
        }
        
        // Script Viewer Functions
        function openScriptViewer(scriptId) {
            var modal = document.getElementById('scriptViewerModal');
            modal.classList.remove('hidden');
            loadScriptContent(scriptId);
        }
        
        function closeScriptViewer() {
            var modal = document.getElementById('scriptViewerModal');
            modal.classList.add('hidden');
        }
        
        function loadScriptContent(scriptId) {
            // Sample script database - in a real app this would come from your backend
            var scripts = {
                'hvac-maintenance-1': {
                    title: 'HVAC Maintenance Cold Call Script',
                    type: 'Cold Call',
                    industry: 'HVAC Services',
                    conversion: '87%',
                    duration: '3-5 min',
                    content: `
                        <div class="script-section">
                            <h5 class="font-bold text-blue-400 mb-2">🎯 OPENING (0-30 seconds)</h5>
                            <p class="mb-4">"Hello [PROSPECT NAME], this is [YOUR NAME] from [COMPANY NAME]. I hope I'm catching you at a good time. I'm calling because we specialize in HVAC maintenance for [INDUSTRY TYPE] and I wanted to reach out about ensuring your system is running efficiently before the peak season hits."</p>
                        </div>
                        
                        <div class="script-section">
                            <h5 class="font-bold text-green-400 mb-2">🔍 DISCOVERY (30-90 seconds)</h5>
                            <p class="mb-2"><strong>Purpose Statement:</strong></p>
                            <p class="mb-4">"The reason for my call is that many [INDUSTRY] facilities like yours often experience unexpected breakdowns during peak seasons, which can cost thousands in emergency repairs and lost productivity. I'd love to ask you a couple quick questions about your current HVAC maintenance routine."</p>
                            
                            <p class="mb-2"><strong>Discovery Questions:</strong></p>
                            <ul class="list-disc list-inside space-y-1 text-slate-300 mb-4">
                                <li>When was your last professional HVAC inspection?</li>
                                <li>Are you currently on any preventive maintenance schedule?</li>
                                <li>Have you experienced any unexpected breakdowns in the past year?</li>
                            </ul>
                        </div>
                        
                        <div class="script-section">
                            <h5 class="font-bold text-purple-400 mb-2">💡 VALUE PROPOSITION (90-150 seconds)</h5>
                            <p class="mb-4">"Based on what you've shared, I think you'd be interested in our ProActive Maintenance Program. We've helped over [NUMBER] businesses in your industry reduce their HVAC costs by an average of 30% while preventing 95% of emergency breakdowns."</p>
                            
                            <p class="mb-2"><strong>Key Benefits:</strong></p>
                            <ul class="list-disc list-inside space-y-1 text-slate-300 mb-4">
                                <li>Quarterly professional inspections and tune-ups</li>
                                <li>Priority emergency service (24/7 availability)</li>
                                <li>15% discount on all repairs and parts</li>
                                <li>Energy efficiency optimization (typically 15-20% savings)</li>
                                <li>Detailed reporting and maintenance history</li>
                            </ul>
                        </div>
                        
                        <div class="script-section">
                            <h5 class="font-bold text-yellow-400 mb-2">📅 CLOSE & NEXT STEPS (150-180 seconds)</h5>
                            <p class="mb-4">"I'd love to schedule a complimentary facility assessment where we can evaluate your current systems and provide you with a customized maintenance proposal. This typically takes about 30 minutes and there's absolutely no obligation."</p>
                            
                            <p class="mb-2"><strong>Scheduling Options:</strong></p>
                            <p class="mb-4">"I have availability [DAY 1] at [TIME] or [DAY 2] at [TIME]. Which works better for your schedule?"</p>
                        </div>
                        
                        <div class="script-section border-t border-slate-600 pt-4">
                            <h5 class="font-bold text-red-400 mb-2">🛡️ COMMON OBJECTIONS & RESPONSES</h5>
                            
                            <div class="mb-3">
                                <p class="font-semibold text-slate-200">"We already have a maintenance company"</p>
                                <p class="text-slate-300">"That's great that you're being proactive! May I ask how often they perform inspections and what's included? I find many companies offer basic service but miss critical energy efficiency opportunities..."</p>
                            </div>
                            
                            <div class="mb-3">
                                <p class="font-semibold text-slate-200">"We need to think about it"</p>
                                <p class="text-slate-300">"I completely understand - this is an important decision. What specific information would be helpful for you to make the best decision for your facility?"</p>
                            </div>
                            
                            <div class="mb-3">
                                <p class="font-semibold text-slate-200">"What does this cost?"</p>
                                <p class="text-slate-300">"Great question! The investment varies based on your facility size and equipment. Most of our clients find the program pays for itself within the first quarter through energy savings alone. That's exactly why I'd like to do the complimentary assessment..."</p>
                            </div>
                        </div>
                    `
                },
                'new-customer-1': {
                    title: 'New Customer Acquisition - Residential HVAC',
                    type: 'Cold Call',
                    industry: 'Residential',
                    conversion: '72%',
                    duration: '4-6 min',
                    content: `
                        <div class="script-section">
                            <h5 class="font-bold text-blue-400 mb-2">🏠 RESIDENTIAL OPENING</h5>
                            <p class="mb-4">"Hi [HOMEOWNER NAME], this is [YOUR NAME] from [COMPANY NAME]. I hope I'm not catching you at a bad time. I'm calling because we're doing some HVAC system evaluations in your neighborhood and wanted to reach out about ensuring your home stays comfortable year-round."</p>
                        </div>
                        
                        <div class="script-section">
                            <h5 class="font-bold text-green-400 mb-2">🔍 HOMEOWNER DISCOVERY</h5>
                            <p class="mb-4">"The reason I'm calling is that many homeowners in [NEIGHBORHOOD] are dealing with rising energy costs and aging HVAC systems. I'd love to ask you just a couple of quick questions about your home's heating and cooling."</p>
                            
                            <ul class="list-disc list-inside space-y-1 text-slate-300 mb-4">
                                <li>How old is your current HVAC system?</li>
                                <li>Have you noticed your energy bills increasing lately?</li>
                                <li>Any rooms in your home that are too hot or cold?</li>
                                <li>When did you last have your system serviced?</li>
                            </ul>
                        </div>
                        
                        <div class="script-section">
                            <h5 class="font-bold text-purple-400 mb-2">💰 VALUE FOR HOMEOWNERS</h5>
                            <p class="mb-4">"Based on what you're telling me, you might benefit from our Home Comfort Assessment. We've helped hundreds of families in your area reduce their energy costs by 25-40% while making their homes much more comfortable."</p>
                            
                            <p class="mb-2"><strong>What's Included:</strong></p>
                            <ul class="list-disc list-inside space-y-1 text-slate-300 mb-4">
                                <li>Complete system efficiency evaluation</li>
                                <li>Ductwork inspection and sealing assessment</li>
                                <li>Thermostat and zoning recommendations</li>
                                <li>Energy savings calculations</li>
                                <li>Written estimate for any recommended improvements</li>
                            </ul>
                        </div>
                        
                        <div class="script-section">
                            <h5 class="font-bold text-yellow-400 mb-2">📞 SCHEDULING</h5>
                            <p class="mb-4">"I'd love to send one of our certified technicians out to give you this assessment completely free. It usually takes about 45 minutes and you'll get a detailed report showing exactly how to maximize your home's comfort and efficiency."</p>
                            <p class="mb-4">"I have some availability [DAY] morning or [DAY] afternoon. What works better for you?"</p>
                        </div>
                    `
                },
                'follow-up-appointment': {
                    title: 'Follow-up Call - Service Appointment',
                    type: 'Follow-up',
                    industry: 'HVAC Services',
                    conversion: '91%',
                    duration: '2-4 min',
                    content: `
                        <div class="script-section">
                            <h5 class="font-bold text-blue-400 mb-2">📞 WARM FOLLOW-UP OPENING (0-20 seconds)</h5>
                            <p class="mb-4">"Hi [CUSTOMER NAME], this is [YOUR NAME] from [COMPANY NAME]. I'm calling to follow up on the service appointment we completed at your [LOCATION TYPE] on [DATE]. I hope you've been comfortable since our technician [TECH NAME] was there."</p>
                        </div>
                        
                        <div class="script-section">
                            <h5 class="font-bold text-green-400 mb-2">✅ SERVICE CONFIRMATION (20-60 seconds)</h5>
                            <p class="mb-2"><strong>Immediate Check-in:</strong></p>
                            <p class="mb-4">"I wanted to personally make sure everything is working perfectly after [SPECIFIC SERVICE PERFORMED]. How has your system been running since our visit?"</p>
                            
                            <p class="mb-2"><strong>Quality Assurance Questions:</strong></p>
                            <ul class="list-disc list-inside space-y-1 text-slate-300 mb-4">
                                <li>Is the temperature now consistent throughout your [facility/home]?</li>
                                <li>Have you noticed any unusual sounds or issues?</li>
                                <li>Are you satisfied with how our technician handled the service?</li>
                                <li>Do you have any questions about what was done or the recommendations made?</li>
                            </ul>
                        </div>
                        
                        <div class="script-section">
                            <h5 class="font-bold text-purple-400 mb-2">🔧 MAINTENANCE & PREVENTION (60-120 seconds)</h5>
                            <p class="mb-4">"I'm glad everything is working well! Based on what [TECH NAME] found during the service, I wanted to discuss a couple of things that could help prevent future issues and keep your system running efficiently."</p>
                            
                            <div class="mb-4">
                                <p class="mb-2"><strong>If Maintenance Program Not Discussed:</strong></p>
                                <p class="mb-4">"One thing many of our customers find valuable is our preventive maintenance program. Since you've experienced [PREVIOUS ISSUE], regular maintenance could help prevent similar problems and typically saves 20-30% on energy costs."</p>
                            </div>
                            
                            <div class="mb-4">
                                <p class="mb-2"><strong>If Additional Recommendations Were Made:</strong></p>
                                <p class="mb-4">"[TECH NAME] mentioned [SPECIFIC RECOMMENDATION - filter upgrade, duct sealing, etc.]. Have you had a chance to think about that? I can provide more details or answer any questions you might have."</p>
                            </div>
                        </div>
                        
                        <div class="script-section">
                            <h5 class="font-bold text-yellow-400 mb-2">📋 NEXT STEPS & RELATIONSHIP BUILDING (120-150 seconds)</h5>
                            <p class="mb-4">"Before I var you go, I want to make sure you have our direct number for any future needs. We guarantee all our work, and if you have any concerns at all, please don't hesitate to call."</p>
                            
                            <div class="mb-4">
                                <p class="mb-2"><strong>Seasonal Preparation:</strong></p>
                                <p class="mb-4">"As we head into [UPCOMING SEASON], it's a good time to schedule your [seasonal service type]. Would you like me to put you on our schedule for [timeframe]? Our regular customers get priority booking and preferred pricing."</p>
                            </div>
                            
                            <div class="mb-4">
                                <p class="mb-2"><strong>Referral Request:</strong></p>
                                <p class="mb-4">"If you know anyone who might need reliable HVAC service, we'd be grateful for the referral. We offer a [referral incentive] for customers who refer new clients to us."</p>
                            </div>
                        </div>
                        
                        <div class="script-section">
                            <h5 class="font-bold text-green-400 mb-2">🎯 CLOSING & SATISFACTION (150-180 seconds)</h5>
                            <p class="mb-4">"Is there anything else I can help you with today? We really appreciate your business and want to make sure you're completely satisfied with our service."</p>
                            
                            <div class="mb-4">
                                <p class="mb-2"><strong>Review Request:</strong></p>
                                <p class="mb-4">"If you're happy with the service you received, would you mind taking just a minute to leave us a review? It really helps other customers find us, and I can send you a quick link right after this call."</p>
                            </div>
                            
                            <p class="mb-4">"Thank you again for choosing [COMPANY NAME]. We look forward to taking care of all your HVAC needs in the future. Have a great day!"</p>
                        </div>
                        
                        <div class="script-section border-t border-slate-600 pt-4">
                            <h5 class="font-bold text-red-400 mb-2">🛠️ ISSUE RESOLUTION RESPONSES</h5>
                            
                            <div class="mb-3">
                                <p class="font-semibold text-slate-200">"Actually, we're having the same problem again"</p>
                                <p class="text-slate-300">"I'm so sorry to hear that! Let me get [TECH NAME] or our service manager on the line right away. Since this is related to our recent service, there's no charge for us to come back out and make this right. When would be a good time for us to return?"</p>
                            </div>
                            
                            <div class="mb-3">
                                <p class="font-semibold text-slate-200">"We're not satisfied with the service"</p>
                                <p class="text-slate-300">"I appreciate you letting me know. Your satisfaction is our top priority. Can you tell me specifically what didn't meet your expectations? I want to make sure we address this properly and make things right."</p>
                            </div>
                            
                            <div class="mb-3">
                                <p class="font-semibold text-slate-200">"The price was higher than expected"</p>
                                <p class="text-slate-300">"I understand your concern about the cost. Let me review the work that was done and make sure everything was explained clearly. Our pricing is based on [pricing structure], and I want to make sure you understand the value you received. Can we go over the invoice together?"</p>
                            </div>
                        </div>
                    `
                }
            };
            
            var script = scripts[scriptId];
            if (script) {
                document.getElementById('scriptViewerTitle').textContent = script.title;
                document.getElementById('scriptConversion').textContent = script.conversion;
                document.getElementById('scriptDuration').textContent = script.duration;
                document.getElementById('scriptIndustry').textContent = script.industry;
                document.getElementById('scriptType').textContent = script.type;
                document.getElementById('scriptContent').innerHTML = script.content;
            }
        }
        
        // Notification System
        function showNotification(message, type = 'success') {
            var notification = document.createElement('div');
            notification.className = `fixed top-4 right-4 z-50 px-6 py-3 rounded-lg text-white font-semibold shadow-lg transform translate-x-full transition-transform duration-300 ${
                type === 'success' ? 'bg-green-600' : 
                type === 'error' ? 'bg-red-600' : 
                type === 'info' ? 'bg-blue-600' : 'bg-slate-600'
            }`;
            
            notification.innerHTML = `
                <div class="flex items-center">
                    <i class="fas fa-${type === 'success' ? 'check' : type === 'error' ? 'exclamation-triangle' : 'info-circle'} mr-2"></i>
                    ${message}
                </div>
            `;
            
            document.body.appendChild(notification);
            
            // Slide in
            setTimeout(function() {
                notification.style.transform = 'translateX(0)';
            }, 100);
            
            // Slide out and remove
            setTimeout(function() {
                notification.style.transform = 'translateX(100%)';
                setTimeout(function() {
                    if (document.body.contains(notification)) {
                        document.body.removeChild(notification);
                    }
                }, 300);
            }, 3000);
        }
        
        // Lead Form Submission
        function handleLeadFormSubmission() {
            var form = document.getElementById('leadForm');
            if (form) {
                form.addEventListener('submit', function(e) {
                    e.preventDefault();
                    
                    // Collect form data
                    var leadData = {
                        firstName: document.getElementById('firstName').value,
                        lastName: document.getElementById('lastName').value,
                        company: document.getElementById('company').value,
                        email: document.getElementById('email').value,
                        phone: document.getElementById('phone').value,
                        jobTitle: document.getElementById('jobTitle').value,
                        leadSource: document.getElementById('leadSource').value,
                        notes: document.getElementById('notes').value,
                        dateAdded: new Date().toISOString()
                    };
                    
                    console.log('📝 New lead submitted:', leadData);
                    
                    // In a real app, this would be sent to your backend
                    // For now, we'll simulate saving and show success message
                    setTimeout(function() {
                        showNotification(`Lead "${leadData.firstName} ${leadData.lastName}" added successfully!`, 'success');
                        closeLeadModal();
                    }, 500);
                });
            }
        }
        
        // CSV File Handling
        function handleCsvImport() {
            var uploadBtn = document.getElementById('uploadCsv');
            var fileInput = document.getElementById('csvFile');
            
            if (uploadBtn && fileInput) {
                uploadBtn.addEventListener('click', function() {
                    var file = fileInput.files[0];
                    if (!file) {
                        showNotification('Please select a CSV file first.', 'error');
                        return;
                    }
                    
                    console.log('📄 CSV file selected:', file.name);
                    
                    // In a real app, you would parse and process the CSV
                    // For now, we'll simulate the import
                    showNotification('CSV import started...', 'info');
                    
                    setTimeout(function() {
                        var randomCount = Math.floor(Math.random() * 50) + 10;
                        showNotification(`Successfully imported ${randomCount} leads from CSV!`, 'success');
                        closeCsvModal();
                    }, 2000);
                });
            }
        }
        
        // Script Form Handlers
        function handleScriptForms() {
            // Script Generator form
            var scriptGenForm = document.getElementById('scriptGeneratorForm');
            if (scriptGenForm) {
                scriptGenForm.addEventListener('submit', function(e) {
                    e.preventDefault();
                    
                    var scriptType = document.getElementById('scriptType').value;
                    var targetIndustry = document.getElementById('targetIndustry').value;
                    var campaignGoal = document.getElementById('campaignGoal').value;
                    var requirements = document.getElementById('scriptRequirements').value;
                    
                    console.log('🤖 Generating script:', { scriptType, targetIndustry, campaignGoal, requirements });
                    
                    // Get industry-specific message
                    var industryNames = {
                        'hvac': 'HVAC Services',
                        'hospitals': 'Hospitals and Critical Care',
                        'datacenters': 'Data Centers',
                        'manufacturing': 'Manufacturing Facilities',
                        'commercial': 'Commercial Buildings',
                        'industrial': 'Industrial Facilities',
                        'universities': 'Universities',
                        'callcenters': 'Large Call Centers',
                        'property': 'Property Management',
                        'general': 'General B2B'
                    };
                    
                    var industryName = industryNames[targetIndustry] || targetIndustry;
                    
                    showNotification(`AI is generating your personalized ${scriptType} script for ${industryName}...`, 'info');
                    
                    setTimeout(function() {
                        showNotification(`${scriptType.replace('-', ' ').toUpperCase()} script for ${industryName} generated successfully! Check your Scripts library.`, 'success');
                        closeScriptGeneratorModal();
                    }, 3000);
                });
            }
            
            // Script Optimizer form
            var scriptOptForm = document.getElementById('scriptOptimizerForm');
            if (scriptOptForm) {
                scriptOptForm.addEventListener('submit', function(e) {
                    e.preventDefault();
                    
                    var scriptSelect = document.getElementById('optimizeScriptSelect').value;
                    console.log('🚀 Optimizing script:', scriptSelect);
                    
                    showNotification('AI is analyzing and optimizing your script...', 'info');
                    
                    setTimeout(function() {
                        showNotification(`Script optimization complete! Predicted 23% conversion improvement.`, 'success');
                        closeScriptOptimizerModal();
                    }, 4000);
                });
            }
        }
        
        // Authentication Form Handlers
        function handleAuthenticationForms() {
            // Login form submission
            var loginForm = document.getElementById('loginForm');
            if (loginForm) {
                loginForm.addEventListener('submit', function(e) {
                    e.preventDefault();
                    
                    var email = document.getElementById('loginEmail').value;
                    var password = document.getElementById('loginPassword').value;
                    
                    console.log('🔐 ProSpector login attempt:', email);
                    
                    // In a real app, this would authenticate with your backend
                    // For demo purposes, we'll simulate authentication
                    showNotification('Authenticating...', 'info');
                    
                    setTimeout(function() {
                        // Simulate authentication check
                        if (email && password) {
                            showNotification(`Welcome back! Logged in as ${email}`, 'success');
                            closeLoginModal();
                            
                            // You could update the UI to show logged-in state here
                            // For example: hide login/signup buttons, show user menu, etc.
                        } else {
                            showNotification('Please enter valid credentials.', 'error');
                        }
                    }, 1500);
                });
            }
            
            // Signup form submission
            var signupForm = document.getElementById('signupForm');
            if (signupForm) {
                signupForm.addEventListener('submit', function(e) {
                    e.preventDefault();
                    
                    var formData = {
                        firstName: document.getElementById('signupFirstName').value,
                        email: document.getElementById('signupEmail').value,
                        company: document.getElementById('signupCompany').value,
                        timestamp: new Date().toISOString()
                    };
                    
                    console.log('📝 ProSpector signup request:', formData);
                    
                    // In a real app, this would send the application to your backend
                    showNotification('Submitting access request...', 'info');
                    
                    setTimeout(function() {
                        showNotification(`Access request submitted! We'll review your application and send credentials to ${formData.email} within 24-48 hours.`, 'success');
                        closeSignupModal();
                    }, 2000);
                });
            }
        }
        
        // Initialize all modal event handlers
        function initializeModalHandlers() {
            // Lead modal handlers
            var closeModalBtn = document.getElementById('closeModal');
            var cancelLeadBtn = document.getElementById('cancelLead');
            var leadModal = document.getElementById('leadModal');
            
            if (closeModalBtn) closeModalBtn.addEventListener('click', closeLeadModal);
            if (cancelLeadBtn) cancelLeadBtn.addEventListener('click', closeLeadModal);
            
            if (leadModal) {
                leadModal.addEventListener('click', function(e) {
                    if (e.target === leadModal) closeLeadModal();
                });
            }
            
            // CSV modal handlers
            var closeCsvModalBtn = document.getElementById('closeCsvModal');
            var cancelCsvBtn = document.getElementById('cancelCsv');
            var csvModal = document.getElementById('csvModal');
            
            if (closeCsvModalBtn) closeCsvModalBtn.addEventListener('click', closeCsvModal);
            if (cancelCsvBtn) cancelCsvBtn.addEventListener('click', closeCsvModal);
            
            if (csvModal) {
                csvModal.addEventListener('click', function(e) {
                    if (e.target === csvModal) closeCsvModal();
                });
            }
            
            // Authentication modal handlers
            var closeLoginBtn = document.getElementById('closeLoginModal');
            var closeSignupBtn = document.getElementById('closeSignupModal');
            var loginModal = document.getElementById('loginModal');
            var signupModal = document.getElementById('signupModal');
            
            if (closeLoginBtn) closeLoginBtn.addEventListener('click', closeLoginModal);
            if (closeSignupBtn) closeSignupBtn.addEventListener('click', closeSignupModal);
            
            if (loginModal) {
                loginModal.addEventListener('click', function(e) {
                    if (e.target === loginModal) closeLoginModal();
                });
            }
            
            if (signupModal) {
                signupModal.addEventListener('click', function(e) {
                    if (e.target === signupModal) closeSignupModal();
                });
            }
            
            // Initialize form handlers
            handleLeadFormSubmission();
            handleCsvImport();
            handleAuthenticationForms();
            handleScriptForms();
            
            // Script modal handlers
            var closeScriptGenBtn = document.getElementById('closeScriptGeneratorModal');
            var closeTemplateBrowserBtn = document.getElementById('closeTemplateBrowserModal');
            var closeScriptOptBtn = document.getElementById('closeScriptOptimizerModal');
            
            if (closeScriptGenBtn) closeScriptGenBtn.addEventListener('click', closeScriptGeneratorModal);
            if (closeTemplateBrowserBtn) closeTemplateBrowserBtn.addEventListener('click', closeTemplateBrowserModal);
            if (closeScriptOptBtn) closeScriptOptBtn.addEventListener('click', closeScriptOptimizerModal);
            
            // Script viewer handlers
            var closeScriptViewerBtn = document.getElementById('closeScriptViewerModal');
            if (closeScriptViewerBtn) closeScriptViewerBtn.addEventListener('click', closeScriptViewer);
            
            // View script buttons
            document.querySelectorAll('.view-script-btn').forEach(function(btn) {
                btn.addEventListener('click', function() {
                    var scriptId = this.getAttribute('data-script-id');
                    console.log('👁️ Viewing script:', scriptId);
                    openScriptViewer(scriptId);
                });
            });
            
            // Use script buttons
            document.querySelectorAll('.use-script-btn').forEach(function(btn) {
                btn.addEventListener('click', function() {
                    var scriptId = this.getAttribute('data-script-id');
                    console.log('📞 Using script for calls:', scriptId);
                    showNotification('Script loaded for voice calling session!', 'success');
                    // In a real app, this would integrate with the voice calling system
                });
            });
            
            // Script action buttons
            var copyScriptBtn = document.getElementById('copyScriptBtn');
            var downloadScriptBtn = document.getElementById('downloadScriptBtn');
            var useScriptBtn = document.getElementById('useScriptBtn');
            
            if (copyScriptBtn) {
                copyScriptBtn.addEventListener('click', function() {
                    var scriptContent = document.getElementById('scriptContent').innerText;
                    navigator.clipboard.writeText(scriptContent).then(function() {
                        showNotification('Script copied to clipboard!', 'success');
                    }).catch(function() {
                        showNotification('Could not copy script. Please select and copy manually.', 'error');
                    });
                });
            }
            
            if (downloadScriptBtn) {
                downloadScriptBtn.addEventListener('click', function() {
                    showNotification('Generating PDF download...', 'info');
                    // In a real app, this would generate and download a PDF
                    setTimeout(function() {
                        showNotification('Script PDF ready for download!', 'success');
                    }, 2000);
                });
            }
            
            if (useScriptBtn) {
                useScriptBtn.addEventListener('click', function() {
                    showNotification('Starting voice calling session with this script!', 'success');
                    closeScriptViewer();
                    // In a real app, this would switch to the voice calling tab with the script loaded
                });
            }
            
            // Clone script buttons
            document.querySelectorAll('.clone-script-btn').forEach(function(btn) {
                btn.addEventListener('click', function() {
                    var scriptId = this.getAttribute('data-script-id');
                    console.log('📋 Cloning script:', scriptId);
                    
                    // Show notification with script-specific clone message
                    var scriptTitles = {
                        'follow-up-appointment': 'Follow-up Call - Service Appointment',
                        'hvac-maintenance-1': 'HVAC Maintenance Cold Call Script',
                        'new-customer-1': 'New Customer Acquisition - Residential HVAC'
                    };
                    
                    var scriptTitle = scriptTitles[scriptId] || 'Script';
                    showNotification(`Creating copy of "${scriptTitle}"...`, 'info');
                    
                    // Simulate script cloning process
                    setTimeout(function() {
                        var newScriptName = `${scriptTitle} (Copy)`;
                        showNotification(`Successfully cloned script as "${newScriptName}"! Check your Scripts library.`, 'success');
                        
                        // In a real app, this would:
                        // 1. Create a duplicate of the script in the database
                        // 2. Generate a new unique ID for the cloned script
                        // 3. Add it to the user's script library
                        // 4. Optionally redirect to edit the cloned script
                        
                        console.log(`✅ Script cloned: ${scriptId} -> ${newScriptName}`);
                    }, 1500);
                });
            });
            
            // Share script buttons
            document.querySelectorAll('.share-script-btn').forEach(function(btn) {
                btn.addEventListener('click', function() {
                    var scriptId = this.getAttribute('data-script-id');
                    console.log('🔗 Sharing script:', scriptId);
                    
                    // Generate shareable link (in real app, this would be a secure share link)
                    var shareUrl = `${window.location.origin}/shared-script/${scriptId}`;
                    
                    // Show sharing modal or copy link to clipboard
                    if (navigator.clipboard) {
                        navigator.clipboard.writeText(shareUrl).then(function() {
                            showNotification('Script share link copied to clipboard!', 'success');
                        }).catch(function() {
                            showShareModal(scriptId, shareUrl);
                        });
                    } else {
                        showShareModal(scriptId, shareUrl);
                    }
                    
                    // In a real app, this would:
                    // 1. Generate a secure, time-limited share link
                    // 2. Create sharing permissions (view-only, edit, etc.)
                    // 3. Log the sharing activity
                    // 4. Optionally send email notifications
                    
                    console.log(`🔗 Share link generated for script: ${scriptId}`);
                });
            });
            
            // AI Script Import modal handlers
            var closeAiScriptImportBtn = document.getElementById('closeAiScriptImportModal');
            var cancelAiImportBtn = document.getElementById('cancelAiImport');
            var aiScriptImportModal = document.getElementById('aiScriptImportModal');
            
            if (closeAiScriptImportBtn) closeAiScriptImportBtn.addEventListener('click', closeAiScriptImportModal);
            if (cancelAiImportBtn) cancelAiImportBtn.addEventListener('click', closeAiScriptImportModal);
            
            if (aiScriptImportModal) {
                aiScriptImportModal.addEventListener('click', function(e) {
                    if (e.target === aiScriptImportModal) closeAiScriptImportModal();
                });
            }
            
            // AI Actors Guild modal handlers
            var closeAiActorsGuildBtn = document.getElementById('closeAiActorsGuildModal');
            var cancelAiActorsGuildBtn = document.getElementById('cancelAiActorsGuild');
            var aiActorsGuildModal = document.getElementById('aiActorsGuildModal');
            
            if (closeAiActorsGuildBtn) closeAiActorsGuildBtn.addEventListener('click', closeAiActorsGuildModal);
            if (cancelAiActorsGuildBtn) cancelAiActorsGuildBtn.addEventListener('click', closeAiActorsGuildModal);
            
            if (aiActorsGuildModal) {
                aiActorsGuildModal.addEventListener('click', function(e) {
                    if (e.target === aiActorsGuildModal) closeAiActorsGuildModal();
                });
            }
            
            // Handle AI Script Import form submission
            var aiScriptImportForm = document.getElementById('aiScriptImportForm');
            if (aiScriptImportForm) {
                aiScriptImportForm.addEventListener('submit', handleAiScriptImportSubmission);
            }
            
            // Handle AI Actors Guild training options
            document.querySelectorAll('.training-option-btn').forEach(function(btn) {
                btn.addEventListener('click', function() {
                    var trainingType = this.getAttribute('data-training');
                    console.log('🎭 Starting training:', trainingType);
                    
                    var trainingMessages = {
                        'script-learning': 'Initializing AI script learning algorithms...',
                        'voice-modulation': 'Configuring voice tone and modulation training...',
                        'objection-handling': 'Setting up advanced objection handling training...'
                    };
                    
                    showNotification(trainingMessages[trainingType] || 'Starting AI training session...', 'info');
                    
                    // Simulate training progress
                    setTimeout(function() {
                        showNotification(`${trainingType.replace('-', ' ')} training session configured successfully!`, 'success');
                    }, 2000);
                });
            });
            
            // Handle AI Actors Guild action buttons
            var startTrainingBtn = document.getElementById('startTrainingSession');
            var deployAiActorBtn = document.getElementById('deployAiActor');
            
            if (startTrainingBtn) {
                startTrainingBtn.addEventListener('click', function() {
                    console.log('🎯 Starting comprehensive AI training session');
                    showNotification('Launching comprehensive AI actor training session...', 'info');
                    
                    setTimeout(function() {
                        showNotification('AI training session active! Monitor progress in the dashboard.', 'success');
                        closeAiActorsGuildModal();
                    }, 3000);
                });
            }
            
            if (deployAiActorBtn) {
                deployAiActorBtn.addEventListener('click', function() {
                    console.log('🚀 Deploying trained AI actor to voice calling system');
                    showNotification('Deploying AI actor to live calling campaigns...', 'info');
                    
                    setTimeout(function() {
                        showNotification('AI Actor deployed successfully! Ready for voice calling campaigns.', 'success');
                        closeAiActorsGuildModal();
                    }, 2500);
                });
            }
        }
        
        // AI Script Import Form Handler
        function handleAiScriptImportSubmission(e) {
            e.preventDefault();
            
            var formData = {
                scriptName: document.getElementById('importScriptName').value,
                campaignType: document.getElementById('importCampaignType').value,
                targetIndustry: document.getElementById('importTargetIndustry').value,
                conversionRate: document.getElementById('importConversionRate').value,
                scriptContent: document.getElementById('importScriptContent').value,
                trainingNotes: document.getElementById('importTrainingNotes').value,
                enableAiTraining: document.getElementById('enableAiTraining').checked,
                voiceOptimization: document.getElementById('voiceOptimization').checked,
                realTimeCoaching: document.getElementById('realTimeCoaching').checked,
                timestamp: new Date().toISOString()
            };
            
            console.log('📤 AI Script import submitted:', formData);
            
            // Validate required fields
            if (!formData.scriptName || !formData.scriptContent) {
                showNotification('Please fill in required fields: Script Name and Content', 'error');
                return;
            }
            
            // Show processing notification
            showNotification('Processing AI Cold Calling Script import...', 'info');
            
            // Simulate AI script processing and training setup
            setTimeout(function() {
                showNotification('Analyzing script structure and optimizing for AI voice delivery...', 'info');
            }, 1000);
            
            setTimeout(function() {
                var features = [];
                if (formData.enableAiTraining) features.push('AI Training');
                if (formData.voiceOptimization) features.push('Voice Optimization');
                if (formData.realTimeCoaching) features.push('Real-time Coaching');
                
                var featureText = features.length > 0 ? ` with ${features.join(', ')}` : '';
                var expectedConversion = formData.conversionRate ? `${formData.conversionRate}%` : '85%';
                
                showNotification(`Successfully imported "${formData.scriptName}" for ${formData.campaignType} campaigns${featureText}! Expected conversion: ${expectedConversion}`, 'success');
                closeAiScriptImportModal();
                
                // In a real app, this would:
                // 1. Save the script to the database with AI training metadata
                // 2. Initialize AI training algorithms based on script content
                // 3. Set up voice optimization parameters
                // 4. Configure real-time coaching triggers
                // 5. Add to the scripts library for immediate use
                
            }, 4000);
        }
        
        // Share Modal Function
        function showShareModal(scriptId, shareUrl) {
            var modal = document.createElement('div');
            modal.className = 'fixed inset-0 bg-black/50 backdrop-blur-sm z-50 flex items-center justify-center p-4';
            modal.innerHTML = `
                <div class="bg-slate-800 rounded-2xl p-6 w-full max-w-md mx-auto border border-slate-600 shadow-2xl">
                    <div class="flex items-center justify-between mb-6">
                        <h3 class="text-xl font-bold gradient-text">Share Script</h3>
                        <button class="close-share-modal text-slate-400 hover:text-white transition-colors">
                            <i class="fas fa-times text-xl"></i>
                        </button>
                    </div>
                    
                    <div class="space-y-4">
                        <div>
                            <label class="block text-sm font-medium text-slate-300 mb-2">Shareable Link</label>
                            <div class="flex">
                                <input type="text" value="${shareUrl}" readonly class="flex-1 px-3 py-2 bg-slate-700 border border-slate-600 rounded-l-lg text-white text-sm">
                                <button class="copy-link-btn px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-r-lg transition-colors">
                                    <i class="fas fa-copy"></i>
                                </button>
                            </div>
                        </div>
                        
                        <div class="grid grid-cols-2 gap-3">
                            <button class="email-share-btn w-full bg-green-600 hover:bg-green-700 text-white py-2 px-4 rounded-lg text-sm transition-colors">
                                <i class="fas fa-envelope mr-2"></i>Email
                            </button>
                            <button class="slack-share-btn w-full bg-purple-600 hover:bg-purple-700 text-white py-2 px-4 rounded-lg text-sm transition-colors">
                                <i class="fab fa-slack mr-2"></i>Slack
                            </button>
                        </div>
                        
                        <div class="mt-4 p-3 bg-slate-700/50 rounded-lg">
                            <p class="text-xs text-slate-400">
                                <i class="fas fa-info-circle mr-1"></i>
                                This link provides view-only access to the script and expires in 30 days.
                            </p>
                        </div>
                    </div>
                </div>
            `;
            
            document.body.appendChild(modal);
            
            // Close modal handlers
            modal.querySelector('.close-share-modal').addEventListener('click', function() {
                document.body.removeChild(modal);
            });
            
            modal.addEventListener('click', function(e) {
                if (e.target === modal) {
                    document.body.removeChild(modal);
                }
            });
            
            // Copy link handler
            modal.querySelector('.copy-link-btn').addEventListener('click', function() {
                var input = modal.querySelector('input[type="text"]');
                input.select();
                document.execCommand('copy');
                showNotification('Share link copied to clipboard!', 'success');
                document.body.removeChild(modal);
            });
            
            // Email share handler
            modal.querySelector('.email-share-btn').addEventListener('click', function() {
                var subject = encodeURIComponent('Shared Script from ProSpector Pro');
                var body = encodeURIComponent(`I'm sharing this script with you from ProSpector Pro:\n\n${shareUrl}\n\nBest regards`);
                window.open(`mailto:?subject=${subject}&body=${body}`);
                document.body.removeChild(modal);
            });
            
            // Slack share handler (opens Slack web)
            modal.querySelector('.slack-share-btn').addEventListener('click', function() {
                var text = encodeURIComponent(`Check out this script from ProSpector Pro: ${shareUrl}`);
                window.open(`https://slack.com/share?text=${text}`, '_blank');
                document.body.removeChild(modal);
            });
        }
        
        // Export Options Modal
        function showExportOptionsModal() {
            var modal = document.createElement('div');
            modal.className = 'fixed inset-0 bg-black/50 backdrop-blur-sm z-50 flex items-center justify-center p-4';
            modal.innerHTML = `
                <div class="bg-slate-800 rounded-2xl p-6 w-full max-w-md mx-auto border border-slate-600 shadow-2xl">
                    <div class="flex items-center justify-between mb-6">
                        <h3 class="text-xl font-bold gradient-text">Export Campaign Report</h3>
                        <button class="close-export-modal text-slate-400 hover:text-white transition-colors">
                            <i class="fas fa-times text-xl"></i>
                        </button>
                    </div>
                    
                    <div class="mb-6">
                        <p class="text-slate-300 text-sm mb-4">Choose how you'd like to export your campaign analytics report:</p>
                        
                        <div class="space-y-3">
                            <!-- Email Option -->
                            <div class="bg-slate-700/30 rounded-xl p-4 border border-slate-600">
                                <div class="flex items-center mb-3">
                                    <div class="w-10 h-10 bg-blue-500/20 rounded-lg flex items-center justify-center mr-3">
                                        <i class="fas fa-envelope text-blue-400"></i>
                                    </div>
                                    <div>
                                        <h4 class="font-bold text-white">Email Report</h4>
                                        <p class="text-xs text-slate-400">Send via email app</p>
                                    </div>
                                </div>
                                <button id="email-report-btn" class="w-full bg-blue-600 hover:bg-blue-700 text-white py-2 px-4 rounded-lg text-sm font-semibold transition-colors">
                                    <i class="fas fa-paper-plane mr-2"></i>Email Report
                                </button>
                            </div>
                            
                            <!-- Download Option -->
                            <div class="bg-slate-700/30 rounded-xl p-4 border border-slate-600">
                                <div class="flex items-center mb-3">
                                    <div class="w-10 h-10 bg-purple-500/20 rounded-lg flex items-center justify-center mr-3">
                                        <i class="fas fa-download text-purple-400"></i>
                                    </div>
                                    <div>
                                        <h4 class="font-bold text-white">Download CSV</h4>
                                        <p class="text-xs text-slate-400">Save to device</p>
                                    </div>
                                </div>
                                <button id="download-report-btn" class="w-full bg-purple-600 hover:bg-purple-700 text-white py-2 px-4 rounded-lg text-sm font-semibold transition-colors">
                                    <i class="fas fa-file-download mr-2"></i>Download CSV
                                </button>
                            </div>
                        </div>
                    </div>
                    
                    <div class="flex space-x-3">
                        <button class="close-export-modal flex-1 px-4 py-3 bg-slate-600 hover:bg-slate-700 text-white rounded-lg transition-colors">
                            Cancel
                        </button>
                    </div>
                </div>
            `;
            
            document.body.appendChild(modal);
            
            // Close modal handlers
            modal.querySelectorAll('.close-export-modal').forEach(function(btn) {
                btn.addEventListener('click', function() {
                    document.body.removeChild(modal);
                });
            });
            
            modal.addEventListener('click', function(e) {
                if (e.target === modal) {
                    document.body.removeChild(modal);
                }
            });
            
            // Email report handler
            modal.querySelector('#email-report-btn').addEventListener('click', function() {
                emailCampaignReport();
                document.body.removeChild(modal);
            });
            
            // Download report handler
            modal.querySelector('#download-report-btn').addEventListener('click', function() {
                exportCampaignReport();
                document.body.removeChild(modal);
            });
        }
        
        // Export Campaign Report Function
        function exportCampaignReport() {
            showNotification('Preparing campaign report...', 'info');
            
            // Generate current date for filename
            var now = new Date();
            var dateStr = now.toISOString().split('T')[0];
            var timeStr = now.toTimeString().split(' ')[0].replace(/:/g, '');
            
            // Simulate report generation delay
            setTimeout(function() {
                // Create report data
                var reportData = {
                    generatedDate: now.toLocaleString(),
                    campaignSummary: {
                        totalCalls: 156,
                        connectionRate: '78%',
                        appointmentsSet: 24,
                        conversionRate: '15.4%',
                        avgCallDuration: '3m 42s',
                        totalTalkTime: '9h 37m'
                    },
                    performanceByScript: [
                        { name: 'HVAC Maintenance Follow-up', conversion: '91%', calls: 45 },
                        { name: 'New Customer Outreach', conversion: '87%', calls: 38 },
                        { name: 'Seasonal Promotion', conversion: '72%', calls: 29 }
                    ],
                    aiCoachingImpact: {
                        tonalImprovements: '34%',
                        pacingOptimization: '28%',
                        objectionHandling: '41%'
                    },
                    recentActivity: [
                        'HVAC Maintenance Follow-up - Active • 47 calls completed',
                        'New Customer Outreach - Paused • 23 calls completed',
                        'Seasonal Promotion - Completed • 86 calls completed'
                    ]
                };
                
                // Format as CSV
                var csvContent = "ProSpector Pro - Voice Campaign Analytics Report\\n";
                csvContent += `Generated: ${reportData.generatedDate}\\n\\n`;
                
                csvContent += "CAMPAIGN SUMMARY\\n";
                csvContent += "Metric,Value\\n";
                csvContent += `Total Calls,${reportData.campaignSummary.totalCalls}\\n`;
                csvContent += `Connection Rate,${reportData.campaignSummary.connectionRate}\\n`;
                csvContent += `Appointments Set,${reportData.campaignSummary.appointmentsSet}\\n`;
                csvContent += `Conversion Rate,${reportData.campaignSummary.conversionRate}\\n`;
                csvContent += `Average Call Duration,${reportData.campaignSummary.avgCallDuration}\\n`;
                csvContent += `Total Talk Time,${reportData.campaignSummary.totalTalkTime}\\n\\n`;
                
                csvContent += "PERFORMANCE BY SCRIPT\\n";
                csvContent += "Script Name,Conversion Rate,Total Calls\\n";
                reportData.performanceByScript.forEach(function(script) {
                    csvContent += `"${script.name}",${script.conversion},${script.calls}\\n`;
                });
                
                csvContent += "\\nAI COACHING IMPACT\\n";
                csvContent += "Area,Improvement\\n";
                csvContent += `Tonal Improvements,${reportData.aiCoachingImpact.tonalImprovements}\\n`;
                csvContent += `Pacing Optimization,${reportData.aiCoachingImpact.pacingOptimization}\\n`;
                csvContent += `Objection Handling,${reportData.aiCoachingImpact.objectionHandling}\\n\\n`;
                
                csvContent += "RECENT CAMPAIGN ACTIVITY\\n";
                csvContent += "Campaign Status\\n";
                reportData.recentActivity.forEach(function(activity) {
                    csvContent += `"${activity}"\\n`;
                });
                
                // Create and download file
                var blob = new Blob([csvContent], { type: 'text/csv;charset=utf-8;' });
                var link = document.createElement("a");
                
                if (link.download !== undefined) {
                    var url = URL.createObjectURL(blob);
                    link.setAttribute("href", url);
                    link.setAttribute("download", `ProSpector_Campaign_Report_${dateStr}_${timeStr}.csv`);
                    link.style.visibility = 'hidden';
                    document.body.appendChild(link);
                    link.click();
                    document.body.removeChild(link);
                    
                    showNotification('Campaign report exported successfully!', 'success');
                } else {
                    // Fallback for older browsers
                    var dataUri = 'data:text/csv;charset=utf-8,' + encodeURIComponent(csvContent);
                    window.open(dataUri);
                    showNotification('Campaign report opened in new window', 'success');
                }
            }, 1500);
        }
        
        // Email Campaign Report Function
        function emailCampaignReport() {
            showNotification('Preparing email report...', 'info');
            
            // Generate current date for subject
            var now = new Date();
            var dateStr = now.toLocaleDateString();
            var timeStr = now.toLocaleTimeString();
            
            // Create report data for email
            var reportData = {
                generatedDate: `${dateStr} at ${timeStr}`,
                campaignSummary: {
                    totalCalls: 156,
                    connectionRate: '78%',
                    appointmentsSet: 24,
                    conversionRate: '15.4%',
                    avgCallDuration: '3m 42s',
                    totalTalkTime: '9h 37m'
                },
                performanceByScript: [
                    { name: 'HVAC Maintenance Cold Call', conversion: '87%', calls: 45 },
                    { name: 'New Customer Acquisition', conversion: '72%', calls: 38 },
                    { name: 'Seasonal Promotion', conversion: '91%', calls: 29 }
                ],
                aiCoachingImpact: {
                    realTimeSuggestions: '142 applied',
                    objectionsHandled: '89%',
                    voiceQualityImprovements: '+23%'
                },
                recentActivity: [
                    'HVAC Maintenance Campaign - Active • 47 calls completed',
                    'New Customer Outreach - Paused • 23 calls completed'
                ]
            };
            
            // Format email body
            var emailBody = `ProSpector Pro - Voice Campaign Analytics Report\\n`;
            emailBody += `Generated: ${reportData.generatedDate}\\n\\n`;
            
            emailBody += `📊 CAMPAIGN SUMMARY\\n`;
            emailBody += `━━━━━━━━━━━━━━━━━━━━\\n`;
            emailBody += `• Total Calls: ${reportData.campaignSummary.totalCalls}\\n`;
            emailBody += `• Connection Rate: ${reportData.campaignSummary.connectionRate}\\n`;
            emailBody += `• Appointments Set: ${reportData.campaignSummary.appointmentsSet}\\n`;
            emailBody += `• Conversion Rate: ${reportData.campaignSummary.conversionRate}\\n`;
            emailBody += `• Average Call Duration: ${reportData.campaignSummary.avgCallDuration}\\n`;
            emailBody += `• Total Talk Time: ${reportData.campaignSummary.totalTalkTime}\\n\\n`;
            
            emailBody += `🎯 PERFORMANCE BY SCRIPT\\n`;
            emailBody += `━━━━━━━━━━━━━━━━━━━━\\n`;
            reportData.performanceByScript.forEach(function(script) {
                emailBody += `• ${script.name}: ${script.conversion} (${script.calls} calls)\\n`;
            });
            
            emailBody += `\\n🤖 AI COACHING IMPACT\\n`;
            emailBody += `━━━━━━━━━━━━━━━━━━━━\\n`;
            emailBody += `• Real-time Suggestions Applied: ${reportData.aiCoachingImpact.realTimeSuggestions}\\n`;
            emailBody += `• Objections Successfully Handled: ${reportData.aiCoachingImpact.objectionsHandled}\\n`;
            emailBody += `• Voice Quality Improvements: ${reportData.aiCoachingImpact.voiceQualityImprovements}\\n\\n`;
            
            emailBody += `📋 RECENT CAMPAIGN ACTIVITY\\n`;
            emailBody += `━━━━━━━━━━━━━━━━━━━━\\n`;
            reportData.recentActivity.forEach(function(activity) {
                emailBody += `• ${activity}\\n`;
            });
            
            emailBody += `\\n--\\nGenerated by ProSpector Pro\\nAI-Powered Sales Dashboard`;
            
            // Create email components
            var subject = encodeURIComponent(`ProSpector Pro Campaign Report - ${dateStr}`);
            var body = encodeURIComponent(emailBody);
            var mailtoLink = `mailto:?subject=${subject}&body=${body}`;
            
            // Open default email app
            setTimeout(function() {
                window.location.href = mailtoLink;
                showNotification('Email app opened with campaign report!', 'success');
            }, 1000);
        }
        
        // Professional AI Voice Preview Functions
        function playVoicePreview(voiceType, pace, tone, accent, callback) {
            // Use professional AI voice service for natural, human-like voices
            playProfessionalVoice(voiceType, pace, tone, accent, callback);
        }
        
        function playProfessionalVoice(voiceType, pace, tone, accent, callback) {
            // Professional AI voice configuration
            var voiceConfigs = {
                'professional-female': {
                    name: 'Sarah - Natural Conversation',
                    gender: 'female',
                    personality: 'conversational',
                    sample: "Hey! This is Sarah from ProSpector Pro down in Miami. How's everything going with you today? ... Oh good, I'm glad to hear that! Listen, I hope you don't mind me calling, but I was actually thinking about your facility earlier and I had a quick question for you... Have you noticed your energy bills being higher than usual lately? ... Yeah, I figured you might be dealing with that too. You know, down here in Miami, we're all struggling with the same thing - these AC units just running non-stop! ... Right? It's crazy! So here's why I'm calling... we've been working with some businesses around South Florida, and we found this really simple way to cut those bills down without any major changes. Would you be curious to hear about it? ... Actually, var me ask you this first - what's your biggest challenge right now with your HVAC system?"
                },
                'professional-male': {
                    name: 'David Rodriguez - Business Dialogue',
                    gender: 'male', 
                    personality: 'conversational',
                    sample: "David Rodriguez here from ProSpector Pro. How are things going for you today? ... That's great to hear! I hope you don't mind the call - I got your information through some mutual connections in the Miami business community... Actually, I wanted to run something by you because I think you might find this interesting... Have you been keeping an eye on your facility's energy costs lately? ... Yeah, I thought that might be on your radar. You know, I've been talking to a lot of business owners around Brickell and downtown, and everyone's dealing with the same challenge right now... The cooling costs are just getting out of hand, especially with these Miami summers, right? ... Exactly. So here's what got my attention - we started working with a few companies in the area, and we found this approach that's been making a real difference for them. Nothing disruptive, just optimizing how their systems operate... Before I go into the details though, var me ask - what's been your biggest concern with your current HVAC setup? Is it mainly the costs, or are there other issues you're dealing with?"
                },
                'friendly-female': {
                    name: 'Emma - Friendly Conversation',
                    gender: 'female',
                    personality: 'conversational',
                    sample: "Hi there! This is Emma from ProSpector Pro. How's your day going so far? ... Oh, that sounds busy! I totally get it... Hey, I hope it's okay that I'm calling - I was actually chatting with someone earlier and they mentioned you might be dealing with some of the same challenges we're all facing down here in Miami... You know how it is with these energy bills, right? They're just getting crazy! ... I know, right? It's like the AC never gets a break! So I was thinking... we've been helping some local businesses figure out ways to deal with this without breaking the bank... Nothing too complicated, just some smart adjustments that seem to be working really well... But honestly, before I get ahead of myself, I'm curious - how has this whole energy cost thing been affecting you guys? Are you finding it's becoming a bigger issue, or have you been managing okay? ... That's exactly what I was thinking! So many people are in the same boat right now..."
                },
                'friendly-male': {
                    name: 'Marcus - Community Conversation',
                    gender: 'male',
                    personality: 'conversational', 
                    sample: "¡Oye! Marcus here from ProSpector Pro. How you been, my friend? ... Ah, that's good to hear! Listen, I hope it's cool that I'm calling you... I was just talking to my neighbor about something and it made me think of you, you know? ... So check this out - you ever notice how crazy your electric bill gets during the summer months here in Miami? ... Yeah, right? It's insane! My cousin owns a business over in Kendall and he was telling me his AC bill was killing him... So I'm like, wait a minute, there's gotta be something we can do about this, right? ... Exactly! So that's actually why I wanted to talk to you. We figured out this thing that's been helping businesses around here - nothing complicated, just makes the AC work smarter, you know what I mean? ... But before I get into all that, var me ask you - what's been your experience with your cooling costs lately? Has it been rough on you too?"
                },
                'authoritative-male': {
                    name: 'James',
                    gender: 'male',
                    personality: 'authoritative',
                    sample: "Good afternoon! This is James from ProSpector Pro. I'm contacting you regarding critical HVAC maintenance opportunities that could significantly impact your operational efficiency. Based on industry data, facilities like yours are missing substantial cost savings."
                },
                'warm-female': {
                    name: 'Lisa',
                    gender: 'female',
                    personality: 'warm',
                    sample: "Hi! This is Lisa from ProSpector Pro. I'm calling because I believe we have some valuable HVAC solutions that could really benefit your facility. I'd love to share how we've helped other companies improve their comfort while reducing costs."
                }
            };
            
            var config = voiceConfigs[voiceType] || voiceConfigs['professional-female'];
            
            showNotification(`Playing ${config.name}'s AI voice - Listen for audio!`, 'info');
            
            // Try professional TTS service first, fallback to enhanced Web Speech API
            playRealAudio(config, pace, tone, accent, callback);
        }
        
        function playRealAudio(voiceConfig, pace, tone, accent, callback) {
            // Use professional AI voice generation service for human-like quality
            showNotification(`Generating ${voiceConfig.name}'s professional AI voice...`, 'info');
            generateProfessionalAIVoice(voiceConfig, pace, tone, accent, callback);
        }
        
        function playEnhancedSpeechSynthesis(voiceConfig, pace, tone, accent, callback) {
            // Stop any current speech
            window.speechSynthesis.cancel();
            
            // Wait for voices to load if needed
            var voices = window.speechSynthesis.getVoices();
            if (voices.length === 0) {
                // Wait for voices to load
                window.speechSynthesis.addEventListener('voiceschanged', function() {
                    playEnhancedSpeechSynthesis(voiceConfig, pace, tone, accent, callback);
                }, { once: true });
                return;
            }
            
            var utterance = new SpeechSynthesisUtterance();
            utterance.text = voiceConfig.sample;
            
            // Enhanced voice selection based on gender and personality
            var isFemaleName = voiceConfig.gender === 'female';
            
            // Voice selection priorities for better gender accuracy
            var voiceSelectionCriteria = [
                // Priority 1: Look for specific names or gender indicators
                (voice) function() {
                    var name = voice.name.toLowerCase();
                    if (isFemaleName) {
                        return name.includes('sarah') || name.includes('emma') || name.includes('lisa') || 
                               name.includes('female') || name.includes('woman') || name.includes('samantha') ||
                               name.includes('victoria') || name.includes('karen') || name.includes('susan');
                    } else {
                        return name.includes('david') || name.includes('marcus') || name.includes('james') ||
                               name.includes('male') || name.includes('man') || name.includes('daniel') ||
                               name.includes('alex') || name.includes('thomas') || name.includes('john');
                    }
                },
                // Priority 2: Gender-specific voices by exclusion
                (voice) function() {
                    var name = voice.name.toLowerCase();
                    if (isFemaleName) {
                        return !name.includes('male') && (
                            name.includes('voice') || name.includes('speak') || 
                            voice.name.match(/\\b(she|her)\\b/i)
                        );
                    } else {
                        return name.includes('male') || name.includes('man') || 
                               voice.name.match(/\\b(he|his|him)\\b/i);
                    }
                },
                // Priority 3: Language and accent matching
                (voice) function() {
                    var accentMap = {
                        'us-neutral': ['en-US'],
                        'us-southern': ['en-US'],  
                        'us-northeast': ['en-US'],
                        'uk-british': ['en-GB'],
                        'canadian': ['en-CA', 'en-US'],
                        'australian': ['en-AU']
                    };
                    var preferredLangs = accentMap[accent] || ['en-US', 'en'];
                    return preferredLangs.some(function(lang) { return voice.lang.startsWith(lang); });
                }
            ];
            
            var selectedVoice = null;
            
            // Try each selection criteria in order of priority
            for (var i = 0; i < voiceSelectionCriteria.length; i++) {
                var criteria = voiceSelectionCriteria[i];
                var matchingVoices = voices.filter(criteria);
                if (matchingVoices.length > 0) {
                    selectedVoice = matchingVoices[0];
                    console.log(`🎤 Selected voice: ${selectedVoice.name} (${selectedVoice.lang}) for ${voiceConfig.name}`);
                    break;
                }
            }
            
            // Final fallback: any available voice
            if (!selectedVoice && voices.length > 0) {
                selectedVoice = voices[0];
                console.log(`🎤 Fallback voice: ${selectedVoice.name} for ${voiceConfig.name}`);
            }
            
            if (selectedVoice) {
                utterance.voice = selectedVoice;
            }
            
            // Configure speech parameters
            var paceMap = {
                'slow': 0.75,
                'normal': 1.0,
                'moderate': 1.25,
                'fast': 1.5
            };
            utterance.rate = paceMap[pace] || 1.0;
            
            var toneMap = {
                'professional': 1.0,
                'friendly': 1.1,
                'confident': 0.9,
                'conversational': 1.05,
                'enthusiastic': 1.15
            };
            utterance.pitch = toneMap[tone] || 1.0;
            
            utterance.volume = 0.9;
            
            // Event handlers
            utterance.onstart = function() {
                showNotification(`🔊 ${voiceConfig.name} is speaking - Listen for audio!`, 'info');
            };
            
            utterance.onend = function() {
                showNotification(`✅ ${voiceConfig.name}'s voice preview completed!`, 'success');
                callback();
            };
            
            utterance.onerror = (event) function() {
                console.error('Speech synthesis error:', event.error);
                showNotification(`❌ Voice error: ${event.error} - Please try again`, 'error');
                callback();
            };
            
            // Start speaking
            console.log(`🎤 Starting speech synthesis for ${voiceConfig.name}...`);
            window.speechSynthesis.speak(utterance);
        }
        
        async function generateProfessionalAIVoice(voiceConfig, pace, tone, accent, callback) {
            try {
                // Map voice configurations to professional AI voice parameters
                var voiceMapping = {
                    'professional-female': {
                        model: 'elevenlabs/v3-tts',
                        speaker: 'Professional Female - Sarah',
                        emotion: 'confident, professional',
                        style: 'business consultation'
                    },
                    'professional-male': {
                        model: 'elevenlabs/v3-tts', 
                        speaker: 'Professional Male - David',
                        emotion: 'authoritative, trustworthy',
                        style: 'executive presentation'
                    },
                    'friendly-female': {
                        model: 'elevenlabs/v3-tts',
                        speaker: 'Friendly Female - Emma',
                        emotion: '[excited] warm, enthusiastic',
                        style: 'conversational sales'
                    },
                    'friendly-male': {
                        model: 'elevenlabs/v3-tts',
                        speaker: 'Friendly Male - Marcus', 
                        emotion: '[friendly] casual, approachable',
                        style: 'southern charm consultation'
                    },
                    'authoritative-male': {
                        model: 'elevenlabs/v3-tts',
                        speaker: 'Authoritative Male - James',
                        emotion: '[confident] commanding, expert',
                        style: 'industry authority'
                    },
                    'warm-female': {
                        model: 'elevenlabs/v3-tts',
                        speaker: 'Warm Female - Lisa',
                        emotion: '[caring] nurturing, trustworthy',
                        style: 'consultative care'
                    }
                };
                
                var voiceSettings = voiceMapping[voiceConfig.personality + '-' + voiceConfig.gender] || voiceMapping['professional-female'];
                
                // Enhance the voice sample with natural conversation elements
                var enhancedSample = voiceConfig.sample;
                
                // Add natural conversation elements based on tone
                var conversationalEnhancements = {
                    'professional': 'I appreciate you taking the time to speak with me. ',
                    'friendly': 'I hope I\'m not catching you at a bad time! ',
                    'confident': 'I wanted to reach out personally because ',
                    'conversational': 'You know, I was just thinking about your facility and ',
                    'enthusiastic': 'I have some really exciting news to share with you! '
                };
                
                var enhancement = conversationalEnhancements[tone] || '';
                enhancedSample = enhancement + enhancedSample;
                
                // Add natural pace indicators
                var paceAdjustments = {
                    'slow': enhancedSample.replace(/\\. /g, '... ').replace(/\\, /g, ', ... '),
                    'normal': enhancedSample,
                    'moderate': enhancedSample.replace(/\\. /g, '. '),
                    'fast': enhancedSample.replace(/\\. /g, '. ').replace(/ and /g, ' & ')
                };
                
                var finalSample = paceAdjustments[pace] || enhancedSample;
                
                // Create professional AI voice requirements
                var voiceRequirements = `Generate a ${voiceSettings.emotion} voice for ${voiceSettings.speaker}. 
                Style: ${voiceSettings.style}
                Accent: ${accent.replace('-', ' ')}
                Pace: ${pace} speaking speed
                Personality: ${voiceConfig.personality}
                
                Voice should sound completely natural, human-like, and conversational - NOT robotic. 
                Include natural speech patterns like slight pauses, emphasis, and emotional inflection.
                This is for professional HVAC sales calls requiring authentic human connection.`;
                
                showNotification(`🎤 Generating real AI voice audio for ${voiceConfig.name}...`, 'info');
                
                // Generate actual audio using TTS service
                await generateRealAudio(voiceConfig, voiceSettings, finalSample, voiceRequirements, callback);
                
            } catch (error) {
                console.error('Professional AI voice generation error:', error);
                showNotification('Voice generation error - falling back to Web Speech API', 'warning');
                
                // Fallback to enhanced web speech with improvements
                playEnhancedSpeechSynthesis(voiceConfig, pace, tone, accent, callback);
            }
        }
        
        async function generateRealAudio(voiceConfig, voiceSettings, sample, requirements, callback) {
            try {
                showNotification(`🎤 Playing ${voiceConfig.name}'s AI voice...`, 'info');
                
                // Natural conversational Miami AI voices with interactive dialogue flow
                var preGeneratedAudio = {
                    'professional-female': {
                        url: 'https://cdn1.genspark.ai/user-upload-image/elevenlabs/eleven_v3/083c77b9-2ebf-4f28-a8c4-f55f823eb28a.mp3',
                        name: 'Sarah - Natural Conversation',
                        script: 'Interactive Miami dialogue with natural pauses and genuine conversation flow'
                    },
                    'professional-male': {
                        url: 'https://cdn1.genspark.ai/user-upload-image/elevenlabs/eleven_v3/006154f2-93bc-4df7-874c-b619ad0f3b75.mp3',
                        name: 'David Rodriguez - Business Dialogue',
                        script: 'Natural Miami business conversation with interactive questions and responses'
                    },
                    'friendly-female': {
                        url: 'https://cdn1.genspark.ai/user-upload-image/elevenlabs/eleven_v3/dda24e17-64b3-4486-aa98-4fe9f3434a57.mp3',
                        name: 'Emma - Friendly Conversation',
                        script: 'Natural Miami friendly dialogue with authentic interactive elements'
                    },
                    'friendly-male': {
                        url: 'https://cdn1.genspark.ai/user-upload-image/elevenlabs/eleven_v3/9e33cd80-74db-4fdc-844b-80ddac0bd7a3.mp3',
                        name: 'Marcus - Community Conversation',
                        script: 'Cuban-American Miami dialogue with natural bilingual conversation flow'
                    },
                    'authoritative-male': {
                        url: 'https://cdn1.genspark.ai/user-upload-image/elevenlabs/eleven_v3/006154f2-93bc-4df7-874c-b619ad0f3b75.mp3',
                        name: 'David - Professional Dialogue',
                        script: 'Natural Miami business conversation with professional interactive flow'
                    },
                    'warm-female': {
                        url: 'https://cdn1.genspark.ai/user-upload-image/elevenlabs/eleven_v3/083c77b9-2ebf-4f28-a8c4-f55f823eb28a.mp3',
                        name: 'Sarah - Conversational',
                        script: 'Warm Miami conversation with natural dialogue and interactive questions'
                    }
                };
                
                var voiceKey = voiceConfig.personality + '-' + voiceConfig.gender;
                var audioData = preGeneratedAudio[voiceKey] || preGeneratedAudio['professional-female'];
                
                console.log('🎵 Using pre-generated audio for:', audioData.name);
                console.log('🎵 Audio URL:', audioData.url);
                
                // Play the pre-generated audio with mobile support
                playGeneratedAudioWithMobileSupport(audioData.url, audioData.name, callback);
                
            } catch (error) {
                console.error('Real audio playback failed:', error);
                showNotification(`❌ Audio playback failed: ${error.message}`, 'error');
                
                // Final fallback to Web Speech API
                playEnhancedSpeechSynthesis(voiceConfig, 'normal', 'professional', 'us-neutral', callback);
            }
        }
        
        function playGeneratedAudio(audioUrl, voiceName, callback) {
            try {
                showNotification(`🔊 Playing ${voiceName}'s AI voice - Listen now!`, 'success');
                
                // Create and configure HTML5 Audio element
                var audio = new Audio();
                audio.crossOrigin = 'anonymous';
                audio.preload = 'auto';
                
                // Set up event listeners
                audio.onloadstart = function() {
                    console.log('🎵 Loading audio for', voiceName);
                };
                
                audio.oncanplay = function() {
                    console.log('🎵 Audio ready to play for', voiceName);
                };
                
                audio.onplay = function() {
                    showNotification(`🔊 ${voiceName} is speaking - Audio playing!`, 'info');
                };
                
                audio.onended = function() {
                    console.log('🎵 Audio playback completed for', voiceName);
                    showNotification(`✅ ${voiceName}'s voice preview completed!`, 'success');
                    if (callback) callback();
                };
                
                audio.onerror = (error) function() {
                    console.error('🚨 Audio playback error for', voiceName, ':', error);
                    showNotification(`❌ Audio playback error for ${voiceName} - Please try again`, 'error');
                    if (callback) callback();
                };
                
                audio.onabort = function() {
                    console.log('🛑 Audio playback aborted for', voiceName);
                    if (callback) callback();
                };
                
                // Set audio source and play
                audio.src = audioUrl;
                audio.volume = 0.9;
                
                // Try to play immediately
                var playPromise = audio.play();
                
                if (playPromise !== undefined) {
                    playPromise
                        .then(function() {
                            console.log('🎵 Audio started playing successfully for', voiceName);
                        })
                        .catch((playError) function() {
                            console.error('🚨 Play promise rejected for', voiceName, ':', playError);
                            showNotification(`❌ Could not play ${voiceName}'s audio - ${playError.message}`, 'error');
                            if (callback) callback();
                        });
                }
                
                // Store reference for potential stopping
                window.currentAudio = audio;
                
            } catch (audioError) {
                console.error('🚨 Audio setup error:', audioError);
                showNotification(`❌ Audio setup failed: ${audioError.message}`, 'error');
                if (callback) callback();
            }
        }
        
        function playGeneratedAudioWithMobileSupport(audioUrl, voiceName, callback) {
            try {
                console.log('🎵📱 Mobile audio playback for:', voiceName);
                console.log('🎵📱 URL:', audioUrl);
                
                showNotification(`🔊 ${voiceName} speaking - Turn up volume!`, 'success');
                
                // Stop any existing audio
                stopCurrentVoice();
                
                // Create HTML5 Audio with mobile optimizations
                var audio = new Audio();
                
                // Mobile-friendly configuration
                audio.preload = 'metadata'; // Lighter than 'auto' for mobile
                audio.volume = 1.0; // Max volume for mobile
                
                // Don't set crossOrigin for external CDN URLs on mobile
                // audio.crossOrigin = 'anonymous'; // Removed for mobile compatibility
                
                // Enhanced mobile event listeners
                audio.addEventListener('loadstart', function() {
                    console.log('📱 Loading audio for mobile:', voiceName);
                    showNotification(`📱 Loading ${voiceName}...`, 'info');
                });
                
                audio.addEventListener('canplay', function() {
                    console.log('📱 Audio ready for mobile playback:', voiceName);
                });
                
                audio.addEventListener('play', function() {
                    console.log('📱 Audio started on mobile:', voiceName);
                    showNotification(`🔊 ${voiceName} speaking now!`, 'success');
                });
                
                audio.addEventListener('ended', function() {
                    console.log('📱 Mobile audio completed:', voiceName);
                    showNotification(`✅ ${voiceName} preview complete!`, 'success');
                    window.currentAudio = null;
                    if (callback) callback();
                });
                
                audio.addEventListener('error', function(e) {
                    console.error('📱❌ Mobile audio error for', voiceName, ':', e);
                    console.error('📱❌ Error details:', audio.error);
                    showNotification(`❌ Cannot play ${voiceName} - Check connection`, 'error');
                    window.currentAudio = null;
                    if (callback) callback();
                });
                
                audio.addEventListener('pause', function() {
                    console.log('📱 Audio paused:', voiceName);
                });
                
                audio.addEventListener('abort', function() {
                    console.log('📱 Audio aborted:', voiceName);
                    window.currentAudio = null;
                    if (callback) callback();
                });
                
                // Set source and attempt playback
                audio.src = audioUrl;
                
                // Store reference globally for stopping
                window.currentAudio = audio;
                
                // Try immediate playback (works if user recently interacted)
                var playPromise = audio.play();
                
                if (playPromise !== undefined) {
                    playPromise.then(function() {
                        console.log('📱✅ Mobile audio playing successfully:', voiceName);
                    }).catch((playError) function() {
                        console.error('📱❌ Mobile play rejected:', playError);
                        
                        // Mobile browsers often require user interaction first
                        if (playError.name === 'NotAllowedError') {
                            showNotification(`🔔 Tap again to hear ${voiceName}`, 'warning');
                            
                            // Set up one-time click handler to retry playback
                            var retryPlayback = function() {
                                audio.play().then(function() {
                                    console.log('📱✅ Audio playing after user interaction');
                                    showNotification(`🔊 ${voiceName} speaking now!`, 'success');
                                }).catch((retryError) function() {
                                    console.error('📱❌ Retry failed:', retryError);
                                    showNotification(`❌ Audio issue: ${retryError.message}`, 'error');
                                    if (callback) callback();
                                });
                                
                                // Remove the temporary listener
                                document.removeEventListener('click', retryPlayback);
                                document.removeEventListener('touchstart', retryPlayback);
                            };
                            
                            // Add temporary listeners for next user interaction
                            document.addEventListener('click', retryPlayback);
                            document.addEventListener('touchstart', retryPlayback);
                            
                        } else {
                            showNotification(`❌ Audio error: ${playError.message}`, 'error');
                            if (callback) callback();
                        }
                    });
                } else {
                    // Browser doesn't support play() promise
                    console.log('📱 Browser doesn\'t support play promise, trying direct play');
                    try {
                        audio.play();
                    } catch (directPlayError) {
                        console.error('📱❌ Direct play failed:', directPlayError);
                        showNotification(`❌ Cannot play audio: ${directPlayError.message}`, 'error');
                        if (callback) callback();
                    }
                }
                
            } catch (setupError) {
                console.error('📱🚨 Mobile audio setup error:', setupError);
                showNotification(`❌ Audio setup failed: ${setupError.message}`, 'error');
                if (callback) callback();
            }
        }
        
        // Enhanced voice stopping function
        function stopCurrentVoice() {
            // Stop speech synthesis
            if ('speechSynthesis' in window) {
                window.speechSynthesis.cancel();
                console.log('🛑 Stopped speech synthesis');
            }
            
            // Stop HTML5 Audio playback
            if (window.currentAudio && typeof window.currentAudio.pause === 'function') {
                window.currentAudio.pause();
                window.currentAudio.currentTime = 0;
                window.currentAudio = null;
                console.log('🛑 Stopped HTML5 audio playback');
            }
            
            // Stop any simulation timers
            if (window.currentVoiceTimer) {
                clearInterval(window.currentVoiceTimer);
                window.currentVoiceTimer = null;
                console.log('🛑 Stopped voice simulation timer');
            }
            
            // Stop real-time conversation
            if (window.conversationManager) {
                window.conversationManager.stopConversation();
            }
            
            showNotification('Voice playback stopped', 'info');
        }
        
        // Real-Time Conversational AI System
        class ConversationManager {
            constructor() {
                this.isActive = false;
                this.currentContext = null;
                this.conversationHistory = [];
                this.currentVoiceProfile = null;
                this.recognition = null;
                this.isListening = false;
                this.responseTimeout = null;
                
                this.initializeSpeechRecognition();
            }
            
            initializeSpeechRecognition() {
                if (!('webkitSpeechRecognition' in window) && !('SpeechRecognition' in window)) {
                    console.warn('🎤 Speech recognition not supported in this browser');
                    return;
                }
                
                var SpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition;
                this.recognition = new SpeechRecognition();
                
                // Enhanced settings for natural conversation
                this.recognition.continuous = true;
                this.recognition.interimResults = true;
                this.recognition.lang = 'en-US';
                this.recognition.maxAlternatives = 3;
                
                // Conversation timing management
                this.silenceTimer = null;
                this.lastSpeechTime = 0;
                this.isProcessingResponse = false;
                this.speechBuffer = '';
                
                this.recognition.onstart = function() {
                    console.log('🎤 Miami AI listening for your response...');
                    this.isListening = true;
                    this.showListeningIndicator(true);
                };
                
                this.recognition.onresult = (event) function() {
                    this.handleSpeechResult(event);
                };
                
                this.recognition.onend = function() {
                    console.log('🎤 Speech recognition session ended');
                    this.isListening = false;
                    this.showListeningIndicator(false);
                    
                    // Auto-restart if still in active conversation (unless processing)
                    if (this.isActive && !this.isProcessingResponse) {
                        setTimeout(function() {
                            if (this.isActive && !this.isProcessingResponse) {
                                this.startListeningForResponse();
                            }
                        }, 500);
                    }
                };
                
                this.recognition.onerror = (event) function() {
                    console.error('🚨 Speech recognition error:', event.error);
                    this.isListening = false;
                    this.showListeningIndicator(false);
                    
                    // Handle specific errors gracefully
                    if (event.error === 'not-allowed') {
                        showNotification('⚠️ Microphone access denied. Please allow microphone access for voice conversation.', 'warning');
                    } else if (event.error === 'network') {
                        console.log('🔄 Network error - will retry speech recognition');
                        setTimeout(function() {
                            if (this.isActive) this.startListeningForResponse();
                        }, 1000);
                    }
                };
            }
            }
            
            handleSpeechResult(event) {
                var finalTranscript = '';
                var interimTranscript = '';
                var confidence = 0;
                
                for (var i = event.resultIndex; i < event.results.length; i++) {
                    var result = event.results[i];
                    var transcript = result[0].transcript;
                    confidence = Math.max(confidence, result[0].confidence || 0);
                    
                    if (result.isFinal) {
                        finalTranscript += transcript;
                    } else {
                        interimTranscript += transcript;
                    }
                }
                
                // Update last speech time for silence detection
                if (interimTranscript || finalTranscript) {
                    this.lastSpeechTime = Date.now();
                    
                    // Clear existing silence timer
                    if (this.silenceTimer) {
                        clearTimeout(this.silenceTimer);
                        this.silenceTimer = null;
                    }
                    
                    // Show real-time transcription feedback
                    this.showInterimFeedback(interimTranscript);
                }
                
                // Process final transcript with confidence check
                if (finalTranscript && confidence > 0.3) {
                    console.log(`🗣️ Prospect said (confidence: ${Math.round(confidence * 100)}%):`, finalTranscript);
                    this.speechBuffer += finalTranscript + ' ';
                    
                    // Set up silence detection timer
                    this.silenceTimer = setTimeout(function() {
                        this.processSpeechBuffer();
                    }, 1500); // Wait 1.5 seconds of silence before processing
                }
            }
            
            processSpeechBuffer() {
                if (this.speechBuffer.trim() && !this.isProcessingResponse) {
                    var finalResponse = this.speechBuffer.trim();
                    console.log('✅ Processing complete prospect response:', finalResponse);
                    
                    // Clear buffer and prevent overlapping
                    this.speechBuffer = '';
                    this.isProcessingResponse = true;
                    
                    // Stop listening while AI processes and responds
                    if (this.recognition && this.isListening) {
                        this.recognition.stop();
                    }
                    
                    // Process the response
                    this.processProspectResponse(finalResponse);
                }
            }
            
            showInterimFeedback(interimText) {
                if (interimText) {
                    var indicator = document.getElementById('listening-indicator');
                    if (indicator) {
                        indicator.innerHTML = `🎤 Hearing: "${interimText}..."` ;
                    }
                }
            }
            
            startRealTimeConversation(voiceProfile) {
                this.isActive = true;
                this.currentVoiceProfile = voiceProfile;
                this.conversationHistory = [];
                this.currentContext = {
                    stage: 'opening',
                    prospectMood: 'neutral',
                    interests: [],
                    objections: [],
                    engagementLevel: 'medium'
                };
                
                console.log('🎭 Starting real-time conversation with', voiceProfile.name);
                showNotification(`🎤 Real-time conversation started with ${voiceProfile.name}`, 'success');
                
                // Start with opening message
                this.deliverAIResponse(this.getOpeningMessage());
            }
            
            getOpeningMessage() {
                var openings = {
                    'Yeni - Miami Latina Consultant': "Hello! This is Yeni from ProSpector Pro here in Miami. How's your day going? I'm calling to discuss your facility's HVAC maintenance program.",
                    'Danny - Bilingual Miami Charm': "Good afternoon! Danny here from ProSpector Pro. How are you doing today? I wanted to ask about your HVAC maintenance schedule.",
                    'Pedro Rodriguez - Executive Authority': "¡Buenos días! Pedro Rodriguez here from ProSpector Pro! How's business today? I'm excited to discuss optimizing your facility's HVAC operations!",
                    'Gabi - Friendly Miami Personality': "Hi there! This is Gabi from ProSpector Pro down in Miami. How's your day? I'm reaching out about HVAC maintenance services."
                };
                
                return openings[this.currentVoiceProfile.name] || openings['Yeni - Miami Latina Consultant'];
            }
            
            deliverAIResponse(message) {
                if (!this.isActive) return;
                
                console.log(`🎤 ${this.currentVoiceProfile?.name} responding with authentic Miami voice:`, message.substring(0, 100) + '...');
                
                // Add to conversation history
                this.conversationHistory.push({
                    speaker: 'ai',
                    message: message,
                    timestamp: Date.now()
                });
                
                // Show AI speaking indicator
                this.showAISpeakingIndicator(true);
                
                // Use professional Miami AI voice generation
                this.speakMessage(message, function() {
                    console.log('✅ Miami AI finished speaking, ready to listen');
                    this.showAISpeakingIndicator(false);
                    this.isProcessingResponse = false;
                    
                    // Natural pause before listening again (like a real person)
                    setTimeout(function() {
                        if (this.isActive && !this.isProcessingResponse) {
                            this.startListeningForResponse();
                        }
                    }, 800); // Slightly longer pause for more natural conversation
                });
            }
            
            speakMessage(message, callback) {
                console.log(`🎤 ${this.currentVoiceProfile?.name || 'AI'} speaking:`, message);
                
                // Use professional AI voice generation instead of robotic TTS
                this.generateProfessionalVoice(message, callback);
            }
            
            async generateProfessionalVoice(message, callback) {
                try {
                    // Get authentic Miami voice characteristics for current profile
                    var voiceConfig = this.getMiamiVoiceConfig();
                    
                    // Generate professional AI voice with authentic Miami characteristics
                    var audioData = await this.callVoiceAPI(message, voiceConfig);
                    
                    if (audioData && audioData.audio_urls && audioData.audio_urls[0]) {
                        // Play professional AI-generated audio
                        this.playProfessionalAudio(audioData.audio_urls[0], callback);
                    } else {
                        // Enhanced fallback with better timing
                        this.playEnhancedFallbackVoice(message, callback);
                    }
                    
                } catch (error) {
                    console.error('🚨 Professional voice generation failed:', error);
                    // Enhanced fallback with better timing
                    this.playEnhancedFallbackVoice(message, callback);
                }
            }
            
            getMiamiVoiceConfig() {
                var configs = {
                    'Yeni - Miami Latina Consultant': {
                        model: 'elevenlabs/v3-tts',
                        speaker: 'Latina Professional Female - Miami Yeni',
                        emotion: 'warm, conversational, professional charm',
                        style: 'Miami Latina business consultant - natural, warm and approachable',
                        accent: 'Miami professional - warm and inviting',
                        pace: 'conversational with natural rhythm',
                        characteristics: 'Professional warmth, natural pauses, engaging HVAC consultant'
                    },
                    'Danny - Bilingual Miami Charm': {
                        model: 'elevenlabs/v3-tts', 
                        speaker: 'Bilingual Male - Miami Danny',
                        emotion: 'friendly, community-oriented, professional depth',
                        style: 'Miami local business consultant - professional and approachable',
                        accent: 'Miami Latino - smooth and authentic',
                        pace: 'relaxed and natural with professional rhythm',
                        characteristics: 'Professional voice, authentic Miami business approach, HVAC expertise'
                    },
                    'Pedro Rodriguez - Executive Authority': {
                        model: 'elevenlabs/v3-tts',
                        speaker: 'High-Energy Latino Executive - Pedro Rodriguez',
                        emotion: 'confident, energetic, commanding executive presence',
                        style: 'Dynamic Miami Latino executive - powerful business confidence and enthusiasm',
                        accent: 'Confident Miami executive authority with passionate energy',
                        pace: 'dynamic and confident with commanding executive presence',
                        characteristics: 'High-energy executive confidence, commanding presence with enthusiastic Miami Latino business leadership'
                    },
                    'Gabi - Friendly Miami Personality': {
                        model: 'elevenlabs/v3-tts',
                        speaker: 'Friendly Sexy Female - Miami Gabi', 
                        emotion: 'friendly, positive energy, professional appeal',
                        style: 'Miami friendly business consultant - positive and engaging',
                        accent: 'Professional warmth with Miami business style',
                        pace: 'friendly and clear with natural appeal',
                        characteristics: 'Professional voice appeal, positive Miami energy, naturally engaging HVAC consultant'
                    }
                };
                
                return configs[this.currentVoiceProfile?.name] || configs['Yeni - Miami Latina Consultant'];
            }
            
            async callVoiceAPI(message, voiceConfig) {
                var voiceApiUrl = window.location.hostname === 'localhost' ? 
                    'http://localhost:8000' : 'https://8000-in729du0qi04ve0ijwlzw-6532622b.e2b.dev';
                
                var requestData = {
                    model: voiceConfig.model,
                    query: message,
                    requirements: `${voiceConfig.emotion}. ${voiceConfig.style}. ${voiceConfig.accent}. ${voiceConfig.characteristics}. Natural conversation pace with authentic Miami, Florida personality traits.`,
                    task_summary: `Miami AI personality conversation - ${this.currentVoiceProfile?.name}`,
                    file_name: `miami_ai_${Date.now()}.mp3`
                };
                
                console.log('🎵 Generating authentic Miami AI voice...', voiceConfig.speaker);
                
                var response = await fetch(`${voiceApiUrl}/api/generate-voice`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify(requestData)
                });
                
                if (!response.ok) {
                    throw new Error(`Voice API error: ${response.status}`);
                }
                
                return await response.json();
            }
            
            playProfessionalAudio(audioUrl, callback) {
                console.log('🔊 Playing professional Miami AI voice:', audioUrl);
                
                var audio = new Audio();
                audio.crossOrigin = 'anonymous';
                audio.preload = 'auto';
                
                audio.oncanplaythrough = function() {
                    console.log('🎤 Professional Miami AI voice ready to play');
                    audio.play().catch(function(error) {
                        console.error('🚨 Audio playback error:', error);
                        if (callback) callback();
                    });
                };
                
                audio.onended = function() {
                    console.log('✅ Professional Miami AI voice finished speaking');
                    if (callback) callback();
                };
                
                audio.onerror = (error) function() {
                    console.error('🚨 Professional audio error:', error);
                    // Fallback to enhanced TTS
                    this.playEnhancedFallbackVoice(this.lastMessage, callback);
                };
                
                this.lastMessage = audioUrl; // Store for error fallback
                audio.src = audioUrl;
            }
            
            playEnhancedFallbackVoice(message, callback) {
                console.log('🔄 Using enhanced fallback voice for:', message.substring(0, 50) + '...');
                
                if ('speechSynthesis' in window) {
                    // Stop any current speech
                    window.speechSynthesis.cancel();
                    
                    var utterance = new SpeechSynthesisUtterance(message);
                    
                    // Enhanced voice selection for Miami characteristics
                    var voices = window.speechSynthesis.getVoices();
                    var miamiVoice = this.selectBestMiamiVoice(voices);
                    
                    if (miamiVoice) {
                        utterance.voice = miamiVoice;
                        console.log(`🎤 Selected enhanced voice: ${miamiVoice.name}`);
                    }
                    
                    // Miami-tuned speech parameters
                    utterance.rate = 0.9;  // Slightly slower for natural conversation
                    utterance.pitch = this.getMiamiPitch();
                    utterance.volume = 0.9;
                    
                    utterance.onend = function() {
                        console.log('✅ Enhanced fallback voice finished');
                        if (callback) callback();
                    };
                    
                    utterance.onerror = (error) function() {
                        console.error('🚨 Enhanced TTS Error:', error);
                        if (callback) callback();
                    };
                    
                    // Add natural pause before speaking
                    setTimeout(function() {
                        window.speechSynthesis.speak(utterance);
                    }, 300); // Small delay for more natural timing
                    
                } else {
                    console.log('📝 Text-only fallback:', message);
                    if (callback) callback();
                }
            }
            
            selectBestMiamiVoice(voices) {
                var profileName = this.currentVoiceProfile?.name?.toLowerCase() || '';
                
                // Priority selection for authentic Miami voices
                var voicePreferences = [
                    // Try to find voices with regional characteristics
                    function(voice) { return voice.name.toLowerCase().includes('english (united states)'); },
                    function(voice) { return voice.lang === 'en-US'; },
                    // Gender-specific preferences
                    function(voice) {
                        if (profileName.includes('yeni') || profileName.includes('gabi')) {
                            return voice.name.toLowerCase().includes('female') || 
                                   voice.name.toLowerCase().includes('woman') ||
                                   ['samantha', 'victoria', 'karen', 'susan'].some(function(name) { 
                                       return voice.name.toLowerCase().includes(name);
                                   });
                        } else {
                            return voice.name.toLowerCase().includes('male') || 
                                   voice.name.toLowerCase().includes('man') ||
                                   ['david', 'alex', 'daniel', 'thomas'].some(function(name) { 
                                       return voice.name.toLowerCase().includes(name);
                                   });
                        }
                    }
                ];
                
                for (var i = 0; i < voicePreferences.length; i++) {
                    var preference = voicePreferences[i];
                    var matchingVoices = voices.filter(preference);
                    if (matchingVoices.length > 0) {
                        return matchingVoices[0];
                    }
                }
                
                return voices[0]; // Ultimate fallback
            }
            
            getMiamiPitch() {
                var profileName = this.currentVoiceProfile?.name?.toLowerCase() || '';
                
                if (profileName.includes('danny')) return 0.85;  // Benicio Del Toro-style depth
                if (profileName.includes('pedro')) return 0.9;   // Bad Bunny-style authority  
                if (profileName.includes('gabi')) return 1.05;   // Scarlett Johansson-style appeal
                return 1.0;  // Yeni - Sofia Vergara natural
            }
            
            selectVoiceForProfile(voices) {
                if (!this.currentVoiceProfile) return null;
                
                var profileName = this.currentVoiceProfile.name.toLowerCase();
                
                // Try to find appropriate voice based on profile
                if (profileName.includes('yeni') || profileName.includes('gabi')) {
                    return voices.find(function(voice) { 
                        return voice.name.toLowerCase().includes('female') ||
                               voice.name.toLowerCase().includes('samantha') ||
                               voice.name.toLowerCase().includes('kate');
                    });
                } else if (profileName.includes('danny') || profileName.includes('pedro')) {
                    return voices.find(function(voice) { 
                        return voice.name.toLowerCase().includes('male') ||
                               voice.name.toLowerCase().includes('daniel') ||
                               voice.name.toLowerCase().includes('alex');
                    });
                }
                
                return null;
            }
            
            startListeningForResponse() {
                if (!this.recognition || !this.isActive || this.isProcessingResponse) {
                    return;
                }
                
                // Clear any existing buffers
                this.speechBuffer = '';
                
                console.log('🎧 Miami AI ready to listen - speak naturally...');
                
                // Set timeout for no response (more patient timing)
                this.responseTimeout = setTimeout(function() {
                    if (!this.isProcessingResponse) {
                        console.log('⏰ No response detected, offering gentle follow-up...');
                        var followUp = this.getNoResponseFollowUp();
                        this.deliverAIResponse(followUp);
                    }
                }, 15000); // 15 seconds - more natural patience
                
                // Start listening with error handling
                try {
                    if (!this.isListening) {
                        this.recognition.start();
                    }
                } catch (error) {
                    console.error('🚨 Error starting speech recognition:', error);
                    // Retry once after a brief delay
                    setTimeout(function() {
                        if (this.isActive && !this.isListening) {
                            try {
                                this.recognition.start();
                            } catch (retryError) {
                                console.error('🚨 Retry failed:', retryError);
                                showNotification('Voice recognition unavailable. Please refresh the page.', 'warning');
                            }
                        }
                    }, 1000);
                }
            }
            
            processProspectResponse(response) {
                // Clear any existing timers
                if (this.responseTimeout) {
                    clearTimeout(this.responseTimeout);
                    this.responseTimeout = null;
                }
                
                if (this.silenceTimer) {
                    clearTimeout(this.silenceTimer);
                    this.silenceTimer = null;
                }
                
                // Ensure we're not listening while processing
                this.isProcessingResponse = true;
                
                console.log('🧠 Miami AI analyzing prospect response...');
                
                // Add to conversation history
                this.conversationHistory.push({
                    speaker: 'prospect',
                    message: response,
                    timestamp: Date.now()
                });
                
                // Analyze response and update context
                this.analyzeResponse(response);
                
                // Generate appropriate AI response with Miami personality
                var aiResponse = this.generateContextualResponse(response);
                
                console.log(`🎭 ${this.currentVoiceProfile?.name} preparing response...`);
                
                // Natural conversation timing - brief pause like a real person
                var responseDelay = this.calculateNaturalResponseDelay(response);
                
                setTimeout(function() {
                    this.deliverAIResponse(aiResponse);
                }, responseDelay);
            }
            
            calculateNaturalResponseDelay(prospectResponse) {
                // Calculate natural response timing based on response complexity and type
                var words = prospectResponse.split(' ').length;
                var baseDelay = 600;  // Minimum natural pause
                var thinkingTime = Math.min(words * 50, 800);  // Up to 800ms thinking time
                
                // Adjust based on response type
                var lowerResponse = prospectResponse.toLowerCase();
                
                if (lowerResponse.includes('no') || lowerResponse.includes('not interested')) {
                    return baseDelay + 200;  // Slight pause for objection handling
                } else if (lowerResponse.includes('yes') || lowerResponse.includes('tell me more')) {
                    return baseDelay - 100;  // Quicker response for enthusiasm
                } else if (lowerResponse.includes('busy') || lowerResponse.includes('time')) {
                    return baseDelay - 200;  // Quick acknowledgment of time concerns
                }
                
                return baseDelay + thinkingTime;
            }
            
            analyzeResponse(response) {
                var lowerResponse = response.toLowerCase();
                
                // Update prospect mood based on response
                if (lowerResponse.includes('good') || lowerResponse.includes('great') || lowerResponse.includes('fine')) {
                    this.currentContext.prospectMood = 'positive';
                    this.currentContext.engagementLevel = 'high';
                } else if (lowerResponse.includes('busy') || lowerResponse.includes('not now') || lowerResponse.includes('bad time')) {
                    this.currentContext.prospectMood = 'busy';
                    this.currentContext.engagementLevel = 'low';
                } else if (lowerResponse.includes('no') || lowerResponse.includes("don't") || lowerResponse.includes('not interested')) {
                    this.currentContext.prospectMood = 'resistant';
                    this.currentContext.objections.push(response);
                } else if (lowerResponse.includes('yes') || lowerResponse.includes('sure') || lowerResponse.includes('okay')) {
                    this.currentContext.prospectMood = 'receptive';
                    this.currentContext.engagementLevel = 'high';
                }
                
                // Detect HVAC interests and pain points
                if (lowerResponse.includes('maintenance') || lowerResponse.includes('service') || lowerResponse.includes('repair')) {
                    this.currentContext.interests.push('hvac_maintenance');
                }
                if (lowerResponse.includes('energy') || lowerResponse.includes('bills') || lowerResponse.includes('costs') || lowerResponse.includes('expensive')) {
                    this.currentContext.interests.push('energy_costs');
                }
                if (lowerResponse.includes('equipment') || lowerResponse.includes('units') || lowerResponse.includes('system') || lowerResponse.includes('machines')) {
                    this.currentContext.interests.push('hvac_equipment');
                }
                if (lowerResponse.includes('replace') || lowerResponse.includes('new') || lowerResponse.includes('upgrade') || lowerResponse.includes('old')) {
                    this.currentContext.interests.push('equipment_replacement');
                }
                if (lowerResponse.includes('hvac') || lowerResponse.includes('air conditioning') || lowerResponse.includes('cooling') || lowerResponse.includes('heating')) {
                    this.currentContext.interests.push('hvac_systems');
                }
                if (lowerResponse.includes('break') || lowerResponse.includes('down') || lowerResponse.includes('problem') || lowerResponse.includes('issue')) {
                    this.currentContext.interests.push('equipment_problems');
                }
                if (lowerResponse.includes('emergency') || lowerResponse.includes('urgent') || lowerResponse.includes('immediate')) {
                    this.currentContext.interests.push('emergency_repairs');
                }
                if (lowerResponse.includes('schedule') || lowerResponse.includes('regular') || lowerResponse.includes('routine')) {
                    this.currentContext.interests.push('scheduled_maintenance');
                }
                
                console.log('📊 Updated context:', this.currentContext);
            }
            
            generateContextualResponse(prospectResponse) {
                var mood = this.currentContext.prospectMood;
                var stage = this.currentContext.stage;
                var interests = this.currentContext.interests;
                var profileName = this.currentVoiceProfile.name;
                
                // Handle specific HVAC interests
                if (interests.includes('equipment_problems') || interests.includes('emergency_repairs')) {
                    return this.getEmergencyRepairResponse(profileName);
                } else if (interests.includes('energy_costs')) {
                    return this.getEnergyCostResponse(profileName);
                } else if (interests.includes('equipment_replacement')) {
                    return this.getEquipmentReplacementResponse(profileName);
                } else if (interests.includes('scheduled_maintenance')) {
                    return this.getMaintenanceScheduleResponse(profileName);
                }
                
                // Generate response based on mood and stage
                if (mood === 'busy') {
                    return this.getBusyResponse(profileName);
                } else if (mood === 'resistant') {
                    return this.getObjectionResponse(profileName, prospectResponse);
                } else if (mood === 'receptive' || mood === 'positive') {
                    return this.getPositiveResponse(profileName, stage);
                } else {
                    return this.getNeutralResponse(profileName, stage);
                }
            }
            
            getEmergencyRepairResponse(profileName) {
                var responses = {
                    'Yeni - Miami Latina Consultant': "Oh wow, emergency repairs are so stressful and expensive! That's exactly why I called. We specialize in preventing those emergency situations with proactive maintenance programs. How often are you dealing with unexpected HVAC breakdowns?",
                    'Danny - Bilingual Miami Charm': "Man, emergency calls are the worst, right? Always at the worst times and they cost a fortune. That's what we help prevent with our maintenance programs. What kind of emergency issues have you been dealing with?",
                    'Pedro Rodriguez - Executive Authority': "¡Listen! Emergency repairs are massive unplanned expenses that kill your budget! Our preventive maintenance programs are specifically engineered to eliminate these emergency situations and dramatically reduce your HVAC operational costs. What's driving these costly emergency repair needs?",
                    'Gabi - Friendly Miami Personality': "Ugh, emergency repairs are such a nightmare! They always happen at the worst possible time. That's exactly what our maintenance services help avoid. What kind of emergency issues have been causing you headaches?"
                };
                
                return responses[profileName] || responses['Yeni - Miami Latina Consultant'];
            }
            
            getEnergyCostResponse(profileName) {
                var responses = {
                    'Yeni - Miami Latina Consultant': "Energy costs are definitely a huge concern, especially here in Miami with AC running constantly! Proper HVAC maintenance can actually reduce your energy bills significantly. Have you noticed your energy costs increasing lately?",
                    'Danny - Bilingual Miami Charm': "Yeah, energy bills in Miami are brutal! You know what's crazy though? Most people don't realize that well-maintained HVAC systems use way less energy. What kind of energy costs are you seeing?",
                    'Pedro Rodriguez - Executive Authority': "Energy efficiency is absolutely critical! Let me tell you - properly maintained HVAC systems operate dramatically more efficiently, slashing energy consumption and costs. Are these energy expenses crushing your operational budget?",
                    'Gabi - Friendly Miami Personality': "Oh my gosh, energy costs are through the roof lately! The good news is that proper HVAC maintenance can really help bring those costs down. What's your energy bill looking like these days?"
                };
                
                return responses[profileName] || responses['Yeni - Miami Latina Consultant'];
            }
            
            getEquipmentReplacementResponse(profileName) {
                var responses = {
                    'Yeni - Miami Latina Consultant': "Equipment replacement is such a big investment! The key is timing it right and making sure you get the most efficient systems. We help facilities plan equipment replacements strategically. How old are your current HVAC systems?",
                    'Danny - Bilingual Miami Charm': "Replacing equipment is a big decision, for sure. The trick is knowing when it makes financial sense versus continuing to repair. We help figure that out. What's the age and condition of your equipment?",
                    'Pedro Rodriguez - Executive Authority': "Strategic equipment replacement planning is absolutely crucial for maximizing operational efficiency! We provide game-changing assessments to determine the perfect replacement timing and equipment selection. What's your current equipment situation looking like?",
                    'Gabi - Friendly Miami Personality': "Equipment replacement can be so overwhelming! There are so many options and decisions. We help make it simple and ensure you get the best value. What equipment are you thinking about replacing?"
                };
                
                return responses[profileName] || responses['Yeni - Miami Latina Consultant'];
            }
            
            getMaintenanceScheduleResponse(profileName) {
                var responses = {
                    'Yeni - Miami Latina Consultant': "A good maintenance schedule is so important! It prevents problems and saves money long-term. We help facilities optimize their maintenance schedules based on their specific equipment and usage. What does your current maintenance schedule look like?",
                    'Danny - Bilingual Miami Charm': "Smart thinking on the maintenance schedule! Regular maintenance is like insurance for your equipment. We can help optimize when and how often you service different systems. How are you handling maintenance now?",
                    'Pedro Rodriguez - Executive Authority': "¡Exactly! Proper maintenance scheduling is absolutely essential for rock-solid operational reliability and tight cost control. We develop powerful customized maintenance programs based on your specific equipment, usage patterns, and operational requirements. What's your current maintenance approach?",
                    'Gabi - Friendly Miami Personality': "Good maintenance scheduling makes such a difference! It keeps everything running smoothly and prevents surprises. We help create maintenance programs that work with your schedule and budget. How do you handle maintenance currently?"
                };
                
                return responses[profileName] || responses['Yeni - Miami Latina Consultant'];
            }
            
            getBusyResponse(profileName) {
                var responses = {
                    'Yeni - Miami Latina Consultant': "I completely understand you're busy! I really appreciate you taking my call. This will just take two minutes, and could help reduce your HVAC operational costs. Can I ask one quick question about your current maintenance schedule?",
                    'Danny - Bilingual Miami Charm': "I totally get it - you're swamped, right? Listen, I don't want to take up your whole day. Let me ask you this real quick - how often do you have your HVAC systems serviced for maintenance?",
                    'Pedro Rodriguez - Executive Authority': "I absolutely respect your time - it's valuable! Let me be direct and energetic about this - I have one powerful question about your HVAC operations that could save your facility serious money on maintenance and repairs. Can I ask about your current service program?",
                    'Gabi - Friendly Miami Personality': "I totally get that! Everyone's so busy these days. You know what though, this might actually help reduce your operational stress with HVAC issues. Can I ask you one quick thing about your maintenance approach?"
                };
                
                return responses[profileName] || responses['Yeni - Miami Latina Consultant'];
            }
            
            getObjectionResponse(profileName, objection) {
                var responses = {
                    'Yeni - Miami Latina Consultant': "I hear you, and I completely respect that. You know what though, many facility managers tell me the same thing initially. But when they see how much money they're actually leaving on the table with their HVAC operations, they're glad we talked. What if this could improve your maintenance efficiency without any hassle?",
                    'Danny - Bilingual Miami Charm': "I get it, nobody likes unexpected calls, right? But check this out - this isn't about selling you anything today. This is about sharing information that could help optimize your HVAC operations. Wouldn't you at least want to know about it?",
                    'Pedro Rodriguez - Executive Authority': "I completely understand your position! Many successful executives tell me the exact same thing initially. But listen - this is purely informational about HVAC cost optimization that could save you serious money! Given that maintenance costs are a major operational expense, wouldn't you want to know how other facilities are dramatically improving efficiency?",
                    'Gabi - Friendly Miami Personality': "I totally understand! You know what though, I'm not trying to sell you anything right now. I'm just sharing something that's been helping a lot of facilities around Miami with their HVAC operations. Even if you're not interested in making changes, wouldn't you want to know if there are better maintenance approaches?"
                };
                
                return responses[profileName] || responses['Yeni - Miami Latina Consultant'];
            }
            
            getPositiveResponse(profileName, stage) {
                if (stage === 'opening') {
                    this.currentContext.stage = 'qualifying';
                    return this.getHVACQualifyingQuestion(profileName);
                } else if (stage === 'qualifying') {
                    this.currentContext.stage = 'needs_assessment';
                    return this.getHVACNeedsAssessment(profileName);
                } else if (stage === 'needs_assessment') {
                    this.currentContext.stage = 'service_discussion';
                    return this.getHVACServiceDiscussion(profileName);
                }
                
                var responses = {
                    'Yeni - Miami Latina Consultant': "That's wonderful! I'm so glad you're doing well. So listen, I was actually thinking about your facility earlier today. Have you been keeping an eye on your HVAC maintenance costs lately? I'm asking because we've been helping a lot of businesses around Miami optimize their operations.",
                    'Danny - Bilingual Miami Charm': "Excellent! Good to hear, my friend. So check this out - I was talking to a facility manager who runs a business over in Kendall, and he mentioned something that made me think of you. You been dealing with high HVAC maintenance costs this summer?",
                    'Pedro Rodriguez - Executive Authority': "¡Excelente! That's fantastic to hear business is thriving for you! I'm excited to reach out because we've been working with several successful companies in the Miami area on HVAC cost optimization with incredible results. Have you had a chance to review your facility's maintenance expenses recently?",
                    'Gabi - Friendly Miami Personality': "Awesome! I love hearing that. So you know what, since things are going well, this might be perfect timing. I've been helping some facilities around here optimize their HVAC operations. Have you noticed your maintenance costs being higher than expected?"
                };
                
                return responses[profileName] || responses['Yeni - Miami Latina Consultant'];
            }
            
            getHVACQualifyingQuestion(profileName) {
                var questions = {
                    'Yeni - Miami Latina Consultant': "Perfect! Since you're doing well, this might be great timing. I specialize in helping facilities optimize their HVAC operations. Can I ask - how often do you currently have your HVAC systems serviced for maintenance?",
                    'Danny - Bilingual Miami Charm': "Excellent! So listen, I work with facilities around Miami on HVAC efficiency. Tell me - do you have a regular maintenance schedule for your air conditioning and heating systems?",
                    'Pedro Rodriguez - Executive Authority': "¡Excelente! That's outstanding! I'm passionate about HVAC operational efficiency for commercial facilities. What's your current approach to scheduled maintenance for your HVAC equipment?",
                    'Gabi - Friendly Miami Personality': "That's great to hear! I help businesses optimize their HVAC operations. Quick question - when was the last time you had a comprehensive maintenance check on your HVAC systems?"
                };
                
                return questions[profileName] || questions['Yeni - Miami Latina Consultant'];
            }
            
            getHVACNeedsAssessment(profileName) {
                var assessments = {
                    'Yeni - Miami Latina Consultant': "That's helpful to know. Let me ask you this - have you been experiencing any unexpected equipment failures or emergency repair calls with your HVAC systems? And what's been your biggest concern with your current HVAC operations?",
                    'Danny - Bilingual Miami Charm': "Good info. So tell me, what kind of issues have you been dealing with? Any surprise breakdowns or systems that aren't performing like they used to? What's keeping you up at night about your HVAC operations?",
                    'Pedro Rodriguez - Executive Authority': "¡Perfecto! I want to understand exactly what's happening. From an operational perspective, what challenges are crushing your HVAC systems? Are you dealing with unexpected downtime, costly equipment failures, or frustrating performance issues?",
                    'Gabi - Friendly Miami Personality': "That makes sense. So what's been your biggest headache with your HVAC systems lately? Any equipment that's been acting up or causing unexpected problems?"
                };
                
                return assessments[profileName] || assessments['Yeni - Miami Latina Consultant'];
            }
            
            getHVACServiceDiscussion(profileName) {
                var discussions = {
                    'Yeni - Miami Latina Consultant': "I can definitely understand those challenges. Based on what you're telling me, it sounds like you might benefit from our comprehensive HVAC service approach. We handle everything from preventive maintenance to emergency repairs and equipment replacement. What would be most valuable - improving your maintenance schedule, reducing emergency calls, or looking at equipment upgrades?",
                    'Danny - Bilingual Miami Charm': "Yeah, I hear you on those issues. Look, we specialize in exactly what you're dealing with. We do the full spectrum - scheduled maintenance, repairs when things break down, and help with equipment replacement when it's time. What would make the biggest difference for you right now?",
                    'Pedro Rodriguez - Executive Authority': "¡Exactamente! Those are precisely the operational inefficiencies we eliminate completely! Our services include game-changing preventive maintenance programs, lightning-fast response repairs, and strategic equipment replacement planning. Which area would deliver the most immediate and powerful value for your facility?",
                    'Gabi - Friendly Miami Personality': "Those problems are so common! That's exactly why we do what we do. We offer complete HVAC services - regular maintenance to prevent problems, quick repairs when things go wrong, and replacement services for older equipment. What would help your operations the most?"
                };
                
                return discussions[profileName] || discussions['Yeni - Miami Latina Consultant'];
            }
            
            getNeutralResponse(profileName, stage) {
                if (stage === 'opening') {
                    this.currentContext.stage = 'qualifying';
                }
                
                var responses = {
                    'Yeni - Miami Latina Consultant': "I appreciate you taking the time to talk with me. So I was wondering - have you been noticing your HVAC maintenance costs going up lately? A lot of facilities here in South Florida are dealing with the same challenge with their equipment running non-stop.",
                    'Danny - Bilingual Miami Charm': "Cool, cool. So listen, I'm calling because something came up that made me think about facilities like yours. Your HVAC maintenance bills been tough lately with all this Miami heat keeping your systems working overtime?",
                    'Pedro Rodriguez - Executive Authority': "Thank you for taking my call! I'm excited to discuss something that's been impacting many successful businesses in our area - these rising HVAC operational costs. Have you been monitoring your facility's maintenance expenses and equipment performance?",
                    'Gabi - Friendly Miami Personality': "Thanks for chatting with me! So I was curious - how have your HVAC maintenance costs been lately? I know a lot of facilities around Miami have been dealing with increased service expenses and equipment issues."
                };
                
                return responses[profileName] || responses['Yeni - Miami Latina Consultant'];
            }
            
            handleNoResponse() {
                console.log('⏰ No response received from prospect');
                
                var followUp = this.getNoResponseFollowUp();
                this.deliverAIResponse(followUp);
            }
            
            getNoResponseFollowUp() {
                var profileName = this.currentVoiceProfile.name;
                
                var responses = {
                    'Yeni - Miami Latina Consultant': "Are you still there? I just want to make sure I'm not catching you at a bad time. Should I call back later?",
                    'Danny - Bilingual Miami Charm': "You still with me? If this is a bad time, just var me know and I can call you back later.",
                    'Pedro Rodriguez - Executive Authority': "I want to make sure I have your attention. If this isn't a good time, I'm happy to schedule a brief call for later.",
                    'Gabi - Friendly Miami Personality': "Hello? I hope I didn't lose you there! If you need to go, just var me know and we can chat another time."
                };
                
                return responses[profileName] || responses['Yeni - Miami Latina Consultant'];
            }
            
            handleRecognitionError() {
                console.log('🚨 Speech recognition error - switching to manual mode');
                showNotification('Voice recognition unavailable - click to respond manually', 'warning');
            }
            
            stopConversation() {
                this.isActive = false;
                
                if (this.recognition && this.isListening) {
                    this.recognition.stop();
                }
                
                if (this.responseTimeout) {
                    clearTimeout(this.responseTimeout);
                    this.responseTimeout = null;
                }
                
                this.showListeningIndicator(false);
                this.showAISpeakingIndicator(false);
                
                console.log('🛑 Real-time conversation stopped');
                showNotification('Real-time conversation ended', 'info');
            }
            
            showListeningIndicator(show) {
                // Visual indicator that AI is listening
                var indicator = document.getElementById('listening-indicator') || this.createListeningIndicator();
                
                if (show) {
                    indicator.style.display = 'block';
                    indicator.innerHTML = '🎤 Listening for your response...';
                } else {
                    indicator.style.display = 'none';
                }
            }
            
            showAISpeakingIndicator(show) {
                // Visual indicator that AI is speaking
                var indicator = document.getElementById('speaking-indicator') || this.createSpeakingIndicator();
                
                if (show) {
                    indicator.style.display = 'block';
                    indicator.innerHTML = `🤖 ${this.currentVoiceProfile?.name || 'AI'} is speaking...`;
                } else {
                    indicator.style.display = 'none';
                }
            }
            
            createListeningIndicator() {
                var indicator = document.createElement('div');
                indicator.id = 'listening-indicator';
                indicator.className = 'fixed bottom-4 right-4 bg-blue-600 text-white px-4 py-2 rounded-lg shadow-lg z-50';
                indicator.style.display = 'none';
                document.body.appendChild(indicator);
                return indicator;
            }
            
            createSpeakingIndicator() {
                var indicator = document.createElement('div');
                indicator.id = 'speaking-indicator';
                indicator.className = 'fixed bottom-4 left-4 bg-green-600 text-white px-4 py-2 rounded-lg shadow-lg z-50';
                indicator.style.display = 'none';
                document.body.appendChild(indicator);
                return indicator;
            }
        }
        
        // Initialize conversation manager
        window.conversationManager = new ConversationManager();
        
        function playVoicePreviewByType(voiceType, callback) {
            // Default settings for predefined voice types
            var voiceConfigs = {
                'professional-female': { pace: 'normal', tone: 'professional', accent: 'us-neutral' },
                'professional-male': { pace: 'normal', tone: 'professional', accent: 'us-neutral' },
                'friendly-female': { pace: 'normal', tone: 'friendly', accent: 'us-neutral' },
                'friendly-male': { pace: 'normal', tone: 'conversational', accent: 'us-southern' },
                'authoritative-male': { pace: 'moderate', tone: 'confident', accent: 'us-neutral' },
                'warm-female': { pace: 'normal', tone: 'friendly', accent: 'us-neutral' }
            };
            
            var config = voiceConfigs[voiceType] || voiceConfigs['professional-female'];
            playVoicePreview(voiceType, config.pace, config.tone, config.accent, callback);
        }
        
        // Initialize voices when page loads (voices load asynchronously)
        function initializeVoices() {
            if ('speechSynthesis' in window) {
                // Load voices
                window.speechSynthesis.getVoices();
                
                // Some browsers need this event
                window.speechSynthesis.addEventListener('voiceschanged', function() {
                    console.log('🎤 Speech synthesis voices loaded:', window.speechSynthesis.getVoices().length);
                });
            }
        }
        
        // Initialize Natural AI Voice System
        function initializeNaturalVoices() {
            console.log('🎤 Initializing Natural AI Voice System...');
            console.log('✨ Loading professional AI voice models...');
            console.log('🎯 Voice quality: Human-like, conversational, gender-accurate');
            
            // Initialize Web Speech API and load voices
            if ('speechSynthesis' in window) {
                // Load voices immediately
                var voices = window.speechSynthesis.getVoices();
                console.log(`🔊 Initial voices available: ${voices.length}`);
                
                // Listen for voice changes (some browsers load voices asynchronously)
                window.speechSynthesis.addEventListener('voiceschanged', function() {
                    voices = window.speechSynthesis.getVoices();
                    console.log(`🔊 Voices loaded: ${voices.length} available`);
                    
                    // Log available voices for debugging
                    voices.forEach((voice, index) function() {
                        console.log(`Voice ${index}: ${voice.name} (${voice.lang}) ${voice.gender || 'unknown gender'}`);
                    });
                });
                
                // Force voice loading in some browsers
                var utterance = new SpeechSynthesisUtterance('');
                window.speechSynthesis.speak(utterance);
                window.speechSynthesis.cancel();
            }
            
            setTimeout(function() {
                console.log('🎉 Natural AI voices ready - Real audio playback enabled!');
                console.log('🔊 Click any Preview Voice button to hear actual audio');
            }, 1000);
        }
        
        // Get voice profile information for real-time conversations
        function getVoiceProfile(voiceType) {
            var profiles = {
                'professional-female': {
                    name: 'Yeni - Miami Latina Consultant',
                    personality: 'professional-latina',
                    style: 'Sofia Vergara-inspired warmth and consultative approach'
                },
                'friendly-male': {
                    name: 'Danny - Bilingual Miami Charm', 
                    personality: 'bilingual-community',
                    style: 'Benicio Del Toro-inspired neighbor-to-neighbor charm'
                },
                'professional-male': {
                    name: 'Pedro Rodriguez - Executive Authority',
                    personality: 'latino-executive',
                    style: 'Bad Bunny-inspired confident business authority'
                },
                'friendly-female': {
                    name: 'Gabi - Friendly Miami Personality',
                    personality: 'friendly-sexy',
                    style: 'Scarlett Johansson-inspired friendly appeal'
                }
            };
            
            return profiles[voiceType] || profiles['professional-female'];
        }
        
        // Initialize voices when page loads
        window.addEventListener('load', function() {
            initializeVoices();
            initializeNaturalVoices();
        });
        
        console.log('🎯 ProSpector Pro scripts loaded');
    </script>
    
    <!-- EMERGENCY TAB FIX - ISOLATED WORKING TAB SYSTEM -->
    <script>
        // WORKING TAB SYSTEM - INDEPENDENT OF OTHER JAVASCRIPT
        function emergencySwitchTab(tabName) {
            console.log('🔧 Emergency tab switch to:', tabName);
            
            // Hide all content
            var contents = document.querySelectorAll('.tab-content');
            for (var i = 0; i < contents.length; i++) {
                contents[i].classList.add('hidden');
            }
            
            // Remove active from buttons
            var buttons = document.querySelectorAll('.nav-item');
            for (var i = 0; i < buttons.length; i++) {
                buttons[i].classList.remove('active', 'text-white');
                buttons[i].classList.add('text-white/80');
            }
            
            // Show target tab
            var target = document.getElementById(tabName + '-tab');
            if (target) {
                target.classList.remove('hidden');
                console.log('✅ Activated content:', tabName);
            }
            
            // Activate button
            var activeBtn = document.querySelector('[data-tab="' + tabName + '"]');
            if (activeBtn) {
                activeBtn.classList.add('active', 'text-white');
                activeBtn.classList.remove('text-white/80');
                console.log('✅ Activated button:', tabName);
            }
            
            // Initialize calendar buttons when switching to meetings tab
            if (tabName === 'meetings') {
                setTimeout(function() {
                    if (typeof initializeCalendarButtons === 'function') {
                        initializeCalendarButtons();
                    }
                }, 200);
            }
        }
        
        // Emergency initialization
        document.addEventListener('DOMContentLoaded', function() {
            console.log('🚨 Emergency tab system initializing...');
            
            var tabButtons = document.querySelectorAll('[data-tab]');
            console.log('🔍 Found', tabButtons.length, 'tab buttons for emergency fix');
            
            for (var i = 0; i < tabButtons.length; i++) {
                var btn = tabButtons[i];
                var tabName = btn.getAttribute('data-tab');
                
                // Use closure to capture tabName
                (function(name) {
                    btn.addEventListener('click', function(e) {
                        e.preventDefault();
                        console.log('🖱️ Emergency tab clicked:', name);
                        emergencySwitchTab(name);
                    });
                })(tabName);
            }
            
            console.log('✅ Emergency tab system ready!');
            
            // Initialize interactive elements within tabs
            initializeTabContentInteractions();
            
            // Force initialize calendar buttons after emergency system is ready
            setTimeout(function() {
                if (typeof initializeCalendarButtons === 'function') {
                    console.log('🚨 Emergency system forcing calendar initialization...');
                    initializeCalendarButtons();
                }
            }, 1000);
        });
        
        // Initialize all interactive elements within tab content
        function initializeTabContentInteractions() {
            console.log('🔧 Initializing tab content interactions...');
            
            // Voice preview buttons
            var previewButtons = document.querySelectorAll('[id*="preview"], .voice-preview-btn, .preview-voice-btn');
            console.log('🎤 Found', previewButtons.length, 'voice preview buttons');
            for (var i = 0; i < previewButtons.length; i++) {
                previewButtons[i].addEventListener('click', function() {
                    console.log('🎤 Voice preview clicked');
                    var voiceId = this.getAttribute('data-voice') || 'pedro';
                    previewVoiceEmergency(voiceId);
                });
            }
            
            // Live chat buttons  
            var liveChatButtons = document.querySelectorAll('.live-chat-btn, [id*="liveChat"]');
            console.log('💬 Found', liveChatButtons.length, 'live chat buttons');
            for (var i = 0; i < liveChatButtons.length; i++) {
                liveChatButtons[i].addEventListener('click', function() {
                    console.log('💬 Live chat clicked');
                    alert('Live chat functionality will be available soon!');
                });
            }
            
            // Note: Connection buttons handled by setupSpecificConnectionButtons() function
            
            // Campaign buttons
            var campaignButtons = document.querySelectorAll('.campaign-btn, [id*="campaign"], [id*="start"], [id*="launch"]');
            console.log('🚀 Found', campaignButtons.length, 'campaign buttons');  
            for (var i = 0; i < campaignButtons.length; i++) {
                campaignButtons[i].addEventListener('click', function() {
                    console.log('🚀 Campaign button clicked');
                    alert('Campaign functionality will be available soon!');
                });
            }
            
            // Generate/Create buttons
            var generateButtons = document.querySelectorAll('[id*="generate"], [id*="create"], .generate-btn');
            console.log('⚡ Found', generateButtons.length, 'generate buttons');
            for (var i = 0; i < generateButtons.length; i++) {
                generateButtons[i].addEventListener('click', function() {
                    console.log('⚡ Generate button clicked');
                    alert('Generation functionality will be available soon!');
                });
            }
            
            // Schedule buttons (exclude our main schedule button)
            var scheduleButtons = document.querySelectorAll('button[id*="schedule"], .schedule-btn');
            console.log('📅 Found', scheduleButtons.length, 'schedule buttons');
            for (var i = 0; i < scheduleButtons.length; i++) {
                // Skip our main schedule button
                if (scheduleButtons[i].id === 'main-schedule-btn' || scheduleButtons[i].textContent.includes('Schedule New Appointment')) {
                    console.log('📅 Skipping main-schedule-btn - has specific handler');
                    continue;
                }
                scheduleButtons[i].addEventListener('click', function() {
                    console.log('📅 Generic schedule button clicked');
                    alert('Scheduling functionality will be available soon!');
                });
            }
            
            // Manual entry and import buttons
            var manualEntryButtons = document.querySelectorAll('#add-lead-btn, #import-csv-btn, [id*="add-lead"], [id*="import"], .add-lead-btn, .import-btn');
            console.log('👤 Found', manualEntryButtons.length, 'manual entry/import buttons');
            for (var i = 0; i < manualEntryButtons.length; i++) {
                manualEntryButtons[i].addEventListener('click', function() {
                    console.log('👤 Manual entry/import button clicked:', this.id || this.className);
                    if (this.id === 'add-lead-btn' || this.textContent.includes('Add New Lead')) {
                        console.log('📝 Opening Add New Lead form...');
                        openLeadEntryForm();
                    } else if (this.id === 'import-csv-btn' || this.textContent.includes('Import')) {
                        console.log('📄 Opening Import CSV dialog...');
                        openImportCSVDialog();
                    } else {
                        alert('Lead management functionality will be available soon!');
                    }
                });
            }
            
            // Specific service connection handlers
            setupSpecificConnectionButtons();
            
            // Add delegated event listeners for connection buttons (fallback)
            document.addEventListener('click', function(e) {
                if (e.target && (e.target.id === 'connect-apollo-btn' || e.target.id === 'connect-seamless-btn' || 
                    e.target.id === 'connect-linkedin-btn' || e.target.id === 'connect-zoominfo-btn' || 
                    e.target.id === 'connect-google-btn')) {
                    
                    console.log('🎯 Delegated click detected for:', e.target.id);
                    e.preventDefault();
                    
                    if (e.target.id === 'connect-apollo-btn') {
                        connectService('Apollo AI', 'https://app.apollo.io/#/login?redirectTo=https%3A%2F%2Fapp.apollo.io%2F%23%2F', 'https://app.apollo.io/sign_up');
                    } else if (e.target.id === 'connect-seamless-btn') {
                        connectService('Seamless AI', 'https://login.seamless.ai/login', 'https://login.seamless.ai/register');
                    } else if (e.target.id === 'connect-linkedin-btn') {
                        connectService('LinkedIn Sales Navigator', 'https://www.linkedin.com/login?session_redirect=%2Fsales&_f=navigator&fromSignIn=true', 'https://business.linkedin.com/sales-solutions/sales-navigator');
                    } else if (e.target.id === 'connect-zoominfo-btn') {
                        connectService('ZoomInfo', 'https://login.zoominfo.com/', 'https://www.zoominfo.com/free-trial');
                    } else if (e.target.id === 'connect-google-btn') {
                        connectService('Google Business', 'https://accounts.google.com/signin', 'https://business.google.com/');
                    }
                }
            });
            
            console.log('✅ All tab content interactions initialized!');
        }
        
        // Emergency voice preview function
        function previewVoiceEmergency(voiceId) {
            console.log('🎤 Emergency voice preview for:', voiceId);
            
            // Find the button that was clicked
            var btn = event.target;
            var originalText = btn.innerHTML;
            
            // Show loading state
            btn.innerHTML = '<i class="fas fa-spinner fa-spin mr-2"></i>Loading...';
            btn.disabled = true;
            
            // Simulate voice preview (replace with actual API call when ready)
            setTimeout(function() {
                alert('🎤 Voice Preview for ' + voiceId + '\n\n"Hello! This is ' + voiceId + ' from Cool Breeze HVAC. I specialize in professional air conditioning maintenance, repairs, and energy-efficient system installations. How can I help you today?"\n\n(Voice preview functionality will connect to the voice API soon!)');
                
                btn.innerHTML = '<i class="fas fa-check mr-2"></i>Preview Played';
                setTimeout(function() {
                    btn.innerHTML = originalText;
                    btn.disabled = false;
                }, 2000);
            }, 1500);
        }
        
        // Setup specific service connection buttons
        function setupSpecificConnectionButtons() {
            console.log('🔗 Setting up service-specific connection handlers...');
            
            // Apollo AI
            var apolloBtn = document.getElementById('connect-apollo-btn');
            if (apolloBtn) {
                console.log('✅ Found Apollo AI button, setting up handler');
                apolloBtn.addEventListener('click', function(e) {
                    e.preventDefault();
                    console.log('🚀 Apollo AI button clicked!');
                    connectService('Apollo AI', 'https://app.apollo.io/#/login?redirectTo=https%3A%2F%2Fapp.apollo.io%2F%23%2F', 'https://app.apollo.io/sign_up');
                });
            } else {
                console.log('❌ Apollo AI button not found');
            }
            
            // Seamless AI  
            var seamlessBtn = document.getElementById('connect-seamless-btn');
            if (seamlessBtn) {
                console.log('✅ Found Seamless AI button, setting up handler');
                seamlessBtn.addEventListener('click', function(e) {
                    e.preventDefault();
                    console.log('🚀 Seamless AI button clicked!');
                    connectService('Seamless AI', 'https://login.seamless.ai/login', 'https://login.seamless.ai/register');
                });
            } else {
                console.log('❌ Seamless AI button not found');
            }
            
            // LinkedIn Sales Navigator
            var linkedinBtn = document.getElementById('connect-linkedin-btn');
            if (linkedinBtn) {
                linkedinBtn.addEventListener('click', function(e) {
                    e.preventDefault();
                    connectService('LinkedIn Sales Navigator', 'https://www.linkedin.com/login?session_redirect=%2Fsales&_f=navigator&fromSignIn=true', 'https://business.linkedin.com/sales-solutions/sales-navigator');
                });
            }
            
            // ZoomInfo
            var zoominfoBtn = document.getElementById('connect-zoominfo-btn');
            if (zoominfoBtn) {
                zoominfoBtn.addEventListener('click', function(e) {
                    e.preventDefault();
                    connectService('ZoomInfo', 'https://login.zoominfo.com/', 'https://www.zoominfo.com/free-trial');
                });
            }
            
            // Google Business
            var googleBtn = document.getElementById('connect-google-btn');
            if (googleBtn) {
                googleBtn.addEventListener('click', function(e) {
                    e.preventDefault();
                    connectService('Google Business', 'https://accounts.google.com/signin', 'https://business.google.com/');
                });
            }
        }
        
        // Universal service connection function
        function connectService(serviceName, loginUrl, signupUrl) {
            console.log('🔗 Connecting to:', serviceName);
            
            var message = '🔗 Connect ' + serviceName + ' to ProSpector Pro\n\n' +
                         '📊 BENEFITS:\n' +
                         '✅ Import leads directly from ' + serviceName + '\n' +
                         '✅ Sync contact data and company insights\n' +
                         '✅ Access advanced search and filtering\n' +
                         '✅ Automate HVAC prospect identification\n\n' +
                         '🔐 SECURE CONNECTION:\n' +
                         '• Your credentials stay with ' + serviceName + '\n' +
                         '• ProSpector Pro uses official APIs only\n' +
                         '• No passwords stored in our system\n\n' +
                         'Choose an option:';
            
            // Create custom modal for login/signup choice
            if (confirm(message + '\n\nOK = Login to existing account\nCancel = Sign up for new account')) {
                // User chose login
                console.log('🔑 Opening login for:', serviceName);
                window.open(loginUrl, '_blank', 'width=800,height=600,scrollbars=yes,resizable=yes');
            } else {
                // User chose signup  
                console.log('📝 Opening signup for:', serviceName);
                window.open(signupUrl, '_blank', 'width=800,height=600,scrollbars=yes,resizable=yes');
            }
        }
        
        // Lead Entry Form Functions
        function openLeadEntryForm() {
            // Create modal overlay
            var modal = document.createElement('div');
            modal.className = 'fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50';
            modal.style.backdropFilter = 'blur(5px)';
            
            modal.innerHTML = `
                <div class="bg-gray-800 rounded-2xl p-6 w-full max-w-md mx-4 max-h-screen overflow-y-auto">
                    <div class="flex items-center justify-between mb-6">
                        <h2 class="text-xl font-bold text-white flex items-center">
                            <i class="fas fa-user-plus mr-2 text-blue-400"></i>
                            Add New HVAC Lead
                        </h2>
                        <button class="close-lead-form text-gray-400 hover:text-white">
                            <i class="fas fa-times text-xl"></i>
                        </button>
                    </div>
                    
                    <form id="leadEntryForm" class="space-y-4">
                        <!-- Contact Information -->
                        <div>
                            <label class="block text-sm font-semibold text-gray-300 mb-2">Company Name *</label>
                            <input type="text" id="companyName" required 
                                   class="w-full bg-gray-700 border border-gray-600 rounded-lg px-3 py-2 text-white focus:border-blue-500 focus:outline-none"
                                   placeholder="e.g., Miami Office Complex">
                        </div>
                        
                        <div class="grid grid-cols-2 gap-4">
                            <div>
                                <label class="block text-sm font-semibold text-gray-300 mb-2">First Name *</label>
                                <input type="text" id="firstName" required 
                                       class="w-full bg-gray-700 border border-gray-600 rounded-lg px-3 py-2 text-white focus:border-blue-500 focus:outline-none"
                                       placeholder="John">
                            </div>
                            <div>
                                <label class="block text-sm font-semibold text-gray-300 mb-2">Last Name *</label>
                                <input type="text" id="lastName" required 
                                       class="w-full bg-gray-700 border border-gray-600 rounded-lg px-3 py-2 text-white focus:border-blue-500 focus:outline-none"
                                       placeholder="Smith">
                            </div>
                        </div>
                        
                        <div>
                            <label class="block text-sm font-semibold text-gray-300 mb-2">Job Title</label>
                            <input type="text" id="jobTitle" 
                                   class="w-full bg-gray-700 border border-gray-600 rounded-lg px-3 py-2 text-white focus:border-blue-500 focus:outline-none"
                                   placeholder="Facility Manager, Operations Director">
                        </div>
                        
                        <div class="grid grid-cols-2 gap-4">
                            <div>
                                <label class="block text-sm font-semibold text-gray-300 mb-2">Phone *</label>
                                <input type="tel" id="phone" required 
                                       class="w-full bg-gray-700 border border-gray-600 rounded-lg px-3 py-2 text-white focus:border-blue-500 focus:outline-none"
                                       placeholder="(305) 555-0123">
                            </div>
                            <div>
                                <label class="block text-sm font-semibold text-gray-300 mb-2">Email</label>
                                <input type="email" id="email" 
                                       class="w-full bg-gray-700 border border-gray-600 rounded-lg px-3 py-2 text-white focus:border-blue-500 focus:outline-none"
                                       placeholder="john@company.com">
                            </div>
                        </div>
                        
                        <!-- HVAC-Specific Fields -->
                        <div>
                            <label class="block text-sm font-semibold text-gray-300 mb-2">HVAC System Type</label>
                            <select id="hvacType" 
                                    class="w-full bg-gray-700 border border-gray-600 rounded-lg px-3 py-2 text-white focus:border-blue-500 focus:outline-none">
                                <option value="">Select System Type</option>
                                <option value="central-ac">Central Air Conditioning</option>
                                <option value="chiller">Chiller System</option>
                                <option value="rooftop">Rooftop Units</option>
                                <option value="heat-pump">Heat Pump</option>
                                <option value="vrf">VRF System</option>
                                <option value="split">Split System</option>
                                <option value="other">Other</option>
                            </select>
                        </div>
                        
                        <div>
                            <label class="block text-sm font-semibold text-gray-300 mb-2">Last Maintenance Date</label>
                            <input type="date" id="lastMaintenance" 
                                   class="w-full bg-gray-700 border border-gray-600 rounded-lg px-3 py-2 text-white focus:border-blue-500 focus:outline-none">
                        </div>
                        
                        <div>
                            <label class="block text-sm font-semibold text-gray-300 mb-2">Notes</label>
                            <textarea id="notes" rows="3" 
                                      class="w-full bg-gray-700 border border-gray-600 rounded-lg px-3 py-2 text-white focus:border-blue-500 focus:outline-none"
                                      placeholder="HVAC concerns, energy costs, maintenance issues..."></textarea>
                        </div>
                        
                        <!-- Action Buttons -->
                        <div class="flex space-x-3 pt-4">
                            <button type="submit" 
                                    class="flex-1 bg-blue-600 hover:bg-blue-700 text-white py-3 px-4 rounded-lg font-semibold transition-colors">
                                <i class="fas fa-save mr-2"></i>Save Lead
                            </button>
                            <button type="button" class="close-lead-form flex-1 bg-gray-600 hover:bg-gray-700 text-white py-3 px-4 rounded-lg font-semibold transition-colors">
                                Cancel
                            </button>
                        </div>
                    </form>
                </div>
            `;
            
            document.body.appendChild(modal);
            
            // Setup event handlers
            modal.querySelectorAll('.close-lead-form').forEach(function(btn) {
                btn.addEventListener('click', function() {
                    document.body.removeChild(modal);
                });
            });
            
            modal.addEventListener('click', function(e) {
                if (e.target === modal) {
                    document.body.removeChild(modal);
                }
            });
            
            // Handle form submission
            document.getElementById('leadEntryForm').addEventListener('submit', function(e) {
                e.preventDefault();
                saveLead();
            });
            
            // Focus first input
            setTimeout(function() {
                document.getElementById('companyName').focus();
            }, 100);
        }
        
        function saveLead() {
            // Get form data
            var leadData = {
                companyName: document.getElementById('companyName').value,
                firstName: document.getElementById('firstName').value,
                lastName: document.getElementById('lastName').value,
                jobTitle: document.getElementById('jobTitle').value,
                phone: document.getElementById('phone').value,
                email: document.getElementById('email').value,
                hvacType: document.getElementById('hvacType').value,
                lastMaintenance: document.getElementById('lastMaintenance').value,
                notes: document.getElementById('notes').value,
                dateAdded: new Date().toISOString()
            };
            
            console.log('💾 Saving lead:', leadData);
            
            // Store in localStorage for now (in production, send to backend)
            var leads = JSON.parse(localStorage.getItem('prospectorLeads') || '[]');
            leads.push(leadData);
            localStorage.setItem('prospectorLeads', JSON.stringify(leads));
            
            // Show success message
            alert('✅ Lead Saved Successfully!\n\n' +
                  'Company: ' + leadData.companyName + '\n' +
                  'Contact: ' + leadData.firstName + ' ' + leadData.lastName + '\n' +
                  'Phone: ' + leadData.phone + '\n\n' +
                  'Lead has been added to your ProSpector Pro pipeline.');
            
            // Close modal
            var modal = document.querySelector('.fixed.inset-0');
            if (modal) {
                document.body.removeChild(modal);
            }
        }
        
        function openImportCSVDialog() {
            // Create file input dialog
            var input = document.createElement('input');
            input.type = 'file';
            input.accept = '.csv,.txt';
            input.style.display = 'none';
            
            input.onchange = function(e) {
                var file = e.target.files[0];
                if (file) {
                    console.log('📄 Processing CSV file:', file.name);
                    
                    var reader = new FileReader();
                    reader.onload = function(e) {
                        var csvData = e.target.result;
                        processCSVImport(csvData, file.name);
                    };
                    reader.readAsText(file);
                }
            };
            
            document.body.appendChild(input);
            input.click();
            document.body.removeChild(input);
        }
        
        function processCSVImport(csvData, fileName) {
            // Parse CSV data
            var lines = csvData.split('\n');
            var headers = lines[0].split(',').map(function(h) { return h.trim(); });
            var leads = [];
            
            for (var i = 1; i < lines.length; i++) {
                if (lines[i].trim()) {
                    var values = lines[i].split(',').map(function(v) { return v.trim(); });
                    var lead = {};
                    
                    for (var j = 0; j < headers.length; j++) {
                        lead[headers[j]] = values[j] || '';
                    }
                    lead.dateAdded = new Date().toISOString();
                    lead.source = 'CSV Import: ' + fileName;
                    leads.push(lead);
                }
            }
            
            // Save imported leads
            var existingLeads = JSON.parse(localStorage.getItem('prospectorLeads') || '[]');
            var allLeads = existingLeads.concat(leads);
            localStorage.setItem('prospectorLeads', JSON.stringify(allLeads));
            
            console.log('📊 Imported', leads.length, 'leads from', fileName);
            
            // Show success message
            alert('✅ CSV Import Successful!\n\n' +
                  'File: ' + fileName + '\n' +
                  'Imported: ' + leads.length + ' leads\n' +
                  'Headers: ' + headers.join(', ') + '\n\n' +
                  'All leads have been added to your ProSpector Pro pipeline.');
        }
        
        // Calendar functions that work on mobile (copied from mobile-calendar.html)
        function openGoogleCalendar() {
            console.log('📅 Opening Google Calendar...');
            
            // Mobile-friendly approach (same as working mobile test page)
            if (/iPhone|iPad|iPod|Android/i.test(navigator.userAgent)) {
                console.log('📱 Mobile detected - using location.href for Google');
                window.location.href = 'https://accounts.google.com/signin';
            } else {
                console.log('🖥️ Desktop detected - using window.open for Google');
                window.open('https://accounts.google.com/signin', '_blank');
            }
        }
        
        function openMicrosoftCalendar() {
            console.log('📅 Opening Microsoft Outlook...');
            
            if (/iPhone|iPad|iPod|Android/i.test(navigator.userAgent)) {
                console.log('📱 Mobile detected - using location.href for Microsoft');
                window.location.href = 'https://login.microsoftonline.com/';
            } else {
                console.log('🖥️ Desktop detected - using window.open for Microsoft');
                window.open('https://login.microsoftonline.com/', '_blank');
            }
        }
        
        // Simple appointment modal function for main app
        function openScheduleModal() {
            console.log('Opening schedule modal...');
            
            var modal = document.createElement('div');
            modal.className = 'fixed inset-0 bg-black bg-opacity-80 z-50 flex items-center justify-center p-4';
            modal.id = 'appointment-modal';
            
            var modalHTML = '<div class="bg-slate-800 rounded-2xl p-6 w-full max-w-lg mx-auto border border-slate-600 shadow-2xl max-h-screen overflow-y-auto">';
            modalHTML += '<div class="flex items-center justify-between mb-6">';
            modalHTML += '<h3 class="text-xl font-bold text-blue-400">Schedule HVAC Appointment</h3>';
            modalHTML += '<button onclick="closeModal()" class="text-slate-400 hover:text-white text-2xl">×</button>';
            modalHTML += '</div>';
            modalHTML += '<form class="space-y-4">';
            modalHTML += '<div class="grid grid-cols-1 gap-4">';
            modalHTML += '<div><label class="block text-sm font-medium text-slate-300 mb-2">Customer Name *</label>';
            modalHTML += '<input type="text" required class="w-full px-3 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white focus:border-blue-500"></div>';
            modalHTML += '<div><label class="block text-sm font-medium text-slate-300 mb-2">Phone Number *</label>';
            modalHTML += '<input type="tel" required class="w-full px-3 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white focus:border-blue-500"></div>';
            modalHTML += '</div>';
            modalHTML += '<div><label class="block text-sm font-medium text-slate-300 mb-2">Service Address *</label>';
            modalHTML += '<input type="text" required class="w-full px-3 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white focus:border-blue-500" placeholder="123 Main St, City, State, ZIP"></div>';
            modalHTML += '<div class="grid grid-cols-1 md:grid-cols-2 gap-4">';
            modalHTML += '<div><label class="block text-sm font-medium text-slate-300 mb-2">Date *</label>';
            modalHTML += '<input type="date" required class="w-full px-3 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white focus:border-blue-500" min="' + new Date().toISOString().split('T')[0] + '"></div>';
            modalHTML += '<div><label class="block text-sm font-medium text-slate-300 mb-2">Time *</label>';
            modalHTML += '<select required class="w-full px-3 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white focus:border-blue-500">';
            modalHTML += '<option value="">Select time...</option>';
            modalHTML += '<option value="08:00">8:00 AM</option>';
            modalHTML += '<option value="10:00">10:00 AM</option>';
            modalHTML += '<option value="12:00">12:00 PM</option>';
            modalHTML += '<option value="14:00">2:00 PM</option>';
            modalHTML += '<option value="16:00">4:00 PM</option>';
            modalHTML += '</select></div></div>';
            modalHTML += '<div><label class="block text-sm font-medium text-slate-300 mb-2">Service Type *</label>';
            modalHTML += '<select required class="w-full px-3 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white focus:border-blue-500">';
            modalHTML += '<option value="">Select service...</option>';
            modalHTML += '<option value="maintenance">Routine Maintenance</option>';
            modalHTML += '<option value="repair">Repair Service</option>';
            modalHTML += '<option value="installation">New Installation</option>';
            modalHTML += '<option value="emergency">Emergency Service</option>';
            modalHTML += '</select></div>';
            modalHTML += '<div><label class="block text-sm font-medium text-slate-300 mb-2">Notes</label>';
            modalHTML += '<textarea rows="3" class="w-full px-3 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white focus:border-blue-500" placeholder="Additional details..."></textarea></div>';
            modalHTML += '<div class="flex space-x-3 pt-4">';
            modalHTML += '<button type="button" onclick="submitAppointment()" class="flex-1 bg-green-600 hover:bg-green-700 text-white py-3 px-4 rounded-lg font-semibold">Schedule Appointment</button>';
            modalHTML += '<button type="button" onclick="closeModal()" class="px-4 py-3 border border-slate-600 text-slate-300 rounded-lg">Cancel</button>';
            modalHTML += '</div></form></div>';
            
            modal.innerHTML = modalHTML;
            document.body.appendChild(modal);
            
            // Click outside to close
            modal.addEventListener('click', function(e) {
                if (e.target === modal) closeModal();
            });
        }
        
        function closeModal() {
            var modal = document.getElementById('appointment-modal');
            if (modal) modal.remove();
        }
        
        function submitAppointment() {
            alert('✅ Appointment Scheduled Successfully!\n\nYour HVAC appointment has been scheduled.\nThis would sync with your calendar in the full application.');
            closeModal();
        }
        
        // Research modal function
        function openResearchModal() {
            console.log('Opening research modal...');
            
            var modal = document.createElement('div');
            modal.className = 'fixed inset-0 bg-black bg-opacity-80 z-50 flex items-center justify-center p-4';
            modal.id = 'research-modal';
            
            var modalHTML = '<div class="bg-slate-800 rounded-2xl p-6 w-full max-w-lg mx-auto border border-slate-600 shadow-2xl max-h-screen overflow-y-auto">';
            modalHTML += '<div class="flex items-center justify-between mb-6">';
            modalHTML += '<h3 class="text-xl font-bold text-blue-400">Company Intelligence Research</h3>';
            modalHTML += '<button onclick="closeResearchModal()" class="text-slate-400 hover:text-white text-2xl">×</button>';
            modalHTML += '</div>';
            modalHTML += '<form class="space-y-4">';
            modalHTML += '<div><label class="block text-sm font-medium text-slate-300 mb-2">Company Name *</label>';
            modalHTML += '<input type="text" required class="w-full px-3 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white focus:border-blue-500" placeholder="Enter company name..."></div>';
            modalHTML += '<div><label class="block text-sm font-medium text-slate-300 mb-2">Website (Optional)</label>';
            modalHTML += '<input type="url" class="w-full px-3 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white focus:border-blue-500" placeholder="https://company.com"></div>';
            modalHTML += '<div><label class="block text-sm font-medium text-slate-300 mb-2">Research Focus</label>';
            modalHTML += '<select class="w-full px-3 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white focus:border-blue-500">';
            modalHTML += '<option value="general">General Company Info</option>';
            modalHTML += '<option value="hvac">HVAC Equipment & Needs</option>';
            modalHTML += '<option value="decision-makers">Decision Makers</option>';
            modalHTML += '<option value="competitors">Competitor Analysis</option>';
            modalHTML += '</select></div>';
            modalHTML += '<div class="flex space-x-3 pt-4">';
            modalHTML += '<button type="button" onclick="startResearch()" class="flex-1 bg-blue-600 hover:bg-blue-700 text-white py-3 px-4 rounded-lg font-semibold">Start Research</button>';
            modalHTML += '<button type="button" onclick="closeResearchModal()" class="px-4 py-3 border border-slate-600 text-slate-300 rounded-lg">Cancel</button>';
            modalHTML += '</div></form></div>';
            
            modal.innerHTML = modalHTML;
            document.body.appendChild(modal);
            
            modal.addEventListener('click', function(e) {
                if (e.target === modal) closeResearchModal();
            });
        }
        
        // Contact enrichment modal function
        function openEnrichmentModal() {
            console.log('Opening enrichment modal...');
            
            var modal = document.createElement('div');
            modal.className = 'fixed inset-0 bg-black bg-opacity-80 z-50 flex items-center justify-center p-4';
            modal.id = 'enrichment-modal';
            
            var modalHTML = '<div class="bg-slate-800 rounded-2xl p-6 w-full max-w-lg mx-auto border border-slate-600 shadow-2xl max-h-screen overflow-y-auto">';
            modalHTML += '<div class="flex items-center justify-between mb-6">';
            modalHTML += '<h3 class="text-xl font-bold text-green-400">Contact Enrichment</h3>';
            modalHTML += '<button onclick="closeEnrichmentModal()" class="text-slate-400 hover:text-white text-2xl">×</button>';
            modalHTML += '</div>';
            modalHTML += '<form class="space-y-4">';
            modalHTML += '<div><label class="block text-sm font-medium text-slate-300 mb-2">Contact Name *</label>';
            modalHTML += '<input type="text" required class="w-full px-3 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white focus:border-blue-500" placeholder="John Smith"></div>';
            modalHTML += '<div><label class="block text-sm font-medium text-slate-300 mb-2">Company Name *</label>';
            modalHTML += '<input type="text" required class="w-full px-3 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white focus:border-blue-500" placeholder="HVAC Solutions Inc."></div>';
            modalHTML += '<div><label class="block text-sm font-medium text-slate-300 mb-2">Email (if known)</label>';
            modalHTML += '<input type="email" class="w-full px-3 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white focus:border-blue-500" placeholder="john@company.com"></div>';
            modalHTML += '<div><label class="block text-sm font-medium text-slate-300 mb-2">LinkedIn Profile (if known)</label>';
            modalHTML += '<input type="url" class="w-full px-3 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white focus:border-blue-500" placeholder="https://linkedin.com/in/johnsmith"></div>';
            modalHTML += '<div><label class="block text-sm font-medium text-slate-300 mb-2">Enrichment Type</label>';
            modalHTML += '<select class="w-full px-3 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white focus:border-blue-500">';
            modalHTML += '<option value="full">Full Contact Profile</option>';
            modalHTML += '<option value="email">Email Finding</option>';
            modalHTML += '<option value="phone">Phone Number</option>';
            modalHTML += '<option value="social">Social Profiles</option>';
            modalHTML += '</select></div>';
            modalHTML += '<div class="flex space-x-3 pt-4">';
            modalHTML += '<button type="button" onclick="startEnrichment()" class="flex-1 bg-green-600 hover:bg-green-700 text-white py-3 px-4 rounded-lg font-semibold">Enrich Contact</button>';
            modalHTML += '<button type="button" onclick="closeEnrichmentModal()" class="px-4 py-3 border border-slate-600 text-slate-300 rounded-lg">Cancel</button>';
            modalHTML += '</div></form></div>';
            
            modal.innerHTML = modalHTML;
            document.body.appendChild(modal);
            
            modal.addEventListener('click', function(e) {
                if (e.target === modal) closeEnrichmentModal();
            });
        }
        
        function closeResearchModal() {
            var modal = document.getElementById('research-modal');
            if (modal) modal.remove();
        }
        
        function closeEnrichmentModal() {
            var modal = document.getElementById('enrichment-modal');
            if (modal) modal.remove();
        }
        
        function startResearch() {
            alert('🔍 Research Started!\n\nCompany intelligence research initiated.\nThis would gather detailed company information, technographics, and decision-maker insights in the full application.');
            closeResearchModal();
        }
        
        function startEnrichment() {
            alert('✨ Contact Enrichment Started!\n\nContact data enrichment initiated.\nThis would find email, phone, social profiles, and job details in the full application.');
            closeEnrichmentModal();
        }
        
        // AI Prospect Research Functions
        function researchProspect(name, meeting, time) {
            console.log('Starting AI research for:', name);
            
            var modal = document.createElement('div');
            modal.className = 'fixed inset-0 bg-black bg-opacity-90 z-50 flex items-center justify-center p-4';
            modal.id = 'ai-research-modal';
            
            var modalHTML = '<div class="bg-slate-800 rounded-2xl p-6 w-full max-w-4xl mx-auto border border-purple-600 shadow-2xl max-h-screen overflow-y-auto">';
            modalHTML += '<div class="flex items-center justify-between mb-6">';
            modalHTML += '<h3 class="text-2xl font-bold text-purple-400">🤖 AI Prospect Research: ' + name + '</h3>';
            modalHTML += '<button onclick="closeAIResearchModal()" class="text-slate-400 hover:text-white text-2xl">×</button>';
            modalHTML += '</div>';
            
            modalHTML += '<div class="bg-purple-900/20 border border-purple-500/30 rounded-lg p-4 mb-6">';
            modalHTML += '<h4 class="text-lg font-bold text-purple-300 mb-2">📅 Appointment Details</h4>';
            modalHTML += '<p class="text-white"><strong>Meeting:</strong> ' + meeting + '</p>';
            modalHTML += '<p class="text-slate-300"><strong>Scheduled:</strong> ' + time + '</p>';
            modalHTML += '</div>';
            
            modalHTML += '<div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-6">';
            
            // Professional Background
            modalHTML += '<div class="bg-slate-700/50 rounded-lg p-4">';
            modalHTML += '<h4 class="text-lg font-bold text-blue-400 mb-3">👤 Professional Background</h4>';
            modalHTML += '<div class="space-y-2 text-sm">';
            modalHTML += '<p><strong>Current Role:</strong> Facilities Manager at HVAC Solutions Inc.</p>';
            modalHTML += '<p><strong>Experience:</strong> 15+ years in facilities management</p>';
            modalHTML += '<p><strong>Previous Roles:</strong></p>';
            modalHTML += '<ul class="ml-4 text-slate-300">';
            modalHTML += '<li>• Senior Technician at Climate Control Pro (2015-2020)</li>';
            modalHTML += '<li>• HVAC Specialist at BuildTech Services (2010-2015)</li>';
            modalHTML += '</ul>';
            modalHTML += '<p><strong>Certifications:</strong> EPA 608 Universal, NATE Certified</p>';
            modalHTML += '</div></div>';
            
            // Facility Information  
            modalHTML += '<div class="bg-slate-700/50 rounded-lg p-4">';
            modalHTML += '<h4 class="text-lg font-bold text-green-400 mb-3">🏢 Facility Intelligence</h4>';
            modalHTML += '<div class="space-y-2 text-sm">';
            modalHTML += '<p><strong>Building:</strong> 50,000 sq ft office complex</p>';
            modalHTML += '<p><strong>HVAC Systems:</strong></p>';
            modalHTML += '<ul class="ml-4 text-slate-300">';
            modalHTML += '<li>• 5x Carrier rooftop units (installed 2018)</li>';
            modalHTML += '<li>• VRV system for executive floors</li>';
            modalHTML += '<li>• Building automation system (Honeywell)</li>';
            modalHTML += '</ul>';
            modalHTML += '<p><strong>Recent Issues:</strong> High energy costs, inconsistent temperatures</p>';
            modalHTML += '<p><strong>Budget Authority:</strong> Up to $25,000 for maintenance/repairs</p>';
            modalHTML += '</div></div>';
            
            // Social Media & Online Presence
            modalHTML += '<div class="bg-slate-700/50 rounded-lg p-4">';
            modalHTML += '<h4 class="text-lg font-bold text-yellow-400 mb-3">📱 Social Media & Online Presence</h4>';
            modalHTML += '<div class="space-y-2 text-sm">';
            modalHTML += '<p><strong>LinkedIn:</strong> Active poster about energy efficiency</p>';
            modalHTML += '<p><strong>Recent Posts:</strong></p>';
            modalHTML += '<ul class="ml-4 text-slate-300">';
            modalHTML += '<li>• "Struggling with HVAC efficiency this summer..." (2 days ago)</li>';
            modalHTML += '<li>• Shared article on preventive maintenance (1 week ago)</li>';
            modalHTML += '</ul>';
            modalHTML += '<p><strong>Professional Networks:</strong> BOMA, ASHRAE member</p>';
            modalHTML += '<p><strong>Online Reviews:</strong> Company rated 4.2/5 for facility management</p>';
            modalHTML += '</div></div>';
            
            // AI Preparation Insights
            modalHTML += '<div class="bg-slate-700/50 rounded-lg p-4">';
            modalHTML += '<h4 class="text-lg font-bold text-red-400 mb-3">🎯 AI Preparation Insights</h4>';
            modalHTML += '<div class="space-y-2 text-sm">';
            modalHTML += '<p><strong>Key Pain Points:</strong></p>';
            modalHTML += '<ul class="ml-4 text-slate-300">';
            modalHTML += '<li>• Rising energy costs (mentioned in recent LinkedIn post)</li>';
            modalHTML += '<li>• Equipment aging (rooftop units are 6 years old)</li>';
            modalHTML += '<li>• Temperature control issues</li>';
            modalHTML += '</ul>';
            modalHTML += '<p><strong>Recommended Approach:</strong></p>';
            modalHTML += '<ul class="ml-4 text-green-300">';
            modalHTML += '<li>• Lead with energy efficiency solutions</li>';
            modalHTML += '<li>• Mention preventive maintenance (his interest area)</li>';
            modalHTML += '<li>• Reference ASHRAE standards (he\'s a member)</li>';
            modalHTML += '<li>• Prepare ROI calculations for energy savings</li>';
            modalHTML += '</ul>';
            modalHTML += '</div></div>';
            
            modalHTML += '</div>';
            
            // Action Buttons
            modalHTML += '<div class="flex space-x-3 pt-4 border-t border-slate-600">';
            modalHTML += '<button onclick="generateTalkingPoints(\'' + name + '\')" class="flex-1 bg-purple-600 hover:bg-purple-700 text-white py-3 px-4 rounded-lg font-semibold">';
            modalHTML += '<i class="fas fa-lightbulb mr-2"></i>Generate Talking Points</button>';
            modalHTML += '<button onclick="createPreMeetingBrief(\'' + name + '\')" class="flex-1 bg-blue-600 hover:bg-blue-700 text-white py-3 px-4 rounded-lg font-semibold">';
            modalHTML += '<i class="fas fa-file-alt mr-2"></i>Pre-Meeting Brief</button>';
            modalHTML += '<button onclick="closeAIResearchModal()" class="px-4 py-3 border border-slate-600 text-slate-300 rounded-lg">Close</button>';
            modalHTML += '</div></div>';
            
            modal.innerHTML = modalHTML;
            document.body.appendChild(modal);
            
            modal.addEventListener('click', function(e) {
                if (e.target === modal) closeAIResearchModal();
            });
        }
        
        function openAIResearchDashboard() {
            console.log('Opening AI Research Dashboard...');
            
            var modal = document.createElement('div');
            modal.className = 'fixed inset-0 bg-black bg-opacity-90 z-50 flex items-center justify-center p-4';
            modal.id = 'ai-dashboard-modal';
            
            var modalHTML = '<div class="bg-slate-800 rounded-2xl p-6 w-full max-w-5xl mx-auto border border-purple-600 shadow-2xl max-h-screen overflow-y-auto">';
            modalHTML += '<div class="flex items-center justify-between mb-6">';
            modalHTML += '<h3 class="text-2xl font-bold text-purple-400">🤖 AI Research Dashboard</h3>';
            modalHTML += '<button onclick="closeAIDashboardModal()" class="text-slate-400 hover:text-white text-2xl">×</button>';
            modalHTML += '</div>';
            
            modalHTML += '<div class="grid grid-cols-1 md:grid-cols-3 gap-4 mb-6">';
            modalHTML += '<div class="bg-purple-900/30 border border-purple-500/50 rounded-lg p-4 text-center">';
            modalHTML += '<h4 class="text-lg font-bold text-purple-300">Research Queue</h4>';
            modalHTML += '<p class="text-3xl font-bold text-white mt-2">3</p>';
            modalHTML += '<p class="text-sm text-slate-400">Prospects to research</p>';
            modalHTML += '</div>';
            modalHTML += '<div class="bg-blue-900/30 border border-blue-500/50 rounded-lg p-4 text-center">';
            modalHTML += '<h4 class="text-lg font-bold text-blue-300">Completed</h4>';
            modalHTML += '<p class="text-3xl font-bold text-white mt-2">12</p>';
            modalHTML += '<p class="text-sm text-slate-400">Research reports</p>';
            modalHTML += '</div>';
            modalHTML += '<div class="bg-green-900/30 border border-green-500/50 rounded-lg p-4 text-center">';
            modalHTML += '<h4 class="text-lg font-bold text-green-300">Success Rate</h4>';
            modalHTML += '<p class="text-3xl font-bold text-white mt-2">94%</p>';
            modalHTML += '<p class="text-sm text-slate-400">Meeting success</p>';
            modalHTML += '</div></div>';
            
            modalHTML += '<div class="bg-slate-700/30 rounded-lg p-6">';
            modalHTML += '<h4 class="text-xl font-bold text-white mb-4">🎯 AI Research Capabilities</h4>';
            modalHTML += '<div class="grid grid-cols-1 md:grid-cols-2 gap-6">';
            modalHTML += '<div><h5 class="font-bold text-blue-400 mb-2">Professional Background</h5>';
            modalHTML += '<ul class="text-sm text-slate-300 space-y-1">';
            modalHTML += '<li>• Current role and responsibilities</li>';
            modalHTML += '<li>• Previous work history</li>';
            modalHTML += '<li>• Industry certifications</li>';
            modalHTML += '<li>• Professional achievements</li>';
            modalHTML += '</ul></div>';
            modalHTML += '<div><h5 class="font-bold text-green-400 mb-2">Facility Intelligence</h5>';
            modalHTML += '<ul class="text-sm text-slate-300 space-y-1">';
            modalHTML += '<li>• Building specifications</li>';
            modalHTML += '<li>• Current HVAC systems</li>';
            modalHTML += '<li>• Maintenance history</li>';
            modalHTML += '<li>• Energy consumption patterns</li>';
            modalHTML += '</ul></div>';
            modalHTML += '<div><h5 class="font-bold text-yellow-400 mb-2">Social Media Analysis</h5>';
            modalHTML += '<ul class="text-sm text-slate-300 space-y-1">';
            modalHTML += '<li>• LinkedIn posts and activity</li>';
            modalHTML += '<li>• Professional network connections</li>';
            modalHTML += '<li>• Industry forum participation</li>';
            modalHTML += '<li>• Recent concerns or interests</li>';
            modalHTML += '</ul></div>';
            modalHTML += '<div><h5 class="font-bold text-red-400 mb-2">Strategic Insights</h5>';
            modalHTML += '<ul class="text-sm text-slate-300 space-y-1">';
            modalHTML += '<li>• Pain point identification</li>';
            modalHTML += '<li>• Decision-making authority</li>';
            modalHTML += '<li>• Budget and timeline insights</li>';
            modalHTML += '<li>• Personalized talking points</li>';
            modalHTML += '</ul></div>';
            modalHTML += '</div></div>';
            
            modalHTML += '<div class="flex space-x-3 pt-6 border-t border-slate-600">';
            modalHTML += '<button onclick="startBulkResearch()" class="flex-1 bg-purple-600 hover:bg-purple-700 text-white py-3 px-4 rounded-lg font-semibold">';
            modalHTML += '<i class="fas fa-robot mr-2"></i>Start Bulk AI Research</button>';
            modalHTML += '<button onclick="viewResearchHistory()" class="flex-1 bg-blue-600 hover:bg-blue-700 text-white py-3 px-4 rounded-lg font-semibold">';
            modalHTML += '<i class="fas fa-history mr-2"></i>Research History</button>';
            modalHTML += '<button onclick="closeAIDashboardModal()" class="px-4 py-3 border border-slate-600 text-slate-300 rounded-lg">Close</button>';
            modalHTML += '</div></div>';
            
            modal.innerHTML = modalHTML;
            document.body.appendChild(modal);
            
            modal.addEventListener('click', function(e) {
                if (e.target === modal) closeAIDashboardModal();
            });
        }
        
        function closeAIResearchModal() {
            var modal = document.getElementById('ai-research-modal');
            if (modal) modal.remove();
        }
        
        function closeAIDashboardModal() {
            var modal = document.getElementById('ai-dashboard-modal');
            if (modal) modal.remove();
        }
        
        function generateTalkingPoints(name) {
            alert('💡 AI Talking Points Generated!\n\n✅ Key Points for ' + name + ':\n• Lead with energy efficiency (his main concern)\n• Reference ASHRAE standards (professional interest)\n• Mention preventive maintenance ROI\n• Prepare cost-per-sq-ft calculations\n• Discuss building automation integration\n\n🎯 This would generate personalized talking points in the full application.');
            closeAIResearchModal();
        }
        
        function createPreMeetingBrief(name) {
            alert('📄 Pre-Meeting Brief Created!\n\n✅ Comprehensive brief for ' + name + ' includes:\n• Executive summary of research findings\n• Facility overview and current systems\n• Key pain points and opportunities\n• Recommended solutions and pricing\n• Conversation starters and questions\n\n📧 This would be emailed to you in the full application.');
            closeAIResearchModal();
        }
        
        function startBulkResearch() {
            alert('🤖 Bulk AI Research Started!\n\n✅ Initiating comprehensive research for all upcoming appointments:\n• John Smith (HVAC System Consultation)\n• Sarah Johnson (Maintenance Quote Meeting)\n• Mike Wilson (Follow-up Call)\n\n📊 Research will complete in 5-10 minutes and you\'ll be notified when ready.');
            closeAIDashboardModal();
        }
        
        function viewResearchHistory() {
            alert('📚 Research History\n\n✅ Recent AI research completed:\n• Michael Chen (Energy Systems Corp) - 92% match\n• Lisa Rodriguez (Facility Pro Inc) - 96% match\n• David Park (BuildSmart Solutions) - 89% match\n\n🎯 This would show detailed research history in the full application.');
        }
        
        // AI Call Analysis Functions
        function logNewCall() {
            console.log('Opening new call logging modal...');
            
            var modal = document.createElement('div');
            modal.className = 'fixed inset-0 bg-black bg-opacity-90 z-50 flex items-center justify-center p-4';
            modal.id = 'call-log-modal';
            
            var modalHTML = '<div class="bg-slate-800 rounded-2xl p-6 w-full max-w-4xl mx-auto border border-green-600 shadow-2xl max-h-screen overflow-y-auto">';
            modalHTML += '<div class="flex items-center justify-between mb-6">';
            modalHTML += '<h3 class="text-2xl font-bold text-green-400">📞 Log New Call & AI Analysis</h3>';
            modalHTML += '<button onclick="closeCallLogModal()" class="text-slate-400 hover:text-white text-2xl">×</button>';
            modalHTML += '</div>';
            
            modalHTML += '<form class="space-y-6">';
            
            // Basic Call Info
            modalHTML += '<div class="grid grid-cols-1 md:grid-cols-2 gap-4">';
            modalHTML += '<div><label class="block text-sm font-medium text-slate-300 mb-2">Prospect Name *</label>';
            modalHTML += '<input type="text" required class="w-full px-3 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white focus:border-green-500" placeholder="John Smith"></div>';
            modalHTML += '<div><label class="block text-sm font-medium text-slate-300 mb-2">Company *</label>';
            modalHTML += '<input type="text" required class="w-full px-3 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white focus:border-green-500" placeholder="HVAC Solutions Inc."></div>';
            modalHTML += '</div>';
            
            modalHTML += '<div class="grid grid-cols-1 md:grid-cols-3 gap-4">';
            modalHTML += '<div><label class="block text-sm font-medium text-slate-300 mb-2">Call Duration</label>';
            modalHTML += '<select class="w-full px-3 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white focus:border-green-500">';
            modalHTML += '<option value="1-2">1-2 minutes</option><option value="3-5">3-5 minutes</option><option value="6-10">6-10 minutes</option><option value="10+">10+ minutes</option>';
            modalHTML += '</select></div>';
            modalHTML += '<div><label class="block text-sm font-medium text-slate-300 mb-2">Call Outcome</label>';
            modalHTML += '<select class="w-full px-3 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white focus:border-green-500">';
            modalHTML += '<option value="appointment">Appointment Scheduled</option><option value="followup">Follow-up Needed</option><option value="callback">Callback Requested</option><option value="not-interested">Not Interested</option><option value="voicemail">Voicemail Left</option><option value="wrong-number">Wrong Number</option>';
            modalHTML += '</select></div>';
            modalHTML += '<div><label class="block text-sm font-medium text-slate-300 mb-2">Interest Level</label>';
            modalHTML += '<select class="w-full px-3 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white focus:border-green-500">';
            modalHTML += '<option value="high">High Interest</option><option value="medium">Medium Interest</option><option value="low">Low Interest</option><option value="none">No Interest</option>';
            modalHTML += '</select></div>';
            modalHTML += '</div>';
            
            // Detailed Call Notes
            modalHTML += '<div><label class="block text-sm font-medium text-slate-300 mb-2">Call Summary & Key Points</label>';
            modalHTML += '<textarea rows="4" class="w-full px-3 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white focus:border-green-500" placeholder="Summarize the conversation, key points discussed, prospect responses, and any important details..."></textarea></div>';
            
            // Pain Points & Needs
            modalHTML += '<div class="grid grid-cols-1 md:grid-cols-2 gap-4">';
            modalHTML += '<div><label class="block text-sm font-medium text-slate-300 mb-2">Pain Points Identified</label>';
            modalHTML += '<textarea rows="3" class="w-full px-3 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white focus:border-green-500" placeholder="What challenges or issues did the prospect mention?"></textarea></div>';
            modalHTML += '<div><label class="block text-sm font-medium text-slate-300 mb-2">HVAC Needs/Interests</label>';
            modalHTML += '<textarea rows="3" class="w-full px-3 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white focus:border-green-500" placeholder="What HVAC services or solutions were they interested in?"></textarea></div>';
            modalHTML += '</div>';
            
            // Objections & Responses
            modalHTML += '<div><label class="block text-sm font-medium text-slate-300 mb-2">Objections Raised & Your Responses</label>';
            modalHTML += '<textarea rows="3" class="w-full px-3 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white focus:border-green-500" placeholder="What objections did they raise? How did you respond? What worked or didn\'t work?"></textarea></div>';
            
            // Next Steps
            modalHTML += '<div><label class="block text-sm font-medium text-slate-300 mb-2">Next Steps & Follow-up Actions</label>';
            modalHTML += '<textarea rows="2" class="w-full px-3 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white focus:border-green-500" placeholder="What are the next steps? When to follow up? What to prepare for next contact?"></textarea></div>';
            
            // AI Analysis Options
            modalHTML += '<div class="bg-purple-900/20 border border-purple-500/30 rounded-lg p-4">';
            modalHTML += '<h4 class="text-lg font-bold text-purple-300 mb-3">🤖 AI Analysis Options</h4>';
            modalHTML += '<div class="grid grid-cols-1 md:grid-cols-2 gap-3">';
            modalHTML += '<label class="flex items-center"><input type="checkbox" checked class="mr-2"> Sentiment Analysis</label>';
            modalHTML += '<label class="flex items-center"><input type="checkbox" checked class="mr-2"> Objection Pattern Recognition</label>';
            modalHTML += '<label class="flex items-center"><input type="checkbox" checked class="mr-2"> Success Factor Analysis</label>';
            modalHTML += '<label class="flex items-center"><input type="checkbox" checked class="mr-2"> Improvement Recommendations</label>';
            modalHTML += '</div></div>';
            
            modalHTML += '<div class="flex space-x-3 pt-4 border-t border-slate-600">';
            modalHTML += '<button type="button" onclick="saveCallWithAI()" class="flex-1 bg-green-600 hover:bg-green-700 text-white py-3 px-4 rounded-lg font-semibold">';
            modalHTML += '<i class="fas fa-robot mr-2"></i>Save & Run AI Analysis</button>';
            modalHTML += '<button type="button" onclick="saveCallQuick()" class="px-4 py-3 bg-blue-600 hover:bg-blue-700 text-white rounded-lg">Quick Save</button>';
            modalHTML += '<button type="button" onclick="closeCallLogModal()" class="px-4 py-3 border border-slate-600 text-slate-300 rounded-lg">Cancel</button>';
            modalHTML += '</div></form></div>';
            
            modal.innerHTML = modalHTML;
            document.body.appendChild(modal);
            
            modal.addEventListener('click', function(e) {
                if (e.target === modal) closeCallLogModal();
            });
        }
        
        function openCallAnalyticsDashboard() {
            console.log('Opening call analytics dashboard...');
            
            var modal = document.createElement('div');
            modal.className = 'fixed inset-0 bg-black bg-opacity-90 z-50 flex items-center justify-center p-4';
            modal.id = 'call-analytics-modal';
            
            var modalHTML = '<div class="bg-slate-800 rounded-2xl p-6 w-full max-w-6xl mx-auto border border-purple-600 shadow-2xl max-h-screen overflow-y-auto">';
            modalHTML += '<div class="flex items-center justify-between mb-6">';
            modalHTML += '<h3 class="text-2xl font-bold text-purple-400">📊 AI Call Analytics Dashboard</h3>';
            modalHTML += '<button onclick="closeCallAnalyticsModal()" class="text-slate-400 hover:text-white text-2xl">×</button>';
            modalHTML += '</div>';
            
            // Key Metrics
            modalHTML += '<div class="grid grid-cols-2 md:grid-cols-4 gap-4 mb-6">';
            modalHTML += '<div class="bg-green-900/30 border border-green-500/50 rounded-lg p-4 text-center">';
            modalHTML += '<h4 class="text-lg font-bold text-green-300">Total Calls</h4>';
            modalHTML += '<p class="text-3xl font-bold text-white mt-2">247</p>';
            modalHTML += '<p class="text-sm text-slate-400">This month</p></div>';
            modalHTML += '<div class="bg-blue-900/30 border border-blue-500/50 rounded-lg p-4 text-center">';
            modalHTML += '<h4 class="text-lg font-bold text-blue-300">Appointments</h4>';
            modalHTML += '<p class="text-3xl font-bold text-white mt-2">52</p>';
            modalHTML += '<p class="text-sm text-slate-400">21% conversion</p></div>';
            modalHTML += '<div class="bg-yellow-900/30 border border-yellow-500/50 rounded-lg p-4 text-center">';
            modalHTML += '<h4 class="text-lg font-bold text-yellow-300">Avg Call Score</h4>';
            modalHTML += '<p class="text-3xl font-bold text-white mt-2">73%</p>';
            modalHTML += '<p class="text-sm text-slate-400">AI analysis</p></div>';
            modalHTML += '<div class="bg-red-900/30 border border-red-500/50 rounded-lg p-4 text-center">';
            modalHTML += '<h4 class="text-lg font-bold text-red-300">Top Objection</h4>';
            modalHTML += '<p class="text-lg font-bold text-white mt-2">Price</p>';
            modalHTML += '<p class="text-sm text-slate-400">34% of calls</p></div>';
            modalHTML += '</div>';
            
            // AI Insights
            modalHTML += '<div class="bg-slate-700/30 rounded-lg p-6 mb-6">';
            modalHTML += '<h4 class="text-xl font-bold text-white mb-4">🧠 AI Performance Insights</h4>';
            modalHTML += '<div class="grid grid-cols-1 md:grid-cols-2 gap-6">';
            modalHTML += '<div><h5 class="font-bold text-green-400 mb-2">Top Success Factors</h5>';
            modalHTML += '<ul class="text-sm text-slate-300 space-y-1">';
            modalHTML += '<li>• Mentioning energy savings first (+23% success)</li>';
            modalHTML += '<li>• Calls between 10-11 AM (+18% success)</li>';
            modalHTML += '<li>• Using prospect\'s name 3+ times (+15% success)</li>';
            modalHTML += '<li>• Discussing preventive maintenance (+12% success)</li>';
            modalHTML += '</ul></div>';
            modalHTML += '<div><h5 class="font-bold text-red-400 mb-2">Improvement Opportunities</h5>';
            modalHTML += '<ul class="text-sm text-slate-300 space-y-1">';
            modalHTML += '<li>• Handle price objections better (-15% when mentioned)</li>';
            modalHTML += '<li>• Reduce call length for higher success (-8% after 8 min)</li>';
            modalHTML += '<li>• Improve follow-up timing (32% no response)</li>';
            modalHTML += '<li>• Use more social proof examples (+potential 10%)</li>';
            modalHTML += '</ul></div>';
            modalHTML += '</div></div>';
            
            // Recent Call Analysis
            modalHTML += '<div class="bg-slate-700/30 rounded-lg p-6">';
            modalHTML += '<h4 class="text-xl font-bold text-white mb-4">📞 Recent Call Analysis</h4>';
            modalHTML += '<div class="space-y-3">';
            modalHTML += '<div class="p-4 bg-slate-800/50 rounded-lg">';
            modalHTML += '<div class="flex justify-between items-start mb-2">';
            modalHTML += '<h5 class="font-bold text-white">John Smith - HVAC Solutions Inc.</h5>';
            modalHTML += '<span class="px-3 py-1 bg-green-600 text-white text-sm rounded-full">94% Score</span></div>';
            modalHTML += '<p class="text-sm text-slate-400 mb-2">Today, 2:15 PM • 8 min call • Appointment Scheduled</p>';
            modalHTML += '<div class="grid grid-cols-2 gap-4 text-sm">';
            modalHTML += '<div><strong class="text-green-400">Positive:</strong> Great rapport building, addressed energy concerns effectively</div>';
            modalHTML += '<div><strong class="text-yellow-400">Improve:</strong> Could have mentioned maintenance packages sooner</div>';
            modalHTML += '</div></div>';
            modalHTML += '<div class="p-4 bg-slate-800/50 rounded-lg">';
            modalHTML += '<div class="flex justify-between items-start mb-2">';
            modalHTML += '<h5 class="font-bold text-white">Sarah Johnson - Climate Control Pro</h5>';
            modalHTML += '<span class="px-3 py-1 bg-yellow-600 text-white text-sm rounded-full">72% Score</span></div>';
            modalHTML += '<p class="text-sm text-slate-400 mb-2">Yesterday, 4:20 PM • 5 min call • Follow-up Needed</p>';
            modalHTML += '<div class="grid grid-cols-2 gap-4 text-sm">';
            modalHTML += '<div><strong class="text-green-400">Positive:</strong> Good pain point identification, showed expertise</div>';
            modalHTML += '<div><strong class="text-red-400">Issue:</strong> Price objection not handled well, ended call too quickly</div>';
            modalHTML += '</div></div>';
            modalHTML += '</div></div>';
            
            modalHTML += '<div class="flex space-x-3 pt-6 border-t border-slate-600">';
            modalHTML += '<button onclick="generateCallReport()" class="flex-1 bg-purple-600 hover:bg-purple-700 text-white py-3 px-4 rounded-lg font-semibold">';
            modalHTML += '<i class="fas fa-chart-bar mr-2"></i>Generate Detailed Report</button>';
            modalHTML += '<button onclick="exportCallData()" class="flex-1 bg-blue-600 hover:bg-blue-700 text-white py-3 px-4 rounded-lg font-semibold">';
            modalHTML += '<i class="fas fa-download mr-2"></i>Export Data</button>';
            modalHTML += '<button onclick="closeCallAnalyticsModal()" class="px-4 py-3 border border-slate-600 text-slate-300 rounded-lg">Close</button>';
            modalHTML += '</div></div>';
            
            modal.innerHTML = modalHTML;
            document.body.appendChild(modal);
            
            modal.addEventListener('click', function(e) {
                if (e.target === modal) closeCallAnalyticsModal();
            });
        }
        
        function viewCallDetails(callId) {
            console.log('Viewing call details for:', callId);
            
            var callData = {
                'call-001': {
                    name: 'John Smith',
                    company: 'HVAC Solutions Inc.',
                    date: 'Today, 2:15 PM',
                    duration: '8 minutes',
                    outcome: 'Appointment Scheduled',
                    score: 94,
                    summary: 'Great call with strong rapport. Discussed energy efficiency concerns and scheduled consultation for tomorrow at 2:30 PM.',
                    painPoints: 'High energy bills, aging HVAC system (15 years old), inconsistent temperatures',
                    objections: 'Initial concern about cost, addressed with energy savings calculations',
                    nextSteps: 'Site visit scheduled for tomorrow. Prepare energy audit tools and maintenance package options.'
                },
                'call-002': {
                    name: 'Sarah Johnson',
                    company: 'Climate Control Pro',
                    date: 'Yesterday, 4:20 PM',
                    duration: '5 minutes',
                    outcome: 'Follow-up Needed',
                    score: 72,
                    summary: 'Interested prospect but price-sensitive. Needs to discuss with management before proceeding.',
                    painPoints: 'Frequent breakdowns, high repair costs, need for reliable service provider',
                    objections: 'Budget constraints, needs approval from facilities director',
                    nextSteps: 'Follow up in 2 days. Prepare cost comparison with current service provider.'
                }
            };
            
            var data = callData[callId] || callData['call-001'];
            
            alert('📞 Call Details: ' + data.name + '\n\n' +
                  '🏢 Company: ' + data.company + '\n' +
                  '📅 Date: ' + data.date + '\n' +
                  '⏱️ Duration: ' + data.duration + '\n' +
                  '✅ Outcome: ' + data.outcome + '\n' +
                  '📊 AI Score: ' + data.score + '%\n\n' +
                  '📝 Summary: ' + data.summary + '\n\n' +
                  '😰 Pain Points: ' + data.painPoints + '\n\n' +
                  '❌ Objections: ' + data.objections + '\n\n' +
                  '⏭️ Next Steps: ' + data.nextSteps + '\n\n' +
                  '🎯 This would show the complete call analysis in the full application.');
        }
        
        function closeCallLogModal() {
            var modal = document.getElementById('call-log-modal');
            if (modal) modal.remove();
        }
        
        function closeCallAnalyticsModal() {
            var modal = document.getElementById('call-analytics-modal');
            if (modal) modal.remove();
        }
        
        function saveCallWithAI() {
            alert('🤖 AI Call Analysis Complete!\n\n✅ Call logged and analyzed:\n• Sentiment analysis: Positive (78%)\n• Key success factors identified\n• Objection patterns recognized\n• Personalized improvement recommendations generated\n• Next call strategy created\n\n📊 AI Score: 87% - Above average performance\n\n📈 Recommendation: Focus on energy savings earlier in next calls for better results.');
            closeCallLogModal();
        }
        
        function saveCallQuick() {
            alert('✅ Call Saved!\n\nCall details have been logged. You can run AI analysis later from the Call Analytics Dashboard.');
            closeCallLogModal();
        }
        
        function generateCallReport() {
            alert('📊 Generating Comprehensive Call Report...\n\n✅ Report will include:\n• Performance trends and metrics\n• AI-identified success patterns\n• Objection handling analysis\n• Conversion rate by time/approach\n• Personalized coaching recommendations\n• Competitor mention analysis\n\n📧 Full report will be emailed to you in 5 minutes.');
        }
        
        function exportCallData() {
            alert('📥 Exporting Call Data...\n\n✅ Preparing export with:\n• All call logs and notes\n• AI analysis results\n• Performance metrics\n• Success factor data\n• Objection patterns\n\n💾 CSV file will be downloaded shortly.');
        }
        
        // Make functions globally available
        window.openScheduleModal = openScheduleModal;
        window.closeModal = closeModal;
        window.submitAppointment = submitAppointment;
        window.openResearchModal = openResearchModal;
        window.openEnrichmentModal = openEnrichmentModal;
        window.closeResearchModal = closeResearchModal;
        window.closeEnrichmentModal = closeEnrichmentModal;
        window.startResearch = startResearch;
        window.startEnrichment = startEnrichment;
        window.researchProspect = researchProspect;
        window.openAIResearchDashboard = openAIResearchDashboard;
        window.closeAIResearchModal = closeAIResearchModal;
        window.closeAIDashboardModal = closeAIDashboardModal;
        window.generateTalkingPoints = generateTalkingPoints;
        window.createPreMeetingBrief = createPreMeetingBrief;
        window.startBulkResearch = startBulkResearch;
        window.viewResearchHistory = viewResearchHistory;
        
        // AI Call Analysis Functions
        window.logNewCall = logNewCall;
        window.openCallAnalyticsDashboard = openCallAnalyticsDashboard;
        window.viewCallDetails = viewCallDetails;
        window.closeCallLogModal = closeCallLogModal;
        window.closeCallAnalyticsModal = closeCallAnalyticsModal;
        window.saveCallWithAI = saveCallWithAI;
        window.saveCallQuick = saveCallQuick;
        window.generateCallReport = generateCallReport;
        window.exportCallData = exportCallData;
    </script>
</body>
</html>
